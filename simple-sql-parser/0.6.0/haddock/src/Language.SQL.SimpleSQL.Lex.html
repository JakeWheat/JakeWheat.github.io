<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-identifier">The</span><span> </span><span class="hs-identifier">parser</span><span> </span><span class="hs-identifier">uses</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">separate</span><span> </span><span class="hs-identifier">lexer</span><span> </span><span class="hs-identifier">for</span><span> </span><span class="hs-identifier">two</span><span> </span><span class="hs-identifier">reasons</span><span class="hs-glyph">:</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-number">1</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">sql</span><span> </span><span class="hs-identifier">syntax</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">very</span><span> </span><span class="hs-identifier">awkward</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">parse</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">separate</span><span> </span><span class="hs-identifier">lexer</span><span> </span><span class="hs-identifier">makes</span><span> </span><span class="hs-identifier">it</span><span>
</span><span id="line-5"></span><span class="hs-identifier">easier</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">handle</span><span> </span><span class="hs-identifier">this</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">most</span><span> </span><span class="hs-identifier">places</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">some</span><span> </span><span class="hs-identifier">places</span><span> </span><span class="hs-identifier">it</span><span> </span><span class="hs-identifier">makes</span><span> </span><span class="hs-identifier">it</span><span>
</span><span id="line-6"></span><span class="hs-identifier">harder</span><span> </span><span class="hs-identifier">or</span><span> </span><span class="hs-identifier">impossible</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">fix</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">switch</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">something</span><span> </span><span class="hs-identifier">better</span><span> </span><span class="hs-identifier">than</span><span>
</span><span id="line-7"></span><span class="hs-identifier">parsec</span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-number">2</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">using</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">separate</span><span> </span><span class="hs-identifier">lexer</span><span> </span><span class="hs-identifier">gives</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">huge</span><span> </span><span class="hs-identifier">speed</span><span> </span><span class="hs-identifier">boost</span><span> </span><span class="hs-identifier">because</span><span> </span><span class="hs-identifier">it</span><span> </span><span class="hs-identifier">reduces</span><span>
</span><span id="line-10"></span><span class="hs-identifier">backtracking</span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">We</span><span> </span><span class="hs-identifier">could</span><span> </span><span class="hs-identifier">get</span><span> </span><span class="hs-identifier">this</span><span> </span><span class="hs-identifier">by</span><span> </span><span class="hs-identifier">making</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">parsing</span><span> </span><span class="hs-identifier">code</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">lot</span><span> </span><span class="hs-identifier">more</span><span>
</span><span id="line-11"></span><span class="hs-identifier">complex</span><span> </span><span class="hs-identifier">also</span><span class="hs-operator">.</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-number">3</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">we</span><span> </span><span class="hs-identifier">can</span><span> </span><span class="hs-identifier">test</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">lexer</span><span> </span><span class="hs-identifier">relatively</span><span> </span><span class="hs-identifier">exhaustively</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">even</span><span> </span><span class="hs-identifier">when</span><span> </span><span class="hs-identifier">we</span><span>
</span><span id="line-14"></span><span class="hs-identifier">don't</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">nearly</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">comprehensive</span><span> </span><span class="hs-identifier">testing</span><span> </span><span class="hs-identifier">on</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">syntax</span><span> </span><span class="hs-identifier">level</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">we</span><span> </span><span class="hs-identifier">still</span><span>
</span><span id="line-15"></span><span class="hs-identifier">have</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">relatively</span><span> </span><span class="hs-identifier">high</span><span> </span><span class="hs-identifier">assurance</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">low</span><span> </span><span class="hs-identifier">level</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">bugs</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">This</span><span> </span><span class="hs-identifier">is</span><span>
</span><span id="line-16"></span><span class="hs-identifier">much</span><span> </span><span class="hs-identifier">more</span><span> </span><span class="hs-identifier">difficult</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">get</span><span> </span><span class="hs-identifier">parity</span><span> </span><span class="hs-identifier">with</span><span> </span><span class="hs-identifier">when</span><span> </span><span class="hs-identifier">testing</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">syntax</span><span> </span><span class="hs-identifier">parser</span><span>
</span><span id="line-17"></span><span class="hs-identifier">directly</span><span> </span><span class="hs-identifier">without</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">separately</span><span> </span><span class="hs-identifier">testing</span><span> </span><span class="hs-identifier">lexing</span><span> </span><span class="hs-identifier">stage</span><span class="hs-operator">.</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-comment">-- | Lexer for SQL.</span><span>
</span><span id="line-20"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-21"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.SQL.SimpleSQL.Lex</span><span>
</span><span id="line-22"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier">Token</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#lexSQL"><span class="hs-identifier">lexSQL</span></a></span><span>
</span><span id="line-24"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier">prettyToken</span></a></span><span>
</span><span id="line-25"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyTokens"><span class="hs-identifier">prettyTokens</span></a></span><span>
</span><span id="line-26"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Errors.html#ParseError"><span class="hs-identifier">ParseError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier">tokenListWillPrintAndLex</span></a></span><span>
</span><span id="line-28"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#ansi2011"><span class="hs-identifier">ansi2011</span></a></span><span>
</span><span id="line-29"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html"><span class="hs-identifier">Language.SQL.SimpleSQL.Dialect</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Parsec</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">option</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">string</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">manyTill</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">anyChar</span></span><span>
</span><span id="line-34"></span><span class="hs-operator">&gt;</span><span>                    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">try</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">string</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">many1</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">oneOf</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">digit</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">choice</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">char</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">eof</span></span><span>
</span><span id="line-35"></span><span class="hs-operator">&gt;</span><span>                    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">many</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">runParser</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">lookAhead</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">satisfy</span></span><span>
</span><span id="line-36"></span><span class="hs-operator">&gt;</span><span>                    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">setPosition</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">getPosition</span></span><span>
</span><span id="line-37"></span><span class="hs-operator">&gt;</span><span>                    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">setSourceColumn</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">setSourceLine</span></span><span>
</span><span id="line-38"></span><span class="hs-operator">&gt;</span><span>                    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">sourceName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">setSourceName</span></span><span>
</span><span id="line-39"></span><span class="hs-operator">&gt;</span><span>                    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">sourceLine</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sourceColumn</span></span><span>
</span><span id="line-40"></span><span class="hs-operator">&gt;</span><span>                    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">notFollowedBy</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Combinators.html"><span class="hs-identifier">Language.SQL.SimpleSQL.Combinators</span></a></span><span>
</span><span id="line-42"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Errors.html"><span class="hs-identifier">Language.SQL.SimpleSQL.Errors</span></a></span><span>
</span><span id="line-43"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">many</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>
</span><span id="line-45"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-46"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">takeWhile</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Parsec.String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Parser</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-comment">-- | Represents a lexed token</span><span>
</span><span id="line-52"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-keyword">data</span><span> </span><span id="Token"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-var">Token</span></a></span></span><span>
</span><span id="line-53"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- | A symbol (in ansi dialect) is one of the following</span><span>
</span><span id="line-54"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">--</span><span>
</span><span id="line-55"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- * multi char symbols &lt;&gt; \&lt;= \&gt;= != ||</span><span>
</span><span id="line-56"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- * single char symbols: * + -  &lt; &gt;  ^ / %  ~ &amp; | ? ( ) [ ] , ; ( )</span><span>
</span><span id="line-57"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">--</span><span>
</span><span id="line-58"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-glyph">=</span><span> </span><span id="Symbol"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-var">Symbol</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-59"></span><span class="hs-operator">&gt;</span><span>
</span><span id="line-60"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- | This is an identifier or keyword. The first field is</span><span>
</span><span id="line-61"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- the quotes used, or nothing if no quotes were used. The quotes</span><span>
</span><span id="line-62"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- can be &quot; or u&amp; or something dialect specific like []</span><span>
</span><span id="line-63"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-glyph">|</span><span> </span><span id="Identifier"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-64"></span><span class="hs-operator">&gt;</span><span>
</span><span id="line-65"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- | This is a prefixed variable symbol, such as :var, @var or #var</span><span>
</span><span id="line-66"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- (only :var is used in ansi dialect)</span><span>
</span><span id="line-67"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-glyph">|</span><span> </span><span id="PrefixedVariable"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-var">PrefixedVariable</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-68"></span><span class="hs-operator">&gt;</span><span>
</span><span id="line-69"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- | This is a positional arg identifier e.g. $1</span><span>
</span><span id="line-70"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-glyph">|</span><span> </span><span id="PositionalArg"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PositionalArg"><span class="hs-identifier hs-var">PositionalArg</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-71"></span><span class="hs-operator">&gt;</span><span>
</span><span id="line-72"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- | This is a string literal. The first two fields are the --</span><span>
</span><span id="line-73"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- start and end quotes, which are usually both ', but can be</span><span>
</span><span id="line-74"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- the character set (one of nNbBxX, or u&amp;, U&amp;), or a dialect</span><span>
</span><span id="line-75"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- specific string quoting (such as $$ in postgres)</span><span>
</span><span id="line-76"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-glyph">|</span><span> </span><span id="SqlString"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-var">SqlString</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-77"></span><span class="hs-operator">&gt;</span><span>
</span><span id="line-78"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- | A number literal (integral or otherwise), stored in original format</span><span>
</span><span id="line-79"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- unchanged</span><span>
</span><span id="line-80"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-glyph">|</span><span> </span><span id="SqlNumber"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-var">SqlNumber</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-81"></span><span class="hs-operator">&gt;</span><span>
</span><span id="line-82"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- | Whitespace, one or more of space, tab or newline.</span><span>
</span><span id="line-83"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-glyph">|</span><span> </span><span id="Whitespace"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Whitespace"><span class="hs-identifier hs-var">Whitespace</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-84"></span><span class="hs-operator">&gt;</span><span>
</span><span id="line-85"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- | A commented line using --, contains every character starting with the</span><span>
</span><span id="line-86"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- \'--\' and including the terminating newline character if there is one</span><span>
</span><span id="line-87"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- - this will be missing if the last line in the source is a line comment</span><span>
</span><span id="line-88"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- with no trailing newline</span><span>
</span><span id="line-89"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-glyph">|</span><span> </span><span id="LineComment"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#LineComment"><span class="hs-identifier hs-var">LineComment</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-90"></span><span class="hs-operator">&gt;</span><span>
</span><span id="line-91"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- | A block comment, \/* stuff *\/, includes the comment delimiters</span><span>
</span><span id="line-92"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-glyph">|</span><span> </span><span id="BlockComment"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#BlockComment"><span class="hs-identifier hs-var">BlockComment</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-93"></span><span class="hs-operator">&gt;</span><span>
</span><span id="line-94"></span><span class="hs-operator">&gt;</span><span>       </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679115187"><span id="local-6989586621679115189"><span class="annot"><span class="annottext">Token -&gt; Token -&gt; Bool
(Token -&gt; Token -&gt; Bool) -&gt; (Token -&gt; Token -&gt; Bool) -&gt; Eq Token
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Token -&gt; Token -&gt; Bool
$c/= :: Token -&gt; Token -&gt; Bool
== :: Token -&gt; Token -&gt; Bool
$c== :: Token -&gt; Token -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679115180"><span id="local-6989586621679115182"><span id="local-6989586621679115184"><span class="annot"><span class="annottext">Int -&gt; Token -&gt; ShowS
[Token] -&gt; ShowS
Token -&gt; String
(Int -&gt; Token -&gt; ShowS)
-&gt; (Token -&gt; String) -&gt; ([Token] -&gt; ShowS) -&gt; Show Token
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Token] -&gt; ShowS
$cshowList :: [Token] -&gt; ShowS
show :: Token -&gt; String
$cshow :: Token -&gt; String
showsPrec :: Int -&gt; Token -&gt; ShowS
$cshowsPrec :: Int -&gt; Token -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-comment">-- | Pretty printing, if you lex a bunch of tokens, then pretty</span><span>
</span><span id="line-99"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-comment">-- print them, should should get back exactly the same string</span><span>
</span><span id="line-100"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-type">prettyToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-101"></span><span class="hs-operator">&gt;</span><span> </span><span id="prettyToken"><span class="annot"><span class="annottext">prettyToken :: Dialect -&gt; Token -&gt; String
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var hs-var">prettyToken</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span id="local-6989586621679115178"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679115178"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115178"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-102"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-type">Identifier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span id="local-6989586621679115177"><span class="annot"><span class="annottext">t :: String
</span><a href="#local-6989586621679115177"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115177"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-103"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-type">Identifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679115176"><span class="annot"><span class="annottext">q1 :: String
</span><a href="#local-6989586621679115176"><span class="hs-identifier hs-var">q1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679115175"><span class="annot"><span class="annottext">q2 :: String
</span><a href="#local-6989586621679115175"><span class="hs-identifier hs-var">q2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679115174"><span class="annot"><span class="annottext">t :: String
</span><a href="#local-6989586621679115174"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115176"><span class="hs-identifier hs-var">q1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115174"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115175"><span class="hs-identifier hs-var">q2</span></a></span><span>
</span><span id="line-104"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-type">PrefixedVariable</span></a></span><span> </span><span id="local-6989586621679115173"><span class="annot"><span class="annottext">c :: Char
</span><a href="#local-6989586621679115173"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679115172"><span class="annot"><span class="annottext">p :: String
</span><a href="#local-6989586621679115172"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115173"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115172"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-105"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PositionalArg"><span class="hs-identifier hs-type">PositionalArg</span></a></span><span> </span><span id="local-6989586621679115171"><span class="annot"><span class="annottext">p :: Int
</span><a href="#local-6989586621679115171"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-char">'$'</span></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115171"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-106"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-type">SqlString</span></a></span><span> </span><span id="local-6989586621679115169"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679115169"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679115168"><span class="annot"><span class="annottext">e :: String
</span><a href="#local-6989586621679115168"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679115167"><span class="annot"><span class="annottext">t :: String
</span><a href="#local-6989586621679115167"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115169"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115167"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115168"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-107"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-type">SqlNumber</span></a></span><span> </span><span id="local-6989586621679115166"><span class="annot"><span class="annottext">r :: String
</span><a href="#local-6989586621679115166"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115166"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-108"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Whitespace"><span class="hs-identifier hs-type">Whitespace</span></a></span><span> </span><span id="local-6989586621679115165"><span class="annot"><span class="annottext">t :: String
</span><a href="#local-6989586621679115165"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115165"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-109"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#LineComment"><span class="hs-identifier hs-type">LineComment</span></a></span><span> </span><span id="local-6989586621679115164"><span class="annot"><span class="annottext">l :: String
</span><a href="#local-6989586621679115164"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115164"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-110"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#BlockComment"><span class="hs-identifier hs-type">BlockComment</span></a></span><span> </span><span id="local-6989586621679115163"><span class="annot"><span class="annottext">c :: String
</span><a href="#local-6989586621679115163"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115163"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyTokens"><span class="hs-identifier hs-type">prettyTokens</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-113"></span><span class="hs-operator">&gt;</span><span> </span><span id="prettyTokens"><span class="annot"><span class="annottext">prettyTokens :: Dialect -&gt; [Token] -&gt; String
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyTokens"><span class="hs-identifier hs-var hs-var">prettyTokens</span></a></span></span><span> </span><span id="local-6989586621679115162"><span class="annot"><span class="annottext">d :: Dialect
</span><a href="#local-6989586621679115162"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679115161"><span class="annot"><span class="annottext">ts :: [Token]
</span><a href="#local-6989586621679115161"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Token -&gt; String) -&gt; [Token] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Token -&gt; String
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115162"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679115161"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-identifier">TODO</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">try</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">make</span><span> </span><span class="hs-identifier">all</span><span> </span><span class="hs-identifier">parsers</span><span> </span><span class="hs-identifier">applicative</span><span> </span><span class="hs-identifier">only</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-comment">-- | Lex some SQL to a list of tokens.</span><span>
</span><span id="line-118"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#lexSQL"><span class="hs-identifier hs-type">lexSQL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span>
</span><span id="line-119"></span><span class="hs-operator">&gt;</span><span>                   </span><span class="hs-comment">-- ^ dialect of SQL to use</span><span>
</span><span id="line-120"></span><span class="hs-operator">&gt;</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-121"></span><span class="hs-operator">&gt;</span><span>                   </span><span class="hs-comment">-- ^ filename to use in error messages</span><span>
</span><span id="line-122"></span><span class="hs-operator">&gt;</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span class="hs-operator">&gt;</span><span>                   </span><span class="hs-comment">-- ^ line number and column number of the first character</span><span>
</span><span id="line-124"></span><span class="hs-operator">&gt;</span><span>                   </span><span class="hs-comment">-- in the source to use in error messages</span><span>
</span><span id="line-125"></span><span class="hs-operator">&gt;</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-126"></span><span class="hs-operator">&gt;</span><span>                   </span><span class="hs-comment">-- ^ the SQL source to lex</span><span>
</span><span id="line-127"></span><span class="hs-operator">&gt;</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Errors.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span class="hs-operator">&gt;</span><span> </span><span id="lexSQL"><span class="annot"><span class="annottext">lexSQL :: Dialect
-&gt; String
-&gt; Maybe (Int, Int)
-&gt; String
-&gt; Either ParseError [((String, Int, Int), Token)]
</span><a href="Language.SQL.SimpleSQL.Lex.html#lexSQL"><span class="hs-identifier hs-var hs-var">lexSQL</span></a></span></span><span> </span><span id="local-6989586621679115158"><span class="annot"><span class="annottext">dialect :: Dialect
</span><a href="#local-6989586621679115158"><span class="hs-identifier hs-var">dialect</span></a></span></span><span> </span><span id="local-6989586621679115157"><span class="annot"><span class="annottext">fn' :: String
</span><a href="#local-6989586621679115157"><span class="hs-identifier hs-var">fn'</span></a></span></span><span> </span><span id="local-6989586621679115156"><span class="annot"><span class="annottext">p :: Maybe (Int, Int)
</span><a href="#local-6989586621679115156"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679115155"><span class="annot"><span class="annottext">src :: String
</span><a href="#local-6989586621679115155"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-129"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679115154"><span class="annot"><span class="annottext">l' :: Int
</span><a href="#local-6989586621679115154"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679115153"><span class="annot"><span class="annottext">c' :: Int
</span><a href="#local-6989586621679115153"><span class="hs-identifier hs-var">c'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Maybe (Int, Int) -&gt; (Int, Int)
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679115156"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-130"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(ParseError -&gt; Either ParseError [((String, Int, Int), Token)])
-&gt; ([((String, Int, Int), Token)]
    -&gt; Either ParseError [((String, Int, Int), Token)])
-&gt; Either ParseError [((String, Int, Int), Token)]
-&gt; Either ParseError [((String, Int, Int), Token)]
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParseError -&gt; Either ParseError [((String, Int, Int), Token)]
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(ParseError -&gt; Either ParseError [((String, Int, Int), Token)])
-&gt; (ParseError -&gt; ParseError)
-&gt; ParseError
-&gt; Either ParseError [((String, Int, Int), Token)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParseError -&gt; ParseError
</span><a href="Language.SQL.SimpleSQL.Errors.html#convParseError"><span class="hs-identifier hs-var">convParseError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115155"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[((String, Int, Int), Token)]
-&gt; Either ParseError [((String, Int, Int), Token)]
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>
</span><span id="line-131"></span><span class="hs-operator">&gt;</span><span>        </span><span class="annot"><span class="annottext">(Either ParseError [((String, Int, Int), Token)]
 -&gt; Either ParseError [((String, Int, Int), Token)])
-&gt; Either ParseError [((String, Int, Int), Token)]
-&gt; Either ParseError [((String, Int, Int), Token)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parsec String () [((String, Int, Int), Token)]
-&gt; ()
-&gt; String
-&gt; String
-&gt; Either ParseError [((String, Int, Int), Token)]
forall s t u a.
Stream s Identity t =&gt;
Parsec s u a -&gt; u -&gt; String -&gt; s -&gt; Either ParseError a
</span><span class="hs-identifier hs-var">runParser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, Int, Int) -&gt; ParsecT String () Identity ()
forall (m :: * -&gt; *) s u.
Monad m =&gt;
(String, Int, Int) -&gt; ParsecT s u m ()
</span><a href="#local-6989586621679115148"><span class="hs-identifier hs-var">setPos</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115157"><span class="hs-identifier hs-var">fn'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115154"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115153"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity ()
-&gt; Parsec String () [((String, Int, Int), Token)]
-&gt; Parsec String () [((String, Int, Int), Token)]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity ((String, Int, Int), Token)
-&gt; Parsec String () [((String, Int, Int), Token)]
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT String () Identity ((String, Int, Int), Token)
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlToken"><span class="hs-identifier hs-var">sqlToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115158"><span class="hs-identifier hs-var">dialect</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parsec String () [((String, Int, Int), Token)]
-&gt; ParsecT String () Identity ()
-&gt; Parsec String () [((String, Int, Int), Token)]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity ()
forall s (m :: * -&gt; *) t u.
(Stream s m t, Show t) =&gt;
ParsecT s u m ()
</span><span class="hs-identifier hs-var">eof</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115157"><span class="hs-identifier hs-var">fn'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115155"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-132"></span><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-133"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115148"><span class="annot"><span class="annottext">setPos :: (String, Int, Int) -&gt; ParsecT s u m ()
</span><a href="#local-6989586621679115148"><span class="hs-identifier hs-var hs-var">setPos</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679115145"><span class="annot"><span class="annottext">fn :: String
</span><a href="#local-6989586621679115145"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679115144"><span class="annot"><span class="annottext">l :: Int
</span><a href="#local-6989586621679115144"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679115143"><span class="annot"><span class="annottext">c :: Int
</span><a href="#local-6989586621679115143"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-134"></span><span class="hs-operator">&gt;</span><span>         </span><span class="annot"><span class="annottext">(SourcePos -&gt; SourcePos)
-&gt; ParsecT s u m SourcePos -&gt; ParsecT s u m SourcePos
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SourcePos -&gt; String -&gt; SourcePos)
-&gt; String -&gt; SourcePos -&gt; SourcePos
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">SourcePos -&gt; String -&gt; SourcePos
</span><span class="hs-identifier hs-var">setSourceName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115145"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-135"></span><span class="hs-operator">&gt;</span><span>                </span><span class="annot"><span class="annottext">(SourcePos -&gt; SourcePos)
-&gt; (SourcePos -&gt; SourcePos) -&gt; SourcePos -&gt; SourcePos
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SourcePos -&gt; Int -&gt; SourcePos) -&gt; Int -&gt; SourcePos -&gt; SourcePos
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">SourcePos -&gt; Int -&gt; SourcePos
</span><span class="hs-identifier hs-var">setSourceLine</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115144"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-136"></span><span class="hs-operator">&gt;</span><span>                </span><span class="annot"><span class="annottext">(SourcePos -&gt; SourcePos)
-&gt; (SourcePos -&gt; SourcePos) -&gt; SourcePos -&gt; SourcePos
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SourcePos -&gt; Int -&gt; SourcePos) -&gt; Int -&gt; SourcePos -&gt; SourcePos
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">SourcePos -&gt; Int -&gt; SourcePos
</span><span class="hs-identifier hs-var">setSourceColumn</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115143"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT s u m SourcePos
forall (m :: * -&gt; *) s u. Monad m =&gt; ParsecT s u m SourcePos
</span><span class="hs-identifier hs-var">getPosition</span></span><span>
</span><span id="line-137"></span><span class="hs-operator">&gt;</span><span>           </span><span class="annot"><span class="annottext">ParsecT s u m SourcePos
-&gt; (SourcePos -&gt; ParsecT s u m ()) -&gt; ParsecT s u m ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">SourcePos -&gt; ParsecT s u m ()
forall (m :: * -&gt; *) s u. Monad m =&gt; SourcePos -&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">setPosition</span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-comment">-- | parser for a sql token</span><span>
</span><span id="line-140"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#sqlToken"><span class="hs-identifier hs-type">sqlToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span class="hs-operator">&gt;</span><span> </span><span id="sqlToken"><span class="annot"><span class="annottext">sqlToken :: Dialect -&gt; ParsecT String () Identity ((String, Int, Int), Token)
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlToken"><span class="hs-identifier hs-var hs-var">sqlToken</span></a></span></span><span> </span><span id="local-6989586621679115141"><span class="annot"><span class="annottext">d :: Dialect
</span><a href="#local-6989586621679115141"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-142"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115140"><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679115140"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity SourcePos
forall (m :: * -&gt; *) s u. Monad m =&gt; ParsecT s u m SourcePos
</span><span class="hs-identifier hs-var">getPosition</span></span><span>
</span><span id="line-143"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679115139"><span class="annot"><span class="annottext">p :: (String, Int, Int)
</span><a href="#local-6989586621679115139"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourcePos -&gt; String
</span><span class="hs-identifier hs-var">sourceName</span></span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679115140"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SourcePos -&gt; Int
</span><span class="hs-identifier hs-var">sourceLine</span></span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679115140"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SourcePos -&gt; Int
</span><span class="hs-identifier hs-var">sourceColumn</span></span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679115140"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-identifier">The</span><span> </span><span class="hs-identifier">order</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">parsers</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">important</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">strings</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">quoted</span><span> </span><span class="hs-identifier">identifiers</span><span> </span><span class="hs-identifier">can</span><span>
</span><span id="line-146"></span><span class="hs-identifier">start</span><span> </span><span class="hs-identifier">out</span><span> </span><span class="hs-identifier">looking</span><span> </span><span class="hs-identifier">like</span><span> </span><span class="hs-identifier">normal</span><span> </span><span class="hs-identifier">identifiers</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">so</span><span> </span><span class="hs-identifier">we</span><span> </span><span class="hs-identifier">try</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">parse</span><span> </span><span class="hs-identifier">these</span><span>
</span><span id="line-147"></span><span class="hs-identifier">first</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">use</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">little</span><span> </span><span class="hs-identifier">bit</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">try</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Line</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">block</span><span> </span><span class="hs-identifier">comments</span><span> </span><span class="hs-identifier">start</span><span> </span><span class="hs-identifier">like</span><span>
</span><span id="line-148"></span><span class="hs-identifier">symbols</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">so</span><span> </span><span class="hs-identifier">we</span><span> </span><span class="hs-identifier">try</span><span> </span><span class="hs-identifier">these</span><span> </span><span class="hs-identifier">before</span><span> </span><span class="hs-identifier">symbol</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Numbers</span><span> </span><span class="hs-identifier">can</span><span> </span><span class="hs-identifier">start</span><span> </span><span class="hs-identifier">with</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">so</span><span>
</span><span id="line-149"></span><span class="hs-identifier">this</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">also</span><span> </span><span class="hs-identifier">tried</span><span> </span><span class="hs-identifier">before</span><span> </span><span class="hs-identifier">symbol</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">.</span><span class="hs-number">1</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">parsed</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">number</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">but</span><span>
</span><span id="line-150"></span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">otherwise</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">parsed</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">symbol</span><span class="hs-special">)</span><span class="hs-operator">.</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, Int, Int)
</span><a href="#local-6989586621679115139"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Token -&gt; ((String, Int, Int), Token))
-&gt; ParsecT String () Identity Token
-&gt; ParsecT String () Identity ((String, Int, Int), Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ParsecT String () Identity Token]
-&gt; ParsecT String () Identity Token
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
[ParsecT s u m a] -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlString"><span class="hs-identifier hs-var">sqlString</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115141"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-153"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifier"><span class="hs-identifier hs-var">identifier</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115141"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-154"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#lineComment"><span class="hs-identifier hs-var">lineComment</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115141"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-155"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#blockComment"><span class="hs-identifier hs-var">blockComment</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115141"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-156"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlNumber"><span class="hs-identifier hs-var">sqlNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115141"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-157"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#positionalArg"><span class="hs-identifier hs-var">positionalArg</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115141"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-158"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#dontParseEndBlockComment"><span class="hs-identifier hs-var">dontParseEndBlockComment</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115141"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-159"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#prefixedVariable"><span class="hs-identifier hs-var">prefixedVariable</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115141"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-160"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115141"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-161"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlWhitespace"><span class="hs-identifier hs-var">sqlWhitespace</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115141"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-identifier">Parses</span><span> </span><span class="hs-identifier">identifiers</span><span class="hs-glyph">:</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-identifier">simple_identifier_23</span><span>
</span><span id="line-166"></span><span class="hs-identifier">u</span><span class="hs-operator">&amp;</span><span class="hs-string">&quot;unicode quoted identifier&quot;</span><span>
</span><span id="line-167"></span><span class="hs-string">&quot;quoted identifier&quot;</span><span>
</span><span id="line-168"></span><span class="hs-string">&quot;quoted identifier &quot;</span><span class="hs-string">&quot; with double quote char&quot;</span><span>
</span><span id="line-169"></span><span class="hs-special">`</span><span class="hs-identifier">mysql</span><span> </span><span class="hs-identifier">quoted</span><span> </span><span class="hs-identifier">identifier</span><span class="hs-special">`</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#identifier"><span class="hs-identifier hs-type">identifier</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-172"></span><span class="hs-operator">&gt;</span><span> </span><span id="identifier"><span class="annot"><span class="annottext">identifier :: Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifier"><span class="hs-identifier hs-var hs-var">identifier</span></a></span></span><span> </span><span id="local-6989586621679115127"><span class="annot"><span class="annottext">d :: Dialect
</span><a href="#local-6989586621679115127"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-173"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="annottext">[ParsecT String () Identity Token]
-&gt; ParsecT String () Identity Token
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
[ParsecT s u m a] -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-174"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ParsecT String () Identity Token
</span><a href="#local-6989586621679115126"><span class="hs-identifier hs-var">quotedIden</span></a></span><span>
</span><span id="line-175"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT String () Identity Token
</span><a href="#local-6989586621679115125"><span class="hs-identifier hs-var">unicodeQuotedIden</span></a></span><span>
</span><span id="line-176"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT String () Identity Token
</span><a href="#local-6989586621679115124"><span class="hs-identifier hs-var">regularIden</span></a></span><span>
</span><span id="line-177"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool -&gt; ParsecT String () Identity ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diBackquotedIden"><span class="hs-identifier hs-var hs-var">diBackquotedIden</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115127"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity ()
-&gt; ParsecT String () Identity Token
-&gt; ParsecT String () Identity Token
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Token
</span><a href="#local-6989586621679115122"><span class="hs-identifier hs-var">mySqlQuotedIden</span></a></span><span>
</span><span id="line-178"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool -&gt; ParsecT String () Identity ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diSquareBracketQuotedIden"><span class="hs-identifier hs-var hs-var">diSquareBracketQuotedIden</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115127"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity ()
-&gt; ParsecT String () Identity Token
-&gt; ParsecT String () Identity Token
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Token
</span><a href="#local-6989586621679115120"><span class="hs-identifier hs-var">sqlServerQuotedIden</span></a></span><span>
</span><span id="line-179"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">]</span><span>
</span><span id="line-180"></span><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-181"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115124"><span class="annot"><span class="annottext">regularIden :: ParsecT String () Identity Token
</span><a href="#local-6989586621679115124"><span class="hs-identifier hs-var hs-var">regularIden</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (String, String) -&gt; String -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, String)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var">identifierString</span></a></span><span>
</span><span id="line-182"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115126"><span class="annot"><span class="annottext">quotedIden :: ParsecT String () Identity Token
</span><a href="#local-6989586621679115126"><span class="hs-identifier hs-var hs-var">quotedIden</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (String, String) -&gt; String -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, String) -&gt; Maybe (String, String)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
</span><a href="#local-6989586621679115118"><span class="hs-identifier hs-var">qidenPart</span></a></span><span>
</span><span id="line-183"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115122"><span class="annot"><span class="annottext">mySqlQuotedIden :: ParsecT String () Identity Token
</span><a href="#local-6989586621679115122"><span class="hs-identifier hs-var hs-var">mySqlQuotedIden</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (String, String) -&gt; String -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, String) -&gt; Maybe (String, String)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;`&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;`&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span class="hs-operator">&gt;</span><span>                       </span><span class="annot"><span class="annottext">(String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'`'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ParsecT String () Identity String
</span><a href="Language.SQL.SimpleSQL.Lex.html#takeWhile1"><span class="hs-identifier hs-var">takeWhile1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="hs-char">'`'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity Char
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'`'</span></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115120"><span class="annot"><span class="annottext">sqlServerQuotedIden :: ParsecT String () Identity Token
</span><a href="#local-6989586621679115120"><span class="hs-identifier hs-var hs-var">sqlServerQuotedIden</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (String, String) -&gt; String -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, String) -&gt; Maybe (String, String)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;[&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;]&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span class="hs-operator">&gt;</span><span>                           </span><span class="annot"><span class="annottext">(String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'['</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ParsecT String () Identity String
</span><a href="Language.SQL.SimpleSQL.Lex.html#takeWhile1"><span class="hs-identifier hs-var">takeWhile1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="hs-string">&quot;[]&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity Char
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">']'</span></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- try is used here to avoid a conflict with identifiers</span><span>
</span><span id="line-188"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- and quoted strings which also start with a 'u'</span><span>
</span><span id="line-189"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115125"><span class="annot"><span class="annottext">unicodeQuotedIden :: ParsecT String () Identity Token
</span><a href="#local-6989586621679115125"><span class="hs-identifier hs-var hs-var">unicodeQuotedIden</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (String, String) -&gt; String -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span>
</span><span id="line-190"></span><span class="hs-operator">&gt;</span><span>                         </span><span class="annot"><span class="annottext">(Maybe (String, String) -&gt; String -&gt; Token)
-&gt; ParsecT String () Identity (Maybe (String, String))
-&gt; ParsecT String () Identity (String -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Maybe (String, String)
</span><a href="#local-6989586621679115114"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Maybe (String, String))
-&gt; ParsecT String () Identity Char
-&gt; ParsecT String () Identity (Maybe (String, String))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char -&gt; ParsecT String () Identity Char
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">oneOf</span></span><span> </span><span class="annot"><span class="hs-string">&quot;uU&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Char
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span class="hs-operator">&gt;</span><span>                         </span><span class="annot"><span class="annottext">ParsecT String () Identity (String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
</span><a href="#local-6989586621679115118"><span class="hs-identifier hs-var">qidenPart</span></a></span><span>
</span><span id="line-192"></span><span class="hs-operator">&gt;</span><span>       </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679115114"><span class="annot"><span class="annottext">f :: Char -&gt; Maybe (String, String)
</span><a href="#local-6989586621679115114"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679115113"><span class="annot"><span class="annottext">x :: Char
</span><a href="#local-6989586621679115113"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String, String) -&gt; Maybe (String, String)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115113"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;\&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115118"><span class="annot"><span class="annottext">qidenPart :: ParsecT String () Identity String
</span><a href="#local-6989586621679115118"><span class="hs-identifier hs-var hs-var">qidenPart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'&quot;'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
</span><a href="#local-6989586621679115112"><span class="hs-identifier hs-var">qidenSuffix</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-194"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115112"><span class="annot"><span class="annottext">qidenSuffix :: String -&gt; ParsecT String () Identity String
</span><a href="#local-6989586621679115112"><span class="hs-identifier hs-var hs-var">qidenSuffix</span></a></span></span><span> </span><span id="local-6989586621679115111"><span class="annot"><span class="annottext">t :: String
</span><a href="#local-6989586621679115111"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-195"></span><span class="hs-operator">&gt;</span><span>         </span><span id="local-6989586621679115110"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115110"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ParsecT String () Identity String
</span><a href="Language.SQL.SimpleSQL.Lex.html#takeTill"><span class="hs-identifier hs-var">takeTill</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="hs-char">'&quot;'</span></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span class="hs-operator">&gt;</span><span>         </span><span class="annot"><span class="annottext">ParsecT String () Identity Char -&gt; ParsecT String () Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT String () Identity Char -&gt; ParsecT String () Identity ())
-&gt; ParsecT String () Identity Char -&gt; ParsecT String () Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'&quot;'</span></span><span>
</span><span id="line-197"></span><span class="hs-operator">&gt;</span><span>         </span><span class="hs-comment">-- deal with &quot;&quot; as literal double quote character</span><span>
</span><span id="line-198"></span><span class="hs-operator">&gt;</span><span>         </span><span class="annot"><span class="annottext">[ParsecT String () Identity String]
-&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
[ParsecT s u m a] -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="hs-keyword">do</span><span>
</span><span id="line-199"></span><span class="hs-operator">&gt;</span><span>                 </span><span class="annot"><span class="annottext">ParsecT String () Identity Char -&gt; ParsecT String () Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT String () Identity Char -&gt; ParsecT String () Identity ())
-&gt; ParsecT String () Identity Char -&gt; ParsecT String () Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'&quot;'</span></span><span>
</span><span id="line-200"></span><span class="hs-operator">&gt;</span><span>                 </span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
</span><a href="#local-6989586621679115112"><span class="hs-identifier hs-var">qidenSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ParsecT String () Identity String)
-&gt; String -&gt; ParsecT String () Identity String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115111"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115110"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;\&quot;\&quot;&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span class="hs-operator">&gt;</span><span>                </span><span class="hs-special">,</span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ParsecT String () Identity String)
-&gt; String -&gt; ParsecT String () Identity String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115111"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115110"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-identifier">This</span><span> </span><span class="hs-identifier">parses</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">valid</span><span> </span><span class="hs-identifier">identifier</span><span> </span><span class="hs-identifier">without</span><span> </span><span class="hs-identifier">quotes</span><span class="hs-operator">.</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-type">identifierString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-207"></span><span class="hs-operator">&gt;</span><span> </span><span id="identifierString"><span class="annot"><span class="annottext">identifierString :: ParsecT String () Identity String
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var hs-var">identifierString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-208"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="annottext">(Char -&gt; Bool)
-&gt; (Char -&gt; Bool) -&gt; ParsecT String () Identity String
</span><a href="Language.SQL.SimpleSQL.Lex.html#startsWith"><span class="hs-identifier hs-var">startsWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679115106"><span class="annot"><span class="annottext">c :: Char
</span><a href="#local-6989586621679115106"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115106"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlpha</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115106"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-var">isIdentifierChar</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-identifier">this</span><span> </span><span class="hs-identifier">can</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">moved</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">dialect</span><span> </span><span class="hs-identifier">at</span><span> </span><span class="hs-identifier">some</span><span> </span><span class="hs-identifier">point</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-type">isIdentifierChar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-213"></span><span class="hs-operator">&gt;</span><span> </span><span id="isIdentifierChar"><span class="annot"><span class="annottext">isIdentifierChar :: Char -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-var hs-var">isIdentifierChar</span></a></span></span><span> </span><span id="local-6989586621679115102"><span class="annot"><span class="annottext">c :: Char
</span><a href="#local-6989586621679115102"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115102"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlphaNum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115102"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-identifier">use</span><span> </span><span class="hs-identifier">try</span><span> </span><span class="hs-identifier">because</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-glyph">@</span><span> </span><span class="hs-identifier">can</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">part</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">other</span><span> </span><span class="hs-identifier">things</span><span> </span><span class="hs-identifier">also</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prefixedVariable"><span class="hs-identifier hs-type">prefixedVariable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-218"></span><span class="hs-operator">&gt;</span><span> </span><span id="prefixedVariable"><span class="annot"><span class="annottext">prefixedVariable :: Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#prefixedVariable"><span class="hs-identifier hs-var hs-var">prefixedVariable</span></a></span></span><span>  </span><span id="local-6989586621679115100"><span class="annot"><span class="annottext">d :: Dialect
</span><a href="#local-6989586621679115100"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Token
-&gt; ParsecT String () Identity Token
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT String () Identity Token
 -&gt; ParsecT String () Identity Token)
-&gt; ParsecT String () Identity Token
-&gt; ParsecT String () Identity Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ParsecT String () Identity Token]
-&gt; ParsecT String () Identity Token
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
[ParsecT s u m a] -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-219"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-var">PrefixedVariable</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; String -&gt; Token)
-&gt; ParsecT String () Identity Char
-&gt; ParsecT String () Identity (String -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity (String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var">identifierString</span></a></span><span>
</span><span id="line-220"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool -&gt; ParsecT String () Identity ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diAtIdentifier"><span class="hs-identifier hs-var hs-var">diAtIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115100"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity ()
-&gt; ParsecT String () Identity Token
-&gt; ParsecT String () Identity Token
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span>
</span><span id="line-221"></span><span class="hs-operator">&gt;</span><span>      </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-var">PrefixedVariable</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; String -&gt; Token)
-&gt; ParsecT String () Identity Char
-&gt; ParsecT String () Identity (String -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'@'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity (String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var">identifierString</span></a></span><span>
</span><span id="line-222"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool -&gt; ParsecT String () Identity ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diHashIdentifier"><span class="hs-identifier hs-var hs-var">diHashIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115100"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity ()
-&gt; ParsecT String () Identity Token
-&gt; ParsecT String () Identity Token
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span>
</span><span id="line-223"></span><span class="hs-operator">&gt;</span><span>      </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-var">PrefixedVariable</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; String -&gt; Token)
-&gt; ParsecT String () Identity Char
-&gt; ParsecT String () Identity (String -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'#'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity (String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var">identifierString</span></a></span><span>
</span><span id="line-224"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">]</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#positionalArg"><span class="hs-identifier hs-type">positionalArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-227"></span><span class="hs-operator">&gt;</span><span> </span><span id="positionalArg"><span class="annot"><span class="annottext">positionalArg :: Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#positionalArg"><span class="hs-identifier hs-var hs-var">positionalArg</span></a></span></span><span> </span><span id="local-6989586621679115097"><span class="annot"><span class="annottext">d :: Dialect
</span><a href="#local-6989586621679115097"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-228"></span><span class="hs-operator">&gt;</span><span>   </span><span class="annot"><span class="annottext">Bool -&gt; ParsecT String () Identity ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPositionalArg"><span class="hs-identifier hs-var hs-var">diPositionalArg</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115097"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity ()
-&gt; ParsecT String () Identity Token
-&gt; ParsecT String () Identity Token
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span>
</span><span id="line-229"></span><span class="hs-operator">&gt;</span><span>   </span><span class="hs-comment">-- use try to avoid ambiguities with other syntax which starts with dollar</span><span>
</span><span id="line-230"></span><span class="hs-operator">&gt;</span><span>   </span><span class="annot"><span class="annottext">Int -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#PositionalArg"><span class="hs-identifier hs-var">PositionalArg</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Token)
-&gt; ParsecT String () Identity Int
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Int -&gt; ParsecT String () Identity Int
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'$'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
-&gt; ParsecT String () Identity Int -&gt; ParsecT String () Identity Int
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall a. Read a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
-&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m [a]
</span><span class="hs-identifier hs-var">many1</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
forall s (m :: * -&gt; *) u. Stream s m Char =&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">digit</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-identifier">Parse</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">SQL</span><span> </span><span class="hs-identifier">string</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Examples</span><span class="hs-glyph">:</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-special">'</span><span class="hs-identifier">basic</span><span> </span><span class="hs-identifier">string'</span><span>
</span><span id="line-236"></span><span class="hs-special">'</span><span class="hs-identifier">string</span><span> </span><span class="hs-identifier">with</span><span> </span><span class="hs-special">''</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">quote'</span><span>
</span><span id="line-237"></span><span class="hs-identifier">n'international</span><span> </span><span class="hs-identifier">text'</span><span>
</span><span id="line-238"></span><span class="hs-identifier">b'binary</span><span> </span><span class="hs-identifier">string'</span><span>
</span><span id="line-239"></span><span class="hs-identifier">x'hexidecimal</span><span> </span><span class="hs-identifier">string'</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#sqlString"><span class="hs-identifier hs-type">sqlString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-243"></span><span class="hs-operator">&gt;</span><span> </span><span id="sqlString"><span class="annot"><span class="annottext">sqlString :: Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlString"><span class="hs-identifier hs-var hs-var">sqlString</span></a></span></span><span> </span><span id="local-6989586621679115094"><span class="annot"><span class="annottext">d :: Dialect
</span><a href="#local-6989586621679115094"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Token
</span><a href="#local-6989586621679115093"><span class="hs-identifier hs-var">dollarString</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Token
-&gt; ParsecT String () Identity Token
-&gt; ParsecT String () Identity Token
forall s u (m :: * -&gt; *) a.
ParsecT s u m a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Token
</span><a href="#local-6989586621679115092"><span class="hs-identifier hs-var">csString</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Token
-&gt; ParsecT String () Identity Token
-&gt; ParsecT String () Identity Token
forall s u (m :: * -&gt; *) a.
ParsecT s u m a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Token
</span><a href="#local-6989586621679115091"><span class="hs-identifier hs-var">normalString</span></a></span><span>
</span><span id="line-244"></span><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-245"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115093"><span class="annot"><span class="annottext">dollarString :: ParsecT String () Identity Token
</span><a href="#local-6989586621679115093"><span class="hs-identifier hs-var hs-var">dollarString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span class="hs-operator">&gt;</span><span>         </span><span class="annot"><span class="annottext">Bool -&gt; ParsecT String () Identity ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; ParsecT String () Identity ())
-&gt; Bool -&gt; ParsecT String () Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diDollarString"><span class="hs-identifier hs-var hs-var">diDollarString</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115094"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-247"></span><span class="hs-operator">&gt;</span><span>         </span><span class="hs-comment">-- use try because of ambiguity with symbols and with</span><span>
</span><span id="line-248"></span><span class="hs-operator">&gt;</span><span>         </span><span class="hs-comment">-- positional arg</span><span>
</span><span id="line-249"></span><span class="hs-operator">&gt;</span><span>         </span><span id="local-6989586621679115089"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115089"><span class="hs-identifier hs-var">delim</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679115088"><span class="annot"><span class="annottext">x :: String
</span><a href="#local-6989586621679115088"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;$&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115088"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;$&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span class="hs-operator">&gt;</span><span>                  </span><span class="annot"><span class="annottext">ShowS
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'$'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) t a u.
Stream s m t =&gt;
a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var">identifierString</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity Char
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'$'</span></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span class="hs-operator">&gt;</span><span>         </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-var">SqlString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115089"><span class="hs-identifier hs-var">delim</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115089"><span class="hs-identifier hs-var">delim</span></a></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) t u a end.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m end -&gt; ParsecT s u m [a]
</span><span class="hs-identifier hs-var">manyTill</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
forall s (m :: * -&gt; *) u. Stream s m Char =&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">anyChar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT String () Identity String
 -&gt; ParsecT String () Identity String)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115089"><span class="hs-identifier hs-var">delim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115091"><span class="annot"><span class="annottext">normalString :: ParsecT String () Identity Token
</span><a href="#local-6989586621679115091"><span class="hs-identifier hs-var hs-var">normalString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-var">SqlString</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'\''</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; ParsecT String () Identity String
</span><a href="#local-6989586621679115087"><span class="hs-identifier hs-var">normalStringSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115087"><span class="annot"><span class="annottext">normalStringSuffix :: Bool -&gt; String -&gt; ParsecT String () Identity String
</span><a href="#local-6989586621679115087"><span class="hs-identifier hs-var hs-var">normalStringSuffix</span></a></span></span><span> </span><span id="local-6989586621679115086"><span class="annot"><span class="annottext">allowBackslash :: Bool
</span><a href="#local-6989586621679115086"><span class="hs-identifier hs-var">allowBackslash</span></a></span></span><span> </span><span id="local-6989586621679115085"><span class="annot"><span class="annottext">t :: String
</span><a href="#local-6989586621679115085"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-254"></span><span class="hs-operator">&gt;</span><span>         </span><span id="local-6989586621679115084"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115084"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ParsecT String () Identity String
</span><a href="Language.SQL.SimpleSQL.Lex.html#takeTill"><span class="hs-identifier hs-var">takeTill</span></a></span><span> </span><span class="annot"><span class="annottext">((Char -&gt; Bool) -&gt; ParsecT String () Identity String)
-&gt; (Char -&gt; Bool) -&gt; ParsecT String () Identity String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679115086"><span class="hs-identifier hs-var">allowBackslash</span></a></span><span>
</span><span id="line-255"></span><span class="hs-operator">&gt;</span><span>                         </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="hs-string">&quot;'\\&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span class="hs-operator">&gt;</span><span>                         </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-char">'\''</span></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span class="hs-operator">&gt;</span><span>         </span><span class="hs-comment">-- deal with '' or \' as literal quote character</span><span>
</span><span id="line-258"></span><span class="hs-operator">&gt;</span><span>         </span><span class="annot"><span class="annottext">[ParsecT String () Identity String]
-&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
[ParsecT s u m a] -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="hs-keyword">do</span><span>
</span><span id="line-259"></span><span class="hs-operator">&gt;</span><span>                 </span><span id="local-6989586621679115082"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115082"><span class="hs-identifier hs-var">ctu</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ParsecT String () Identity String]
-&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
[ParsecT s u m a] -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;''&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;''&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span class="hs-operator">&gt;</span><span>                               </span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;\\'&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\\'&quot;</span></span><span>
</span><span id="line-261"></span><span class="hs-operator">&gt;</span><span>                               </span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;\\&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; ParsecT String () Identity Char
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'\\'</span></span><span class="hs-special">]</span><span>
</span><span id="line-262"></span><span class="hs-operator">&gt;</span><span>                 </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; ParsecT String () Identity String
</span><a href="#local-6989586621679115087"><span class="hs-identifier hs-var">normalStringSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679115086"><span class="hs-identifier hs-var">allowBackslash</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ParsecT String () Identity String)
-&gt; String -&gt; ParsecT String () Identity String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115085"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115084"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115082"><span class="hs-identifier hs-var">ctu</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-263"></span><span class="hs-operator">&gt;</span><span>                </span><span class="hs-special">,</span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115085"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115084"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ParsecT String () Identity Char
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'\''</span></span><span class="hs-special">]</span><span>
</span><span id="line-264"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- try is used to to avoid conflicts with</span><span>
</span><span id="line-265"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- identifiers which can start with n,b,x,u</span><span>
</span><span id="line-266"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- once we read the quote type and the starting '</span><span>
</span><span id="line-267"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- then we commit to a string</span><span>
</span><span id="line-268"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- it's possible that this will reject some valid syntax</span><span>
</span><span id="line-269"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- but only pathalogical stuff, and I think the improved</span><span>
</span><span id="line-270"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- error messages and user predictability make it a good</span><span>
</span><span id="line-271"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- pragmatic choice</span><span>
</span><span id="line-272"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115092"><span class="annot"><span class="annottext">csString :: ParsecT String () Identity Token
</span><a href="#local-6989586621679115092"><span class="hs-identifier hs-var hs-var">csString</span></a></span></span><span>
</span><span id="line-273"></span><span class="hs-operator">&gt;</span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diEString"><span class="hs-identifier hs-var hs-var">diEString</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115094"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-274"></span><span class="hs-operator">&gt;</span><span>         </span><span class="annot"><span class="annottext">[ParsecT String () Identity Token]
-&gt; ParsecT String () Identity Token
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
[ParsecT s u m a] -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-var">SqlString</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String -&gt; String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity (String -&gt; String -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;e'&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall s u (m :: * -&gt; *) a.
ParsecT s u m a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;E'&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span class="hs-operator">&gt;</span><span>                           </span><span class="annot"><span class="annottext">ParsecT String () Identity (String -&gt; String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity (String -&gt; Token)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity (String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; ParsecT String () Identity String
</span><a href="#local-6989586621679115087"><span class="hs-identifier hs-var">normalStringSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-276"></span><span class="hs-operator">&gt;</span><span>                </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT String () Identity Token
</span><a href="#local-6989586621679115079"><span class="hs-identifier hs-var">csString'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-277"></span><span class="hs-operator">&gt;</span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Token
</span><a href="#local-6989586621679115079"><span class="hs-identifier hs-var">csString'</span></a></span><span>
</span><span id="line-278"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115079"><span class="annot"><span class="annottext">csString' :: ParsecT String () Identity Token
</span><a href="#local-6989586621679115079"><span class="hs-identifier hs-var hs-var">csString'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-var">SqlString</span></a></span><span>
</span><span id="line-279"></span><span class="hs-operator">&gt;</span><span>                 </span><span class="annot"><span class="annottext">(String -&gt; String -&gt; String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity (String -&gt; String -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
forall u. ParsecT String u Identity String
</span><a href="#local-6989586621679115078"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-280"></span><span class="hs-operator">&gt;</span><span>                 </span><span class="annot"><span class="annottext">ParsecT String () Identity (String -&gt; String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity (String -&gt; Token)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="hs-string">&quot;'&quot;</span></span><span>
</span><span id="line-281"></span><span class="hs-operator">&gt;</span><span>                 </span><span class="annot"><span class="annottext">ParsecT String () Identity (String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; ParsecT String () Identity String
</span><a href="#local-6989586621679115087"><span class="hs-identifier hs-var">normalStringSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-282"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115077"><span class="annot"><span class="annottext">csPrefixes :: String
</span><a href="#local-6989586621679115077"><span class="hs-identifier hs-var hs-var">csPrefixes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;nNbBxX&quot;</span></span><span>
</span><span id="line-283"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115078"><span class="annot"><span class="annottext">cs :: ParsecT String u Identity String
</span><a href="#local-6989586621679115078"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ParsecT String u Identity String]
-&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
[ParsecT s u m a] -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="annot"><span class="annottext">([ParsecT String u Identity String]
 -&gt; ParsecT String u Identity String)
-&gt; [ParsecT String u Identity String]
-&gt; ParsecT String u Identity String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; ParsecT String u Identity String)
-&gt; String -&gt; [ParsecT String u Identity String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679115076"><span class="annot"><span class="annottext">x :: Char
</span><a href="#local-6989586621679115076"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115076"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;'&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115077"><span class="hs-identifier hs-var">csPrefixes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span class="hs-operator">&gt;</span><span>                   </span><span class="annot"><span class="annottext">[ParsecT String u Identity String]
-&gt; [ParsecT String u Identity String]
-&gt; [ParsecT String u Identity String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;u&amp;'&quot;</span></span><span>
</span><span id="line-285"></span><span class="hs-operator">&gt;</span><span>                      </span><span class="hs-special">,</span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;U&amp;'&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-identifier">numbers</span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-identifier">digits</span><span>
</span><span id="line-290"></span><span class="hs-identifier">digits</span><span class="hs-operator">.</span><span class="hs-special">[</span><span class="hs-identifier">digits</span><span class="hs-special">]</span><span class="hs-special">[</span><span class="hs-identifier">e</span><span class="hs-special">[</span><span class="hs-operator">+-</span><span class="hs-special">]</span><span class="hs-identifier">digits</span><span class="hs-special">]</span><span>
</span><span id="line-291"></span><span class="hs-special">[</span><span class="hs-identifier">digits</span><span class="hs-special">]</span><span class="hs-operator">.</span><span class="hs-identifier">digits</span><span class="hs-special">[</span><span class="hs-identifier">e</span><span class="hs-special">[</span><span class="hs-operator">+-</span><span class="hs-special">]</span><span class="hs-identifier">digits</span><span class="hs-special">]</span><span>
</span><span id="line-292"></span><span class="hs-identifier">digitse</span><span class="hs-special">[</span><span class="hs-operator">+-</span><span class="hs-special">]</span><span class="hs-identifier">digits</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">digits</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">one</span><span> </span><span class="hs-identifier">or</span><span> </span><span class="hs-identifier">more</span><span> </span><span class="hs-identifier">decimal</span><span> </span><span class="hs-identifier">digits</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-identifier">through</span><span> </span><span class="hs-number">9</span><span class="hs-special">)</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">At</span><span> </span><span class="hs-identifier">least</span><span> </span><span class="hs-identifier">one</span><span>
</span><span id="line-295"></span><span class="hs-identifier">digit</span><span> </span><span class="hs-identifier">must</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">before</span><span> </span><span class="hs-identifier">or</span><span> </span><span class="hs-identifier">after</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">decimal</span><span> </span><span class="hs-identifier">point</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">one</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">used</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">At</span><span>
</span><span id="line-296"></span><span class="hs-identifier">least</span><span> </span><span class="hs-identifier">one</span><span> </span><span class="hs-identifier">digit</span><span> </span><span class="hs-identifier">must</span><span> </span><span class="hs-identifier">follow</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">exponent</span><span> </span><span class="hs-identifier">marker</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">e</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">one</span><span> </span><span class="hs-identifier">is</span><span>
</span><span id="line-297"></span><span class="hs-identifier">present</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">There</span><span> </span><span class="hs-identifier">cannot</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">any</span><span> </span><span class="hs-identifier">spaces</span><span> </span><span class="hs-identifier">or</span><span> </span><span class="hs-identifier">other</span><span> </span><span class="hs-identifier">characters</span><span> </span><span class="hs-identifier">embedded</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-298"></span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">constant</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Note</span><span> </span><span class="hs-identifier">that</span><span> </span><span class="hs-identifier">any</span><span> </span><span class="hs-identifier">leading</span><span> </span><span class="hs-identifier">plus</span><span> </span><span class="hs-identifier">or</span><span> </span><span class="hs-identifier">minus</span><span> </span><span class="hs-identifier">sign</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-identifier">actually</span><span>
</span><span id="line-299"></span><span class="hs-identifier">considered</span><span> </span><span class="hs-identifier">part</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">constant</span><span class="hs-special">;</span><span> </span><span class="hs-identifier">it</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">an</span><span> </span><span class="hs-identifier">operator</span><span> </span><span class="hs-identifier">applied</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">the</span><span>
</span><span id="line-300"></span><span class="hs-identifier">constant</span><span class="hs-operator">.</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#sqlNumber"><span class="hs-identifier hs-type">sqlNumber</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-303"></span><span class="hs-operator">&gt;</span><span> </span><span id="sqlNumber"><span class="annot"><span class="annottext">sqlNumber :: Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlNumber"><span class="hs-identifier hs-var hs-var">sqlNumber</span></a></span></span><span> </span><span id="local-6989586621679115075"><span class="annot"><span class="annottext">d :: Dialect
</span><a href="#local-6989586621679115075"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-304"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="annottext">String -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-var">SqlNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
</span><a href="#local-6989586621679115074"><span class="hs-identifier hs-var">completeNumber</span></a></span><span>
</span><span id="line-305"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- this is for definitely avoiding possibly ambiguous source</span><span>
</span><span id="line-306"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="annottext">ParsecT String () Identity Token
-&gt; ParsecT String () Identity ()
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">[ParsecT String () Identity ()] -&gt; ParsecT String () Identity ()
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
[ParsecT s u m a] -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="hs-comment">-- special case to allow e.g. 1..2</span><span>
</span><span id="line-307"></span><span class="hs-operator">&gt;</span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; ParsecT String () Identity ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115075"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span class="hs-operator">&gt;</span><span>                </span><span class="annot"><span class="annottext">ParsecT String () Identity ()
-&gt; ParsecT String () Identity () -&gt; ParsecT String () Identity ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT String () Identity String -&gt; ParsecT String () Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT String () Identity String
 -&gt; ParsecT String () Identity ())
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">lookAhead</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT String () Identity String
 -&gt; ParsecT String () Identity String)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT String () Identity String
 -&gt; ParsecT String () Identity String)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;..&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span class="hs-operator">&gt;</span><span>                   </span><span class="annot"><span class="annottext">ParsecT String () Identity ()
-&gt; ParsecT String () Identity () -&gt; ParsecT String () Identity ()
forall s u (m :: * -&gt; *) a.
ParsecT s u m a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity () -&gt; ParsecT String () Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT String () Identity Char -&gt; ParsecT String () Identity ()
forall s (m :: * -&gt; *) t a u.
(Stream s m t, Show a) =&gt;
ParsecT s u m a -&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">oneOf</span></span><span> </span><span class="annot"><span class="hs-string">&quot;eE.&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span class="hs-operator">&gt;</span><span>               </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT String () Identity Char -&gt; ParsecT String () Identity ()
forall s (m :: * -&gt; *) t a u.
(Stream s m t, Show a) =&gt;
ParsecT s u m a -&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">oneOf</span></span><span> </span><span class="annot"><span class="hs-string">&quot;eE.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span class="hs-operator">&gt;</span><span>               </span><span class="hs-special">]</span><span>
</span><span id="line-312"></span><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115074"><span class="annot"><span class="annottext">completeNumber :: ParsecT String () Identity String
</span><a href="#local-6989586621679115074"><span class="hs-identifier hs-var hs-var">completeNumber</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-314"></span><span class="hs-operator">&gt;</span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT String () Identity String
forall u. ParsecT String u Identity String
</span><a href="#local-6989586621679115072"><span class="hs-identifier hs-var">int</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; GenParser Char () ShowS -&gt; ParsecT String () Identity String
forall t s a.
GenParser t s a -&gt; GenParser t s (a -&gt; a) -&gt; GenParser t s a
</span><a href="Language.SQL.SimpleSQL.Combinators.html#%3C%3F%3F%3E"><span class="hs-operator hs-var">&lt;??&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT String () Identity String -&gt; GenParser Char () ShowS
forall a.
ParsecT String () Identity [a]
-&gt; ParsecT String () Identity ([a] -&gt; [a])
</span><a href="#local-6989586621679115070"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
forall u. ParsecT String u Identity String
</span><a href="#local-6989586621679115069"><span class="hs-identifier hs-var">dot</span></a></span><span> </span><span class="annot"><span class="annottext">GenParser Char () ShowS
-&gt; GenParser Char () ShowS -&gt; GenParser Char () ShowS
forall t s a.
GenParser t s (a -&gt; a)
-&gt; GenParser t s (a -&gt; a) -&gt; GenParser t s (a -&gt; a)
</span><a href="Language.SQL.SimpleSQL.Combinators.html#%3C%3F%3F.%3E"><span class="hs-operator hs-var">&lt;??.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String -&gt; GenParser Char () ShowS
forall a.
ParsecT String () Identity [a]
-&gt; ParsecT String () Identity ([a] -&gt; [a])
</span><a href="#local-6989586621679115070"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
forall u. ParsecT String u Identity String
</span><a href="#local-6989586621679115072"><span class="hs-identifier hs-var">int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span class="hs-operator">&gt;</span><span>       </span><span class="hs-comment">-- try is used in case we read a dot</span><span>
</span><span id="line-316"></span><span class="hs-operator">&gt;</span><span>       </span><span class="hs-comment">-- and it isn't part of a number</span><span>
</span><span id="line-317"></span><span class="hs-operator">&gt;</span><span>       </span><span class="hs-comment">-- if there are any following digits, then we commit</span><span>
</span><span id="line-318"></span><span class="hs-operator">&gt;</span><span>       </span><span class="hs-comment">-- to it being a number and not something else</span><span>
</span><span id="line-319"></span><span class="hs-operator">&gt;</span><span>       </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall s u (m :: * -&gt; *) a.
ParsecT s u m a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ShowS)
-&gt; ParsecT String () Identity String -&gt; GenParser Char () ShowS
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
forall u. ParsecT String u Identity String
</span><a href="#local-6989586621679115069"><span class="hs-identifier hs-var">dot</span></a></span><span> </span><span class="annot"><span class="annottext">GenParser Char () ShowS
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
forall u. ParsecT String u Identity String
</span><a href="#local-6989586621679115072"><span class="hs-identifier hs-var">int</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span class="hs-operator">&gt;</span><span>       </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; GenParser Char () ShowS -&gt; ParsecT String () Identity String
forall t s a.
GenParser t s a -&gt; GenParser t s (a -&gt; a) -&gt; GenParser t s a
</span><a href="Language.SQL.SimpleSQL.Combinators.html#%3C%3F%3F%3E"><span class="hs-operator hs-var">&lt;??&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String -&gt; GenParser Char () ShowS
forall a.
ParsecT String () Identity [a]
-&gt; ParsecT String () Identity ([a] -&gt; [a])
</span><a href="#local-6989586621679115070"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
forall u. ParsecT String u Identity String
</span><a href="#local-6989586621679115067"><span class="hs-identifier hs-var">expon</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115072"><span class="annot"><span class="annottext">int :: ParsecT String u Identity String
</span><a href="#local-6989586621679115072"><span class="hs-identifier hs-var hs-var">int</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m [a]
</span><span class="hs-identifier hs-var">many1</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char
forall s (m :: * -&gt; *) u. Stream s m Char =&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">digit</span></span><span>
</span><span id="line-323"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- make sure we don't parse two adjacent dots in a number</span><span>
</span><span id="line-324"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- special case for postgresql, we backtrack if we see two adjacent dots</span><span>
</span><span id="line-325"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- to parse 1..2, but in other dialects we commit to the failure</span><span>
</span><span id="line-326"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115069"><span class="annot"><span class="annottext">dot :: ParsecT String u Identity String
</span><a href="#local-6989586621679115069"><span class="hs-identifier hs-var hs-var">dot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679115066"><span class="annot"><span class="annottext">p :: ParsecT String u Identity String
</span><a href="#local-6989586621679115066"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity String
-&gt; ParsecT String u Identity () -&gt; ParsecT String u Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity ()
forall s (m :: * -&gt; *) t a u.
(Stream s m t, Show a) =&gt;
ParsecT s u m a -&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'.'</span></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span class="hs-operator">&gt;</span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115075"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-328"></span><span class="hs-operator">&gt;</span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity String
forall u. ParsecT String u Identity String
</span><a href="#local-6989586621679115066"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-329"></span><span class="hs-operator">&gt;</span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity String
forall u. ParsecT String u Identity String
</span><a href="#local-6989586621679115066"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-330"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115067"><span class="annot"><span class="annottext">expon :: ParsecT String u Identity String
</span><a href="#local-6989586621679115067"><span class="hs-identifier hs-var hs-var">expon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; ShowS)
-&gt; ParsecT String u Identity Char
-&gt; ParsecT String u Identity ShowS
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">oneOf</span></span><span> </span><span class="annot"><span class="hs-string">&quot;eE&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity ShowS
-&gt; ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity String
forall u. ParsecT String u Identity String
</span><a href="#local-6989586621679115065"><span class="hs-identifier hs-var">sInt</span></a></span><span>
</span><span id="line-331"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115065"><span class="annot"><span class="annottext">sInt :: ParsecT String u Identity String
</span><a href="#local-6989586621679115065"><span class="hs-identifier hs-var hs-var">sInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ShowS)
-&gt; ParsecT String u Identity String
-&gt; ParsecT String u Identity ShowS
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) t a u.
Stream s m t =&gt;
a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;+&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity String
-&gt; ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall s u (m :: * -&gt; *) a.
ParsecT s u m a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;-&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity ShowS
-&gt; ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity String
forall u. ParsecT String u Identity String
</span><a href="#local-6989586621679115072"><span class="hs-identifier hs-var">int</span></a></span><span>
</span><span id="line-332"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115070"><span class="annot"><span class="annottext">pp :: ParsecT String () Identity [a]
-&gt; ParsecT String () Identity ([a] -&gt; [a])
</span><a href="#local-6989586621679115070"><span class="hs-identifier hs-var hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT String () Identity [a]
-&gt; ([a] -&gt; [a] -&gt; [a]) -&gt; ParsecT String () Identity ([a] -&gt; [a])
forall (f :: * -&gt; *) b a c.
Applicative f =&gt;
f b -&gt; (a -&gt; b -&gt; c) -&gt; f (a -&gt; c)
</span><a href="Language.SQL.SimpleSQL.Combinators.html#%3C%24%24%3E"><span class="hs-operator hs-var">&lt;$$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-identifier">Symbols</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-identifier">A</span><span> </span><span class="hs-identifier">symbol</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">an</span><span> </span><span class="hs-identifier">operator</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">or</span><span> </span><span class="hs-identifier">one</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">misc</span><span> </span><span class="hs-identifier">symbols</span><span> </span><span class="hs-identifier">which</span><span> </span><span class="hs-identifier">include</span><span class="hs-glyph">:</span><span>
</span><span id="line-337"></span><span class="hs-operator">.</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-operator">:=</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator">?</span><span> </span><span class="hs-special">;</span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">for</span><span> </span><span class="hs-identifier">odbc</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="hs-identifier">The</span><span> </span><span class="hs-identifier">postgresql</span><span> </span><span class="hs-identifier">operator</span><span> </span><span class="hs-identifier">syntax</span><span> </span><span class="hs-identifier">allows</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">huge</span><span> </span><span class="hs-identifier">range</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">operators</span><span>
</span><span id="line-340"></span><span class="hs-identifier">compared</span><span> </span><span class="hs-identifier">with</span><span> </span><span class="hs-identifier">ansi</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">other</span><span> </span><span class="hs-identifier">dialects</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#symbol"><span class="hs-identifier hs-type">symbol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-343"></span><span class="hs-operator">&gt;</span><span> </span><span id="symbol"><span class="annot"><span class="annottext">symbol :: Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#symbol"><span class="hs-identifier hs-var hs-var">symbol</span></a></span></span><span> </span><span id="local-6989586621679115063"><span class="annot"><span class="annottext">d :: Dialect
</span><a href="#local-6989586621679115063"><span class="hs-identifier hs-var">d</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-var">Symbol</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ParsecT String () Identity String]
-&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
[ParsecT s u m a] -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[ParsecT String () Identity String]]
-&gt; [ParsecT String () Identity String]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-344"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[ParsecT String () Identity String]
forall u. [ParsecT String u Identity String]
</span><a href="#local-6989586621679115062"><span class="hs-identifier hs-var">dots</span></a></span><span>
</span><span id="line-345"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">,</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115063"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-346"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[ParsecT String () Identity String]
forall u. [ParsecT String u Identity String]
</span><a href="#local-6989586621679115061"><span class="hs-identifier hs-var">postgresExtraSymbols</span></a></span><span>
</span><span id="line-347"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-348"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">[ParsecT String () Identity String]
forall u. [ParsecT String u Identity String]
</span><a href="#local-6989586621679115060"><span class="hs-identifier hs-var">miscSymbol</span></a></span><span>
</span><span id="line-349"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">,</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diOdbc"><span class="hs-identifier hs-var hs-var">diOdbc</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115063"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[ParsecT String () Identity String]
forall u. [ParsecT String u Identity String]
</span><a href="#local-6989586621679115058"><span class="hs-identifier hs-var">odbcSymbol</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-350"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">,</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115063"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-351"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[ParsecT String () Identity String]
</span><a href="Language.SQL.SimpleSQL.Lex.html#generalizedPostgresqlOperator"><span class="hs-identifier hs-var">generalizedPostgresqlOperator</span></a></span><span>
</span><span id="line-352"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[ParsecT String () Identity String]
forall u. [ParsecT String u Identity String]
</span><a href="#local-6989586621679115056"><span class="hs-identifier hs-var">basicAnsiOps</span></a></span><span>
</span><span id="line-353"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span class="hs-operator">&gt;</span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span class="hs-operator">&gt;</span><span>    </span><span id="local-6989586621679115062"><span class="annot"><span class="annottext">dots :: [ParsecT String u Identity String]
</span><a href="#local-6989586621679115062"><span class="hs-identifier hs-var hs-var">dots</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m [a]
</span><span class="hs-identifier hs-var">many1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'.'</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-356"></span><span class="hs-operator">&gt;</span><span>    </span><span id="local-6989586621679115058"><span class="annot"><span class="annottext">odbcSymbol :: [ParsecT String u Identity String]
</span><a href="#local-6989586621679115058"><span class="hs-identifier hs-var hs-var">odbcSymbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;{&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;}&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-357"></span><span class="hs-operator">&gt;</span><span>    </span><span id="local-6989586621679115061"><span class="annot"><span class="annottext">postgresExtraSymbols :: [ParsecT String u Identity String]
</span><a href="#local-6989586621679115061"><span class="hs-identifier hs-var hs-var">postgresExtraSymbols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-358"></span><span class="hs-operator">&gt;</span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;:=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span class="hs-operator">&gt;</span><span>         </span><span class="hs-comment">-- parse :: and : and avoid allowing ::: or more</span><span>
</span><span id="line-360"></span><span class="hs-operator">&gt;</span><span>        </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;::&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity String
-&gt; ParsecT String u Identity () -&gt; ParsecT String u Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity ()
forall s (m :: * -&gt; *) t a u.
(Stream s m t, Show a) =&gt;
ParsecT s u m a -&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">':'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span class="hs-operator">&gt;</span><span>        </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity String
-&gt; ParsecT String u Identity () -&gt; ParsecT String u Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity ()
forall s (m :: * -&gt; *) t a u.
(Stream s m t, Show a) =&gt;
ParsecT s u m a -&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">':'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-362"></span><span class="hs-operator">&gt;</span><span>    </span><span id="local-6989586621679115060"><span class="annot"><span class="annottext">miscSymbol :: [ParsecT String u Identity String]
</span><a href="#local-6989586621679115060"><span class="hs-identifier hs-var hs-var">miscSymbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; ParsecT String u Identity String)
-&gt; String -&gt; [ParsecT String u Identity String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ParsecT String u Identity String)
-&gt; (Char -&gt; String) -&gt; Char -&gt; ParsecT String u Identity String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; [ParsecT String u Identity String])
-&gt; String -&gt; [ParsecT String u Identity String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-363"></span><span class="hs-operator">&gt;</span><span>                 </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-364"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diSqlServerSymbols"><span class="hs-identifier hs-var hs-var">diSqlServerSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115063"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;,;():?&quot;</span></span><span>
</span><span id="line-365"></span><span class="hs-operator">&gt;</span><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115063"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;[],;()&quot;</span></span><span>
</span><span id="line-366"></span><span class="hs-operator">&gt;</span><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-string">&quot;[],;():?&quot;</span></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-identifier">try</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">used</span><span> </span><span class="hs-identifier">because</span><span> </span><span class="hs-identifier">most</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">first</span><span> </span><span class="hs-identifier">characters</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">two</span><span> </span><span class="hs-identifier">character</span><span>
</span><span id="line-369"></span><span class="hs-identifier">symbols</span><span> </span><span class="hs-identifier">can</span><span> </span><span class="hs-identifier">also</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">part</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">single</span><span> </span><span class="hs-identifier">character</span><span> </span><span class="hs-identifier">symbol</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-operator">&gt;</span><span>    </span><span id="local-6989586621679115056"><span class="annot"><span class="annottext">basicAnsiOps :: [ParsecT String u Identity String]
</span><a href="#local-6989586621679115056"><span class="hs-identifier hs-var hs-var">basicAnsiOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; ParsecT String u Identity String)
-&gt; [String] -&gt; [ParsecT String u Identity String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT String u Identity String
 -&gt; ParsecT String u Identity String)
-&gt; (String -&gt; ParsecT String u Identity String)
-&gt; String
-&gt; ParsecT String u Identity String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;&gt;=&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;&lt;=&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;!=&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;&lt;&gt;&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-372"></span><span class="hs-operator">&gt;</span><span>                   </span><span class="annot"><span class="annottext">[ParsecT String u Identity String]
-&gt; [ParsecT String u Identity String]
-&gt; [ParsecT String u Identity String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; ParsecT String u Identity String)
-&gt; String -&gt; [ParsecT String u Identity String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ParsecT String u Identity String)
-&gt; (Char -&gt; String) -&gt; Char -&gt; ParsecT String u Identity String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-string">&quot;+-^*/%~&amp;&lt;&gt;=&quot;</span></span><span>
</span><span id="line-373"></span><span class="hs-operator">&gt;</span><span>                   </span><span class="annot"><span class="annottext">[ParsecT String u Identity String]
-&gt; [ParsecT String u Identity String]
-&gt; [ParsecT String u Identity String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[ParsecT String u Identity String]
forall u. [ParsecT String u Identity String]
</span><a href="#local-6989586621679115054"><span class="hs-identifier hs-var">pipes</span></a></span><span>
</span><span id="line-374"></span><span class="hs-operator">&gt;</span><span>    </span><span id="local-6989586621679115054"><span class="annot"><span class="annottext">pipes :: [ParsecT String u Identity String]
</span><a href="#local-6989586621679115054"><span class="hs-identifier hs-var hs-var">pipes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- what about using many1 (char '|'), then it will</span><span>
</span><span id="line-375"></span><span class="hs-operator">&gt;</span><span>            </span><span class="hs-comment">-- fail in the parser? Not sure exactly how</span><span>
</span><span id="line-376"></span><span class="hs-operator">&gt;</span><span>            </span><span class="hs-comment">-- standalone the lexer should be</span><span>
</span><span id="line-377"></span><span class="hs-operator">&gt;</span><span>            </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'|'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char
-&gt; ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span>
</span><span id="line-378"></span><span class="hs-operator">&gt;</span><span>             </span><span class="annot"><span class="annottext">[ParsecT String u Identity String]
-&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
[ParsecT s u m a] -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;||&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; ParsecT String u Identity Char
-&gt; ParsecT String u Identity String
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'|'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity String
-&gt; ParsecT String u Identity () -&gt; ParsecT String u Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity ()
forall s (m :: * -&gt; *) t a u.
(Stream s m t, Show a) =&gt;
ParsecT s u m a -&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'|'</span></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span class="hs-operator">&gt;</span><span>                    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-identifier">postgresql</span><span> </span><span class="hs-identifier">generalized</span><span> </span><span class="hs-identifier">operators</span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-identifier">this</span><span> </span><span class="hs-identifier">includes</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">custom</span><span> </span><span class="hs-identifier">operators</span><span> </span><span class="hs-identifier">that</span><span> </span><span class="hs-identifier">postgres</span><span> </span><span class="hs-identifier">supports</span><span class="hs-special">,</span><span>
</span><span id="line-384"></span><span class="hs-identifier">plus</span><span> </span><span class="hs-identifier">all</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">standard</span><span> </span><span class="hs-identifier">operators</span><span> </span><span class="hs-identifier">which</span><span> </span><span class="hs-identifier">could</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">custom</span><span> </span><span class="hs-identifier">operators</span><span>
</span><span id="line-385"></span><span class="hs-identifier">according</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">their</span><span> </span><span class="hs-identifier">grammar</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="hs-identifier">rules</span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="hs-identifier">An</span><span> </span><span class="hs-identifier">operator</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">sequence</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">up</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">NAMEDATALEN</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span> </span><span class="hs-special">(</span><span class="hs-number">63</span><span> </span><span class="hs-identifier">by</span><span> </span><span class="hs-keyword">default</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">characters</span><span> </span><span class="hs-identifier">from</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">following</span><span> </span><span class="hs-identifier">list</span><span class="hs-glyph">:</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="hs-operator">+</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-operator">/</span><span> </span><span class="hs-operator">&lt;</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-glyph">!</span><span> </span><span class="hs-glyph">@</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-operator">%</span><span> </span><span class="hs-operator">^</span><span> </span><span class="hs-operator">&amp;</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">`</span><span> </span><span class="hs-operator">?</span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-identifier">There</span><span> </span><span class="hs-identifier">are</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">few</span><span> </span><span class="hs-identifier">restrictions</span><span> </span><span class="hs-identifier">on</span><span> </span><span class="hs-identifier">operator</span><span> </span><span class="hs-identifier">names</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">however</span><span class="hs-glyph">:</span><span>
</span><span id="line-394"></span><span class="hs-comment">-- and /* cannot appear anywhere in an operator name, since they will be taken as the start of a comment.</span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="hs-identifier">A</span><span> </span><span class="hs-identifier">multiple</span><span class="hs-glyph">-</span><span class="hs-identifier">character</span><span> </span><span class="hs-identifier">operator</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">cannot</span><span> </span><span class="hs-identifier">end</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">or</span><span> </span><span class="hs-glyph">-</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">unless</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">also</span><span> </span><span class="hs-identifier">contains</span><span> </span><span class="hs-identifier">at</span><span> </span><span class="hs-identifier">least</span><span> </span><span class="hs-identifier">one</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">these</span><span> </span><span class="hs-identifier">characters</span><span class="hs-glyph">:</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-glyph">~</span><span> </span><span class="hs-glyph">!</span><span> </span><span class="hs-glyph">@</span><span> </span><span class="hs-operator">#</span><span> </span><span class="hs-operator">%</span><span> </span><span class="hs-operator">^</span><span> </span><span class="hs-operator">&amp;</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">`</span><span> </span><span class="hs-operator">?</span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span class="hs-identifier">which</span><span> </span><span class="hs-identifier">allows</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">last</span><span> </span><span class="hs-identifier">character</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">multi</span><span> </span><span class="hs-identifier">character</span><span> </span><span class="hs-identifier">symbol</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">or</span><span>
</span><span id="line-401"></span><span class="hs-glyph">-</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#generalizedPostgresqlOperator"><span class="hs-identifier hs-type">generalizedPostgresqlOperator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-404"></span><span class="hs-operator">&gt;</span><span> </span><span id="generalizedPostgresqlOperator"><span class="annot"><span class="annottext">generalizedPostgresqlOperator :: [ParsecT String () Identity String]
</span><a href="Language.SQL.SimpleSQL.Lex.html#generalizedPostgresqlOperator"><span class="hs-identifier hs-var hs-var">generalizedPostgresqlOperator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ParsecT String () Identity String
forall u. ParsecT String u Identity String
</span><a href="#local-6989586621679115053"><span class="hs-identifier hs-var">singlePlusMinus</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT String () Identity String
forall u. ParsecT String u Identity String
</span><a href="#local-6989586621679115052"><span class="hs-identifier hs-var">opMoreChars</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-405"></span><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-406"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115051"><span class="annot"><span class="annottext">allOpSymbols :: String
</span><a href="#local-6989586621679115051"><span class="hs-identifier hs-var hs-var">allOpSymbols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;+-*/&lt;&gt;=~!@#%^&amp;|`?&quot;</span></span><span>
</span><span id="line-407"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- these are the symbols when if part of a multi character</span><span>
</span><span id="line-408"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- operator permit the operator to end with a + or - symbol</span><span>
</span><span id="line-409"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115050"><span class="annot"><span class="annottext">exceptionOpSymbols :: String
</span><a href="#local-6989586621679115050"><span class="hs-identifier hs-var hs-var">exceptionOpSymbols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;~!@#%^&amp;|`?&quot;</span></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- special case for parsing a single + or - symbol</span><span>
</span><span id="line-412"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115053"><span class="annot"><span class="annottext">singlePlusMinus :: ParsecT String u Identity String
</span><a href="#local-6989586621679115053"><span class="hs-identifier hs-var hs-var">singlePlusMinus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT String u Identity String
 -&gt; ParsecT String u Identity String)
-&gt; ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-413"></span><span class="hs-operator">&gt;</span><span>       </span><span id="local-6989586621679115049"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115049"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">oneOf</span></span><span> </span><span class="annot"><span class="hs-string">&quot;+-&quot;</span></span><span>
</span><span id="line-414"></span><span class="hs-operator">&gt;</span><span>       </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity ()
forall s (m :: * -&gt; *) t a u.
(Stream s m t, Show a) =&gt;
ParsecT s u m a -&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT String u Identity Char -&gt; ParsecT String u Identity ())
-&gt; ParsecT String u Identity Char -&gt; ParsecT String u Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">oneOf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115051"><span class="hs-identifier hs-var">allOpSymbols</span></a></span><span>
</span><span id="line-415"></span><span class="hs-operator">&gt;</span><span>       </span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115049"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- this is used when we are parsing a potentially multi symbol</span><span>
</span><span id="line-418"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- operator and we have alread seen one of the 'exception chars'</span><span>
</span><span id="line-419"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- and so we can end with a + or -</span><span>
</span><span id="line-420"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115048"><span class="annot"><span class="annottext">moreOpCharsException :: ParsecT String u Identity String
</span><a href="#local-6989586621679115048"><span class="hs-identifier hs-var hs-var">moreOpCharsException</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-421"></span><span class="hs-operator">&gt;</span><span>        </span><span id="local-6989586621679115047"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115047"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">oneOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ShowS
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="hs-string">&quot;-/*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115051"><span class="hs-identifier hs-var">allOpSymbols</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span class="hs-operator">&gt;</span><span>             </span><span class="hs-comment">-- make sure we don't parse a comment starting token</span><span>
</span><span id="line-423"></span><span class="hs-operator">&gt;</span><span>             </span><span class="hs-comment">-- as part of an operator</span><span>
</span><span id="line-424"></span><span class="hs-operator">&gt;</span><span>             </span><span class="annot"><span class="annottext">ParsecT String u Identity Char
-&gt; ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall s u (m :: * -&gt; *) a.
ParsecT s u m a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'/'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char
-&gt; ParsecT String u Identity () -&gt; ParsecT String u Identity Char
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity ()
forall s (m :: * -&gt; *) t a u.
(Stream s m t, Show a) =&gt;
ParsecT s u m a -&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'*'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span class="hs-operator">&gt;</span><span>             </span><span class="annot"><span class="annottext">ParsecT String u Identity Char
-&gt; ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall s u (m :: * -&gt; *) a.
ParsecT s u m a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'-'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char
-&gt; ParsecT String u Identity () -&gt; ParsecT String u Identity Char
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity ()
forall s (m :: * -&gt; *) t a u.
(Stream s m t, Show a) =&gt;
ParsecT s u m a -&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'-'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span class="hs-operator">&gt;</span><span>             </span><span class="hs-comment">-- and make sure we don't parse a block comment end</span><span>
</span><span id="line-427"></span><span class="hs-operator">&gt;</span><span>             </span><span class="hs-comment">-- as part of another symbol</span><span>
</span><span id="line-428"></span><span class="hs-operator">&gt;</span><span>             </span><span class="annot"><span class="annottext">ParsecT String u Identity Char
-&gt; ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall s u (m :: * -&gt; *) a.
ParsecT s u m a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'*'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char
-&gt; ParsecT String u Identity () -&gt; ParsecT String u Identity Char
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity ()
forall s (m :: * -&gt; *) t a u.
(Stream s m t, Show a) =&gt;
ParsecT s u m a -&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span class="hs-operator">&gt;</span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115047"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS
-&gt; ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) t a u.
Stream s m t =&gt;
a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity String
</span><a href="#local-6989586621679115048"><span class="hs-identifier hs-var">moreOpCharsException</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115052"><span class="annot"><span class="annottext">opMoreChars :: ParsecT String u Identity String
</span><a href="#local-6989586621679115052"><span class="hs-identifier hs-var hs-var">opMoreChars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ParsecT String u Identity String]
-&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
[ParsecT s u m a] -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-432"></span><span class="hs-operator">&gt;</span><span>        </span><span class="hs-special">[</span><span class="hs-comment">-- parse an exception char, now we can finish with a + -</span><span>
</span><span id="line-433"></span><span class="hs-operator">&gt;</span><span>         </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span class="hs-operator">&gt;</span><span>         </span><span class="annot"><span class="annottext">(Char -&gt; ShowS)
-&gt; ParsecT String u Identity Char
-&gt; ParsecT String u Identity ShowS
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">oneOf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115050"><span class="hs-identifier hs-var">exceptionOpSymbols</span></a></span><span>
</span><span id="line-435"></span><span class="hs-operator">&gt;</span><span>         </span><span class="annot"><span class="annottext">ParsecT String u Identity ShowS
-&gt; ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) t a u.
Stream s m t =&gt;
a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity String
forall u. ParsecT String u Identity String
</span><a href="#local-6989586621679115048"><span class="hs-identifier hs-var">moreOpCharsException</span></a></span><span>
</span><span id="line-436"></span><span class="hs-operator">&gt;</span><span>        </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span class="hs-operator">&gt;</span><span>         </span><span class="annot"><span class="annottext">(Char -&gt; ShowS)
-&gt; ParsecT String u Identity Char
-&gt; ParsecT String u Identity ShowS
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-comment">-- parse +, make sure it isn't the last symbol</span><span>
</span><span id="line-438"></span><span class="hs-operator">&gt;</span><span>              </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'+'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char
-&gt; ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">lookAhead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">oneOf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115051"><span class="hs-identifier hs-var">allOpSymbols</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span class="hs-operator">&gt;</span><span>              </span><span class="annot"><span class="annottext">ParsecT String u Identity Char
-&gt; ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall s u (m :: * -&gt; *) a.
ParsecT s u m a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-comment">-- parse -, make sure it isn't the last symbol</span><span>
</span><span id="line-440"></span><span class="hs-operator">&gt;</span><span>                  </span><span class="hs-comment">-- or the start of a -- comment</span><span>
</span><span id="line-441"></span><span class="hs-operator">&gt;</span><span>              </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'-'</span></span><span>
</span><span id="line-442"></span><span class="hs-operator">&gt;</span><span>                   </span><span class="annot"><span class="annottext">ParsecT String u Identity Char
-&gt; ParsecT String u Identity () -&gt; ParsecT String u Identity Char
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity ()
forall s (m :: * -&gt; *) t a u.
(Stream s m t, Show a) =&gt;
ParsecT s u m a -&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'-'</span></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span class="hs-operator">&gt;</span><span>                   </span><span class="annot"><span class="annottext">ParsecT String u Identity Char
-&gt; ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">lookAhead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">oneOf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115051"><span class="hs-identifier hs-var">allOpSymbols</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span class="hs-operator">&gt;</span><span>              </span><span class="annot"><span class="annottext">ParsecT String u Identity Char
-&gt; ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall s u (m :: * -&gt; *) a.
ParsecT s u m a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-comment">-- parse / check it isn't the start of a /* comment</span><span>
</span><span id="line-445"></span><span class="hs-operator">&gt;</span><span>              </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'/'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char
-&gt; ParsecT String u Identity () -&gt; ParsecT String u Identity Char
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity ()
forall s (m :: * -&gt; *) t a u.
(Stream s m t, Show a) =&gt;
ParsecT s u m a -&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'*'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span class="hs-operator">&gt;</span><span>              </span><span class="annot"><span class="annottext">ParsecT String u Identity Char
-&gt; ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall s u (m :: * -&gt; *) a.
ParsecT s u m a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-comment">-- make sure we don't parse */ as part of a symbol</span><span>
</span><span id="line-447"></span><span class="hs-operator">&gt;</span><span>              </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'*'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char
-&gt; ParsecT String u Identity () -&gt; ParsecT String u Identity Char
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity Char -&gt; ParsecT String u Identity ()
forall s (m :: * -&gt; *) t a u.
(Stream s m t, Show a) =&gt;
ParsecT s u m a -&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span class="hs-operator">&gt;</span><span>              </span><span class="annot"><span class="annottext">ParsecT String u Identity Char
-&gt; ParsecT String u Identity Char -&gt; ParsecT String u Identity Char
forall s u (m :: * -&gt; *) a.
ParsecT s u m a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-comment">-- any other ansi operator symbol</span><span>
</span><span id="line-449"></span><span class="hs-operator">&gt;</span><span>              </span><span class="annot"><span class="annottext">String -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">oneOf</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&lt;&gt;=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span class="hs-operator">&gt;</span><span>         </span><span class="annot"><span class="annottext">ParsecT String u Identity ShowS
-&gt; ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; ParsecT String u Identity String
-&gt; ParsecT String u Identity String
forall s (m :: * -&gt; *) t a u.
Stream s m t =&gt;
a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity String
</span><a href="#local-6989586621679115052"><span class="hs-identifier hs-var">opMoreChars</span></a></span><span>
</span><span id="line-451"></span><span class="hs-operator">&gt;</span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#sqlWhitespace"><span class="hs-identifier hs-type">sqlWhitespace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-454"></span><span class="hs-operator">&gt;</span><span> </span><span id="sqlWhitespace"><span class="annot"><span class="annottext">sqlWhitespace :: Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlWhitespace"><span class="hs-identifier hs-var hs-var">sqlWhitespace</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Whitespace"><span class="hs-identifier hs-var">Whitespace</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
-&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m [a]
</span><span class="hs-identifier hs-var">many1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
(Char -&gt; Bool) -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#lineComment"><span class="hs-identifier hs-type">lineComment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-457"></span><span class="hs-operator">&gt;</span><span> </span><span id="lineComment"><span class="annot"><span class="annottext">lineComment :: Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#lineComment"><span class="hs-identifier hs-var hs-var">lineComment</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-458"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679115045"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679115045"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#LineComment"><span class="hs-identifier hs-var">LineComment</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Token) -&gt; String -&gt; Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;--&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115045"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-459"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- try is used here in case we see a - symbol</span><span>
</span><span id="line-460"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- once we read two -- then we commit to the comment token</span><span>
</span><span id="line-461"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;--&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-462"></span><span class="hs-operator">&gt;</span><span>         </span><span class="hs-comment">-- todo: there must be a better way to do this</span><span>
</span><span id="line-463"></span><span class="hs-operator">&gt;</span><span>      </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. [a] -&gt; Maybe [a] -&gt; [a]
</span><a href="#local-6989586621679115044"><span class="hs-identifier hs-var">conc</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe String -&gt; String)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity (Maybe String -&gt; String)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
-&gt; ParsecT String () Identity (Maybe String)
-&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) t u a end.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m end -&gt; ParsecT s u m [a]
</span><span class="hs-identifier hs-var">manyTill</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
forall s (m :: * -&gt; *) u. Stream s m Char =&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">anyChar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT String () Identity (Maybe String)
-&gt; ParsecT String () Identity (Maybe String)
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">lookAhead</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity (Maybe String)
forall u. ParsecT String u Identity (Maybe String)
</span><a href="#local-6989586621679115043"><span class="hs-identifier hs-var">lineCommentEnd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity (Maybe String -&gt; String)
-&gt; ParsecT String () Identity (Maybe String)
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity (Maybe String)
forall u. ParsecT String u Identity (Maybe String)
</span><a href="#local-6989586621679115043"><span class="hs-identifier hs-var">lineCommentEnd</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-465"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115044"><span class="annot"><span class="annottext">conc :: [a] -&gt; Maybe [a] -&gt; [a]
</span><a href="#local-6989586621679115044"><span class="hs-identifier hs-var hs-var">conc</span></a></span></span><span> </span><span id="local-6989586621679115042"><span class="annot"><span class="annottext">a :: [a]
</span><a href="#local-6989586621679115042"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115042"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-466"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><a href="#local-6989586621679115044"><span class="hs-identifier hs-var">conc</span></a></span><span> </span><span id="local-6989586621679115041"><span class="annot"><span class="annottext">a :: [a]
</span><a href="#local-6989586621679115041"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679115040"><span class="annot"><span class="annottext">b :: [a]
</span><a href="#local-6989586621679115040"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115041"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679115040"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-467"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115043"><span class="annot"><span class="annottext">lineCommentEnd :: ParsecT String u Identity (Maybe String)
</span><a href="#local-6989586621679115043"><span class="hs-identifier hs-var hs-var">lineCommentEnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-468"></span><span class="hs-operator">&gt;</span><span>         </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
-&gt; ParsecT String u Identity Char
-&gt; ParsecT String u Identity (Maybe String)
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT String u Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
Char -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="hs-char">'\n'</span></span><span>
</span><span id="line-469"></span><span class="hs-operator">&gt;</span><span>         </span><span class="annot"><span class="annottext">ParsecT String u Identity (Maybe String)
-&gt; ParsecT String u Identity (Maybe String)
-&gt; ParsecT String u Identity (Maybe String)
forall s u (m :: * -&gt; *) a.
ParsecT s u m a -&gt; ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
-&gt; ParsecT String u Identity ()
-&gt; ParsecT String u Identity (Maybe String)
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String u Identity ()
forall s (m :: * -&gt; *) t u.
(Stream s m t, Show t) =&gt;
ParsecT s u m ()
</span><span class="hs-identifier hs-var">eof</span></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span class="hs-identifier">Try</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">used</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">block</span><span> </span><span class="hs-identifier">comment</span><span> </span><span class="hs-identifier">for</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">two</span><span> </span><span class="hs-identifier">symbol</span><span> </span><span class="hs-identifier">bits</span><span> </span><span class="hs-identifier">because</span><span> </span><span class="hs-identifier">we</span><span>
</span><span id="line-472"></span><span class="hs-identifier">want</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">backtrack</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">we</span><span> </span><span class="hs-identifier">read</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">first</span><span> </span><span class="hs-identifier">symbol</span><span> </span><span class="hs-identifier">but</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">second</span><span> </span><span class="hs-identifier">symbol</span><span>
</span><span id="line-473"></span><span class="hs-identifier">isn't</span><span> </span><span class="hs-identifier">there</span><span class="hs-operator">.</span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#blockComment"><span class="hs-identifier hs-type">blockComment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-476"></span><span class="hs-operator">&gt;</span><span> </span><span id="blockComment"><span class="annot"><span class="annottext">blockComment :: Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#blockComment"><span class="hs-identifier hs-var hs-var">blockComment</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-477"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679115039"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679115039"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#BlockComment"><span class="hs-identifier hs-var">BlockComment</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Token) -&gt; String -&gt; Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;/*&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115039"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Token)
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-478"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;/*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ParsecT String () Identity String
</span><a href="#local-6989586621679115038"><span class="hs-identifier hs-var">commentSuffix</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-480"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><a href="#local-6989586621679115038"><span class="hs-identifier hs-type">commentSuffix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-481"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115038"><span class="annot"><span class="annottext">commentSuffix :: Int -&gt; ParsecT String () Identity String
</span><a href="#local-6989586621679115038"><span class="hs-identifier hs-var hs-var">commentSuffix</span></a></span></span><span> </span><span id="local-6989586621679115037"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679115037"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-482"></span><span class="hs-operator">&gt;</span><span>       </span><span class="hs-comment">-- read until a possible end comment or nested comment</span><span>
</span><span id="line-483"></span><span class="hs-operator">&gt;</span><span>       </span><span id="local-6989586621679115036"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115036"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ParsecT String () Identity String
</span><a href="Language.SQL.SimpleSQL.Lex.html#takeWhile"><span class="hs-identifier hs-var">takeWhile</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679115034"><span class="annot"><span class="annottext">e :: Char
</span><a href="#local-6989586621679115034"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115034"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-char">'/'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115034"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="hs-char">'*'</span></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span class="hs-operator">&gt;</span><span>       </span><span class="annot"><span class="annottext">[ParsecT String () Identity String]
-&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
[ParsecT s u m a] -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="hs-comment">-- close comment: if the nesting is 0, done</span><span>
</span><span id="line-485"></span><span class="hs-operator">&gt;</span><span>               </span><span class="hs-comment">-- otherwise recurse on commentSuffix</span><span>
</span><span id="line-486"></span><span class="hs-operator">&gt;</span><span>               </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;*/&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679115032"><span class="annot"><span class="annottext">t :: String
</span><a href="#local-6989586621679115032"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115036"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;*/&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-487"></span><span class="hs-operator">&gt;</span><span>                                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115037"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-488"></span><span class="hs-operator">&gt;</span><span>                                       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115032"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-489"></span><span class="hs-operator">&gt;</span><span>                                       </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679115031"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679115031"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115032"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115031"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ParsecT String () Identity String
</span><a href="#local-6989586621679115038"><span class="hs-identifier hs-var">commentSuffix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115037"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span class="hs-operator">&gt;</span><span>               </span><span class="hs-comment">-- nested comment, recurse</span><span>
</span><span id="line-491"></span><span class="hs-operator">&gt;</span><span>              </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;/*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679115030"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679115030"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115036"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;/*&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115030"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ParsecT String () Identity String
</span><a href="#local-6989586621679115038"><span class="hs-identifier hs-var">commentSuffix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115037"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span class="hs-operator">&gt;</span><span>               </span><span class="hs-comment">-- not an end comment or nested comment, continue</span><span>
</span><span id="line-493"></span><span class="hs-operator">&gt;</span><span>              </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679115028"><span class="annot"><span class="annottext">c :: Char
</span><a href="#local-6989586621679115028"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679115027"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679115027"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115036"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115028"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115027"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; ShowS)
-&gt; ParsecT String () Identity Char -&gt; GenParser Char () ShowS
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
forall s (m :: * -&gt; *) u. Stream s m Char =&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">anyChar</span></span><span> </span><span class="annot"><span class="annottext">GenParser Char () ShowS
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ParsecT String () Identity String
</span><a href="#local-6989586621679115038"><span class="hs-identifier hs-var">commentSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679115037"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span class="hs-identifier">This</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">improve</span><span> </span><span class="hs-identifier">user</span><span> </span><span class="hs-identifier">experience</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">provide</span><span> </span><span class="hs-identifier">an</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">we</span><span> </span><span class="hs-identifier">see</span><span> </span><span class="hs-operator">*/</span><span>
</span><span id="line-497"></span><span class="hs-identifier">outside</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">comment</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">This</span><span> </span><span class="hs-identifier">could</span><span> </span><span class="hs-identifier">potentially</span><span> </span><span class="hs-identifier">break</span><span> </span><span class="hs-identifier">postgres</span><span> </span><span class="hs-identifier">ops</span><span> </span><span class="hs-identifier">with</span><span> </span><span class="hs-operator">*/</span><span>
</span><span id="line-498"></span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">them</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">which</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">stupid</span><span> </span><span class="hs-identifier">thing</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-keyword">do</span><span class="hs-special">)</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">In</span><span> </span><span class="hs-identifier">other</span><span> </span><span class="hs-identifier">cases</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">user</span><span>
</span><span id="line-499"></span><span class="hs-identifier">should</span><span> </span><span class="hs-identifier">write</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-operator">/</span><span> </span><span class="hs-identifier">instead</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I</span><span> </span><span class="hs-identifier">can't</span><span> </span><span class="hs-identifier">think</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">any</span><span> </span><span class="hs-identifier">cases</span><span> </span><span class="hs-identifier">when</span><span> </span><span class="hs-identifier">this</span><span> </span><span class="hs-identifier">would</span><span>
</span><span id="line-500"></span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">valid</span><span> </span><span class="hs-identifier">syntax</span><span> </span><span class="hs-identifier">though</span><span class="hs-special">)</span><span class="hs-operator">.</span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#dontParseEndBlockComment"><span class="hs-identifier hs-type">dontParseEndBlockComment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-503"></span><span class="hs-operator">&gt;</span><span> </span><span id="dontParseEndBlockComment"><span class="annot"><span class="annottext">dontParseEndBlockComment :: Dialect -&gt; ParsecT String () Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#dontParseEndBlockComment"><span class="hs-identifier hs-var hs-var">dontParseEndBlockComment</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-504"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- don't use try, then it should commit to the error</span><span>
</span><span id="line-505"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
String -&gt; ParsecT s u m String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;*/&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity String
-&gt; ParsecT String () Identity Token
-&gt; ParsecT String () Identity Token
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity Token
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;comment end without comment start&quot;</span></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span class="hs-identifier">Some</span><span> </span><span class="hs-identifier">helper</span><span> </span><span class="hs-identifier">combinators</span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#startsWith"><span class="hs-identifier hs-type">startsWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-511"></span><span class="hs-operator">&gt;</span><span> </span><span id="startsWith"><span class="annot"><span class="annottext">startsWith :: (Char -&gt; Bool)
-&gt; (Char -&gt; Bool) -&gt; ParsecT String () Identity String
</span><a href="Language.SQL.SimpleSQL.Lex.html#startsWith"><span class="hs-identifier hs-var hs-var">startsWith</span></a></span></span><span> </span><span id="local-6989586621679115026"><span class="annot"><span class="annottext">p :: Char -&gt; Bool
</span><a href="#local-6989586621679115026"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679115025"><span class="annot"><span class="annottext">ps :: Char -&gt; Bool
</span><a href="#local-6989586621679115025"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-512"></span><span class="hs-operator">&gt;</span><span>   </span><span id="local-6989586621679115024"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115024"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
(Char -&gt; Bool) -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679115026"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-513"></span><span class="hs-operator">&gt;</span><span>   </span><span class="annot"><span class="annottext">[ParsecT String () Identity String]
-&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
[ParsecT s u m a] -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115024"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS
-&gt; ParsecT String () Identity String
-&gt; ParsecT String () Identity String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ParsecT String () Identity String
</span><a href="Language.SQL.SimpleSQL.Lex.html#takeWhile1"><span class="hs-identifier hs-var">takeWhile1</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679115025"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span class="hs-operator">&gt;</span><span>          </span><span class="hs-special">,</span><span class="annot"><span class="annottext">String -&gt; ParsecT String () Identity String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115024"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#takeWhile1"><span class="hs-identifier hs-type">takeWhile1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-517"></span><span class="hs-operator">&gt;</span><span> </span><span id="takeWhile1"><span class="annot"><span class="annottext">takeWhile1 :: (Char -&gt; Bool) -&gt; ParsecT String () Identity String
</span><a href="Language.SQL.SimpleSQL.Lex.html#takeWhile1"><span class="hs-identifier hs-var hs-var">takeWhile1</span></a></span></span><span> </span><span id="local-6989586621679115023"><span class="annot"><span class="annottext">p :: Char -&gt; Bool
</span><a href="#local-6989586621679115023"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
-&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m [a]
</span><span class="hs-identifier hs-var">many1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
(Char -&gt; Bool) -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679115023"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#takeWhile"><span class="hs-identifier hs-type">takeWhile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-520"></span><span class="hs-operator">&gt;</span><span> </span><span id="takeWhile"><span class="annot"><span class="annottext">takeWhile :: (Char -&gt; Bool) -&gt; ParsecT String () Identity String
</span><a href="Language.SQL.SimpleSQL.Lex.html#takeWhile"><span class="hs-identifier hs-var hs-var">takeWhile</span></a></span></span><span> </span><span id="local-6989586621679115022"><span class="annot"><span class="annottext">p :: Char -&gt; Bool
</span><a href="#local-6989586621679115022"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
-&gt; ParsecT String () Identity String
forall s u (m :: * -&gt; *) a. ParsecT s u m a -&gt; ParsecT s u m [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
(Char -&gt; Bool) -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679115022"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#takeTill"><span class="hs-identifier hs-type">takeTill</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-523"></span><span class="hs-operator">&gt;</span><span> </span><span id="takeTill"><span class="annot"><span class="annottext">takeTill :: (Char -&gt; Bool) -&gt; ParsecT String () Identity String
</span><a href="Language.SQL.SimpleSQL.Lex.html#takeTill"><span class="hs-identifier hs-var hs-var">takeTill</span></a></span></span><span> </span><span id="local-6989586621679115021"><span class="annot"><span class="annottext">p :: Char -&gt; Bool
</span><a href="#local-6989586621679115021"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
-&gt; ParsecT String () Identity ()
-&gt; ParsecT String () Identity String
forall s (m :: * -&gt; *) t u a end.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m end -&gt; ParsecT s u m [a]
</span><span class="hs-identifier hs-var">manyTill</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char
forall s (m :: * -&gt; *) u. Stream s m Char =&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">anyChar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ParsecT String () Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#peekSatisfy"><span class="hs-identifier hs-var">peekSatisfy</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679115021"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#peekSatisfy"><span class="hs-identifier hs-type">peekSatisfy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span class="hs-operator">&gt;</span><span> </span><span id="peekSatisfy"><span class="annot"><span class="annottext">peekSatisfy :: (Char -&gt; Bool) -&gt; ParsecT String () Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#peekSatisfy"><span class="hs-identifier hs-var hs-var">peekSatisfy</span></a></span></span><span> </span><span id="local-6989586621679115019"><span class="annot"><span class="annottext">p :: Char -&gt; Bool
</span><a href="#local-6989586621679115019"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char -&gt; ParsecT String () Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT String () Identity Char -&gt; ParsecT String () Identity ())
-&gt; ParsecT String () Identity Char -&gt; ParsecT String () Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () Identity Char -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
ParsecT s u m a -&gt; ParsecT s u m a
</span><span class="hs-identifier hs-var">lookAhead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ParsecT String () Identity Char
forall s (m :: * -&gt; *) u.
Stream s m Char =&gt;
(Char -&gt; Bool) -&gt; ParsecT s u m Char
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679115019"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span class="hs-identifier">This</span><span> </span><span class="hs-identifier">utility</span><span> </span><span class="hs-identifier">function</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">accurately</span><span> </span><span class="hs-identifier">report</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">two</span><span> </span><span class="hs-identifier">tokens</span><span> </span><span class="hs-identifier">are</span><span>
</span><span id="line-529"></span><span class="hs-identifier">pretty</span><span> </span><span class="hs-identifier">printed</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">they</span><span> </span><span class="hs-identifier">should</span><span> </span><span class="hs-identifier">lex</span><span> </span><span class="hs-identifier">back</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">same</span><span> </span><span class="hs-identifier">two</span><span> </span><span class="hs-identifier">tokens</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">This</span><span>
</span><span id="line-530"></span><span class="hs-identifier">function</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">used</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">testing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">can</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">used</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">other</span><span> </span><span class="hs-identifier">places</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">and</span><span>
</span><span id="line-531"></span><span class="hs-identifier">must</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">implemented</span><span> </span><span class="hs-identifier">by</span><span> </span><span class="hs-identifier">actually</span><span> </span><span class="hs-identifier">trying</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">print</span><span> </span><span class="hs-identifier">both</span><span> </span><span class="hs-identifier">tokens</span><span> </span><span class="hs-identifier">and</span><span>
</span><span id="line-532"></span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">lex</span><span> </span><span class="hs-identifier">them</span><span> </span><span class="hs-identifier">back</span><span> </span><span class="hs-identifier">from</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">single</span><span> </span><span class="hs-identifier">string</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">because</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">we</span><span> </span><span class="hs-identifier">would</span><span> </span><span class="hs-identifier">have</span><span>
</span><span id="line-533"></span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">risk</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">thinking</span><span> </span><span class="hs-identifier">two</span><span> </span><span class="hs-identifier">tokens</span><span> </span><span class="hs-identifier">cannot</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">together</span><span> </span><span class="hs-identifier">when</span><span> </span><span class="hs-identifier">there</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">bug</span><span>
</span><span id="line-534"></span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">lexer</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">which</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">testing</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">supposed</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">find</span><span class="hs-special">)</span><span class="hs-operator">.</span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span class="hs-identifier">maybe</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">some</span><span> </span><span class="hs-identifier">quick</span><span> </span><span class="hs-identifier">checking</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">make</span><span> </span><span class="hs-identifier">sure</span><span> </span><span class="hs-identifier">this</span><span> </span><span class="hs-identifier">function</span><span> </span><span class="hs-identifier">only</span><span> </span><span class="hs-identifier">gives</span><span>
</span><span id="line-537"></span><span class="hs-identifier">true</span><span> </span><span class="hs-identifier">negatives</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">check</span><span> </span><span class="hs-identifier">pairs</span><span> </span><span class="hs-identifier">which</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">false</span><span> </span><span class="hs-identifier">actually</span><span> </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">lex</span><span> </span><span class="hs-identifier">or</span><span>
</span><span id="line-538"></span><span class="hs-identifier">give</span><span> </span><span class="hs-identifier">different</span><span> </span><span class="hs-identifier">symbols</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">return</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">could</span><span> </span><span class="hs-identifier">use</span><span> </span><span class="hs-identifier">quickcheck</span><span> </span><span class="hs-identifier">for</span><span> </span><span class="hs-identifier">this</span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">good</span><span> </span><span class="hs-identifier">sanity</span><span> </span><span class="hs-identifier">test</span><span> </span><span class="hs-identifier">for</span><span> </span><span class="hs-identifier">this</span><span> </span><span class="hs-identifier">function</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">change</span><span> </span><span class="hs-identifier">it</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">always</span><span> </span><span class="hs-identifier">return</span><span>
</span><span id="line-541"></span><span class="hs-identifier">true</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">check</span><span> </span><span class="hs-identifier">that</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">automated</span><span> </span><span class="hs-identifier">tests</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">same</span><span> </span><span class="hs-identifier">number</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-542"></span><span class="hs-identifier">successes</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">I</span><span> </span><span class="hs-identifier">don't</span><span> </span><span class="hs-identifier">think</span><span> </span><span class="hs-identifier">it</span><span> </span><span class="hs-identifier">succeeds</span><span> </span><span class="hs-identifier">this</span><span> </span><span class="hs-identifier">test</span><span> </span><span class="hs-identifier">at</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">moment</span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-comment">-- | Utility function to tell you if a list of tokens</span><span>
</span><span id="line-545"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-comment">-- will pretty print then lex back to the same set of tokens.</span><span>
</span><span id="line-546"></span><span class="hs-operator">&gt;</span><span> </span><span class="hs-comment">-- Used internally, might be useful for generating SQL via lexical tokens.</span><span>
</span><span id="line-547"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier hs-type">tokenListWillPrintAndLex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-548"></span><span class="hs-operator">&gt;</span><span> </span><span id="tokenListWillPrintAndLex"><span class="annot"><span class="annottext">tokenListWillPrintAndLex :: Dialect -&gt; [Token] -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier hs-var hs-var">tokenListWillPrintAndLex</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-549"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier hs-var">tokenListWillPrintAndLex</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-550"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier hs-var">tokenListWillPrintAndLex</span></a></span><span> </span><span id="local-6989586621679115018"><span class="annot"><span class="annottext">d :: Dialect
</span><a href="#local-6989586621679115018"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679115017"><span class="annot"><span class="annottext">a :: Token
</span><a href="#local-6989586621679115017"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679115016"><span class="annot"><span class="annottext">b :: Token
</span><a href="#local-6989586621679115016"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679115015"><span class="annot"><span class="annottext">xs :: [Token]
</span><a href="#local-6989586621679115015"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-551"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><span class="annottext">Dialect -&gt; Token -&gt; Token -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokensWillPrintAndLex"><span class="hs-identifier hs-var">tokensWillPrintAndLex</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115018"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115017"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115016"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; [Token] -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier hs-var">tokenListWillPrintAndLex</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115018"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115016"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679115015"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span class="hs-operator">&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#tokensWillPrintAndLex"><span class="hs-identifier hs-type">tokensWillPrintAndLex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-554"></span><span class="hs-operator">&gt;</span><span> </span><span id="tokensWillPrintAndLex"><span class="annot"><span class="annottext">tokensWillPrintAndLex :: Dialect -&gt; Token -&gt; Token -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokensWillPrintAndLex"><span class="hs-identifier hs-var hs-var">tokensWillPrintAndLex</span></a></span></span><span> </span><span id="local-6989586621679115013"><span class="annot"><span class="annottext">d :: Dialect
</span><a href="#local-6989586621679115013"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679115012"><span class="annot"><span class="annottext">a :: Token
</span><a href="#local-6989586621679115012"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679115011"><span class="annot"><span class="annottext">b :: Token
</span><a href="#local-6989586621679115011"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-555"></span><span>
</span><span id="line-556"></span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">followed</span><span> </span><span class="hs-identifier">by</span><span> </span><span class="hs-identifier">an</span><span> </span><span class="hs-identifier">identifier</span><span> </span><span class="hs-identifier">character</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">look</span><span> </span><span class="hs-identifier">like</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">host</span><span> </span><span class="hs-identifier">param</span><span>
</span><span id="line-557"></span><span class="hs-identifier">followed</span><span> </span><span class="hs-identifier">by</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">or</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">makes</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">different</span><span> </span><span class="hs-identifier">symbol</span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span class="hs-string">&quot;:&quot;</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115012"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-560"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679115010"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679115009"><span class="annot"><span class="annottext">x :: Char
</span><a href="#local-6989586621679115009"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-var">isIdentifierChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115009"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679115009"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="hs-string">&quot;:=&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="hs-identifier">two</span><span> </span><span class="hs-identifier">symbols</span><span> </span><span class="hs-identifier">next</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">eachother</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">fail</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">symbols</span><span> </span><span class="hs-identifier">can</span><span> </span><span class="hs-identifier">combine</span><span> </span><span class="hs-identifier">and</span><span>
</span><span id="line-563"></span><span class="hs-special">(</span><span class="hs-identifier">possibly</span><span> </span><span class="hs-identifier">just</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">prefix</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">look</span><span> </span><span class="hs-identifier">like</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">different</span><span> </span><span class="hs-identifier">symbol</span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115013"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-566"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span id="local-6989586621679115008"><span class="annot"><span class="annottext">a' :: String
</span><a href="#local-6989586621679115008"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115012"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-567"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span id="local-6989586621679115007"><span class="annot"><span class="annottext">b' :: String
</span><a href="#local-6989586621679115007"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115011"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-568"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115007"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;+&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;-&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115008"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-string">&quot;~!@#%^&amp;|`?&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span class="hs-identifier">check</span><span> </span><span class="hs-identifier">two</span><span> </span><span class="hs-identifier">adjacent</span><span> </span><span class="hs-identifier">symbols</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">non</span><span> </span><span class="hs-identifier">postgres</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">combination</span><span>
</span><span id="line-571"></span><span class="hs-identifier">possibilities</span><span> </span><span class="hs-identifier">are</span><span> </span><span class="hs-identifier">much</span><span> </span><span class="hs-identifier">more</span><span> </span><span class="hs-identifier">limited</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">This</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">ansi</span><span> </span><span class="hs-identifier">behaviour</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">it</span><span> </span><span class="hs-identifier">might</span><span>
</span><span id="line-572"></span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">different</span><span> </span><span class="hs-identifier">when</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">other</span><span> </span><span class="hs-identifier">dialects</span><span> </span><span class="hs-identifier">are</span><span> </span><span class="hs-identifier">done</span><span> </span><span class="hs-identifier">properly</span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span id="local-6989586621679115005"><span class="annot"><span class="annottext">a' :: String
</span><a href="#local-6989586621679115005"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115012"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-575"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span id="local-6989586621679115004"><span class="annot"><span class="annottext">b' :: String
</span><a href="#local-6989586621679115004"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115011"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-576"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115005"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679115004"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String, String) -&gt; [(String, String)] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;&lt;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;&gt;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;&lt;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;&gt;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;!&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-580"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;||&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;||&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;||&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;||&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-584"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;&lt;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-string">&quot;&gt;=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span class="hs-operator">&gt;</span><span>                     </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span class="hs-identifier">two</span><span> </span><span class="hs-identifier">whitespaces</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">combined</span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Whitespace"><span class="hs-identifier hs-type">Whitespace</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115012"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-590"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Whitespace"><span class="hs-identifier hs-type">Whitespace</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115011"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span class="hs-identifier">line</span><span> </span><span class="hs-identifier">comment</span><span> </span><span class="hs-identifier">without</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">newline</span><span> </span><span class="hs-identifier">at</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">end</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">eat</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">next</span><span> </span><span class="hs-identifier">token</span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#LineComment"><span class="hs-identifier hs-type">LineComment</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115012"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-595"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679115003"><span class="hs-identifier hs-var">checkLastAChar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span class="hs-identifier">check</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">last</span><span> </span><span class="hs-identifier">character</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">first</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">first</span><span> </span><span class="hs-identifier">character</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-598"></span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">second</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-identifier">forming</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">comment</span><span> </span><span class="hs-identifier">start</span><span> </span><span class="hs-identifier">or</span><span> </span><span class="hs-identifier">end</span><span> </span><span class="hs-identifier">symbol</span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679115002"><span class="annot"><span class="annottext">f :: Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679115002"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-char">'-'</span><span> </span><span class="hs-char">'-'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-601"></span><span class="hs-operator">&gt;</span><span>          </span><span class="annot"><a href="#local-6989586621679115002"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-char">'/'</span><span> </span><span class="hs-char">'*'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-602"></span><span class="hs-operator">&gt;</span><span>          </span><span class="annot"><a href="#local-6989586621679115002"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-char">'*'</span><span> </span><span class="hs-char">'/'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-603"></span><span class="hs-operator">&gt;</span><span>          </span><span class="annot"><a href="#local-6989586621679115002"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-604"></span><span class="hs-operator">&gt;</span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679115001"><span class="hs-identifier hs-var">checkBorderChars</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679115002"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">symbol</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">absorb</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">following</span><span> </span><span class="hs-operator">.</span><span>
</span><span id="line-607"></span><span class="hs-identifier">TODO</span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-number">100</span><span class="hs-operator">%</span><span> </span><span class="hs-identifier">on</span><span> </span><span class="hs-identifier">this</span><span> </span><span class="hs-identifier">always</span><span> </span><span class="hs-identifier">being</span><span> </span><span class="hs-identifier">bad</span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115012"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-610"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679115010"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="hs-char">'.'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span class="hs-identifier">cannot</span><span> </span><span class="hs-identifier">follow</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">symbol</span><span> </span><span class="hs-identifier">ending</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">with</span><span> </span><span class="hs-identifier">another</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-identifier">starting</span><span> </span><span class="hs-identifier">with</span><span> </span><span class="hs-glyph">:</span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679115000"><span class="annot"><span class="annottext">f :: Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679115000"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-char">':'</span><span> </span><span class="hs-char">':'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-615"></span><span class="hs-operator">&gt;</span><span>          </span><span class="annot"><a href="#local-6989586621679115000"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-616"></span><span class="hs-operator">&gt;</span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679115001"><span class="hs-identifier hs-var">checkBorderChars</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679115000"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span class="hs-identifier">unquoted</span><span> </span><span class="hs-identifier">identifier</span><span> </span><span class="hs-identifier">followed</span><span> </span><span class="hs-identifier">by</span><span> </span><span class="hs-identifier">an</span><span> </span><span class="hs-identifier">identifier</span><span> </span><span class="hs-identifier">letter</span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-type">Identifier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115012"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-621"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679115010"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-var">isIdentifierChar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">quoted</span><span> </span><span class="hs-identifier">identifier</span><span> </span><span class="hs-identifier">using</span><span> </span><span class="hs-string">&quot;, followed by a &quot;</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">fail</span><span>
</span><span id="line-624"></span><span>
</span><span id="line-625"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-type">Identifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-string">&quot;\&quot;&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115012"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-626"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679115010"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="hs-char">'&quot;'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span class="hs-identifier">prefixed</span><span> </span><span class="hs-identifier">variable</span><span> </span><span class="hs-identifier">followed</span><span> </span><span class="hs-identifier">by</span><span> </span><span class="hs-identifier">an</span><span> </span><span class="hs-identifier">identifier</span><span> </span><span class="hs-identifier">char</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">absorbed</span><span>
</span><span id="line-629"></span><span>
</span><span id="line-630"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-type">PrefixedVariable</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115012"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-631"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679115010"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-var">isIdentifierChar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">positional</span><span> </span><span class="hs-identifier">arg</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">absorb</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">following</span><span> </span><span class="hs-identifier">digit</span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PositionalArg"><span class="hs-identifier hs-type">PositionalArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115012"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-636"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679115010"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-637"></span><span>
</span><span id="line-638"></span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">string</span><span> </span><span class="hs-identifier">ending</span><span> </span><span class="hs-identifier">with</span><span> </span><span class="hs-special">'</span><span> </span><span class="hs-identifier">followed</span><span> </span><span class="hs-identifier">by</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-identifier">starting</span><span> </span><span class="hs-identifier">with</span><span> </span><span class="hs-special">'</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">absorbed</span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-type">SqlString</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;'&quot;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115012"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-641"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679115010"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="hs-char">'\''</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-642"></span><span>
</span><span id="line-643"></span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">number</span><span> </span><span class="hs-identifier">followed</span><span> </span><span class="hs-identifier">by</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">or</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">absorbed</span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-type">SqlNumber</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115012"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-646"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679115010"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="hs-char">'.'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-647"></span><span>
</span><span id="line-648"></span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">number</span><span> </span><span class="hs-identifier">followed</span><span> </span><span class="hs-identifier">by</span><span> </span><span class="hs-identifier">an</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-identifier">or</span><span> </span><span class="hs-identifier">E</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">or</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">absorbed</span><span>
</span><span id="line-649"></span><span>
</span><span id="line-650"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-type">SqlNumber</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115012"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-651"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679115010"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679114998"><span class="annot"><span class="annottext">x :: Char
</span><a href="#local-6989586621679114998"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679114998"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="hs-char">'e'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679114998"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-char">'E'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-652"></span><span>
</span><span id="line-653"></span><span class="hs-identifier">two</span><span> </span><span class="hs-identifier">numbers</span><span> </span><span class="hs-identifier">next</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">eachother</span><span> </span><span class="hs-identifier">will</span><span> </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">or</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">absorbed</span><span>
</span><span id="line-654"></span><span>
</span><span id="line-655"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-type">SqlNumber</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115012"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-656"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-type">SqlNumber</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115011"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span class="hs-operator">&gt;</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-660"></span><span>
</span><span id="line-661"></span><span class="hs-operator">&gt;</span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-662"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679114997"><span class="annot"><span class="annottext">prettya :: String
</span><a href="#local-6989586621679114997"><span class="hs-identifier hs-var hs-var">prettya</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Token -&gt; String
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115013"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115012"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-663"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679114996"><span class="annot"><span class="annottext">prettyb :: String
</span><a href="#local-6989586621679114996"><span class="hs-identifier hs-var hs-var">prettyb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Token -&gt; String
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679115013"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679115011"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-664"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- helper function to run a predicate on the</span><span>
</span><span id="line-665"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- last character of the first token and the first</span><span>
</span><span id="line-666"></span><span class="hs-operator">&gt;</span><span>     </span><span class="hs-comment">-- character of the second token</span><span>
</span><span id="line-667"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115001"><span class="annot"><span class="annottext">checkBorderChars :: (Char -&gt; Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679115001"><span class="hs-identifier hs-var hs-var">checkBorderChars</span></a></span></span><span> </span><span id="local-6989586621679114995"><span class="annot"><span class="annottext">f :: Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679114995"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-668"></span><span class="hs-operator">&gt;</span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114997"><span class="hs-identifier hs-var">prettya</span></a></span><span>
</span><span id="line-669"></span><span class="hs-operator">&gt;</span><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679114994"><span class="annot"><span class="annottext">fb :: Char
</span><a href="#local-6989586621679114994"><span class="hs-identifier hs-var">fb</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114996"><span class="hs-identifier hs-var">prettyb</span></a></span><span>
</span><span id="line-670"></span><span class="hs-operator">&gt;</span><span>         </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679114993"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679114993"><span class="hs-identifier hs-var">la</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Char
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114997"><span class="hs-identifier hs-var">prettya</span></a></span><span>
</span><span id="line-671"></span><span class="hs-operator">&gt;</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679114995"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679114993"><span class="hs-identifier hs-var">la</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679114994"><span class="hs-identifier hs-var">fb</span></a></span><span>
</span><span id="line-672"></span><span class="hs-operator">&gt;</span><span>     </span><span class="annot"><a href="#local-6989586621679115001"><span class="hs-identifier hs-var">checkBorderChars</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-673"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115010"><span class="annot"><span class="annottext">checkFirstBChar :: (Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679115010"><span class="hs-identifier hs-var hs-var">checkFirstBChar</span></a></span></span><span> </span><span id="local-6989586621679114991"><span class="annot"><span class="annottext">f :: Char -&gt; Bool
</span><a href="#local-6989586621679114991"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114996"><span class="hs-identifier hs-var">prettyb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-674"></span><span class="hs-operator">&gt;</span><span>                           </span><span class="hs-special">(</span><span id="local-6989586621679114990"><span class="annot"><span class="annottext">b' :: Char
</span><a href="#local-6989586621679114990"><span class="hs-identifier hs-var">b'</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679114991"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679114990"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-675"></span><span class="hs-operator">&gt;</span><span>                           </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-676"></span><span class="hs-operator">&gt;</span><span>     </span><span id="local-6989586621679115003"><span class="annot"><span class="annottext">checkLastAChar :: (Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679115003"><span class="hs-identifier hs-var hs-var">checkLastAChar</span></a></span></span><span> </span><span id="local-6989586621679114989"><span class="annot"><span class="annottext">f :: Char -&gt; Bool
</span><a href="#local-6989586621679114989"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114997"><span class="hs-identifier hs-var">prettya</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-677"></span><span class="hs-operator">&gt;</span><span>                           </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679114989"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Char -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Char
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114997"><span class="hs-identifier hs-var">prettya</span></a></span><span>
</span><span id="line-678"></span><span class="hs-operator">&gt;</span><span>                           </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-679"></span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span>
</span><span id="line-682"></span><span>
</span><span id="line-683"></span><span class="hs-identifier">TODO</span><span class="hs-glyph">:</span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span class="hs-identifier">make</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">tokenswill</span><span> </span><span class="hs-identifier">print</span><span> </span><span class="hs-identifier">more</span><span> </span><span class="hs-identifier">dialect</span><span> </span><span class="hs-identifier">accurate</span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">add</span><span> </span><span class="hs-identifier">symbol</span><span>
</span><span id="line-686"></span><span>  </span><span class="hs-identifier">chars</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">identifier</span><span> </span><span class="hs-identifier">chars</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">dialect</span><span> </span><span class="hs-identifier">definition</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">use</span><span> </span><span class="hs-identifier">them</span><span> </span><span class="hs-identifier">from</span><span>
</span><span id="line-687"></span><span>  </span><span class="hs-identifier">here</span><span>
</span><span id="line-688"></span><span>
</span><span id="line-689"></span><span class="hs-identifier">start</span><span> </span><span class="hs-identifier">adding</span><span> </span><span class="hs-identifier">negative</span><span> </span><span class="hs-operator">/</span><span> </span><span class="hs-identifier">different</span><span> </span><span class="hs-identifier">parse</span><span> </span><span class="hs-identifier">dialect</span><span> </span><span class="hs-identifier">tests</span><span>
</span><span id="line-690"></span><span>
</span><span id="line-691"></span><span class="hs-identifier">add</span><span> </span><span class="hs-identifier">token</span><span> </span><span class="hs-identifier">tables</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">tests</span><span> </span><span class="hs-identifier">for</span><span> </span><span class="hs-identifier">oracle</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sql</span><span> </span><span class="hs-identifier">server</span><span>
</span><span id="line-692"></span><span class="hs-identifier">review</span><span> </span><span class="hs-identifier">existing</span><span> </span><span class="hs-identifier">tables</span><span>
</span><span id="line-693"></span><span>
</span><span id="line-694"></span><span class="hs-identifier">look</span><span> </span><span class="hs-identifier">for</span><span> </span><span class="hs-identifier">refactoring</span><span> </span><span class="hs-identifier">opportunities</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">especially</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">token</span><span>
</span><span id="line-695"></span><span class="hs-identifier">generation</span><span> </span><span class="hs-identifier">tables</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">tests</span><span>
</span><span id="line-696"></span><span>
</span><span id="line-697"></span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">some</span><span> </span><span class="hs-identifier">user</span><span> </span><span class="hs-identifier">documentation</span><span> </span><span class="hs-identifier">on</span><span> </span><span class="hs-identifier">lexing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">lexing</span><span class="hs-operator">/</span><span class="hs-identifier">dialects</span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span class="hs-identifier">start</span><span> </span><span class="hs-identifier">thinking</span><span> </span><span class="hs-identifier">about</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">more</span><span> </span><span class="hs-identifier">separated</span><span> </span><span class="hs-identifier">design</span><span> </span><span class="hs-identifier">for</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">dialect</span><span> </span><span class="hs-identifier">handling</span><span>
</span><span id="line-700"></span><span>
</span><span id="line-701"></span><span class="hs-identifier">lexing</span><span> </span><span class="hs-identifier">tests</span><span> </span><span class="hs-identifier">are</span><span> </span><span class="hs-identifier">starting</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">take</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">really</span><span> </span><span class="hs-identifier">long</span><span> </span><span class="hs-identifier">time</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">so</span><span> </span><span class="hs-identifier">split</span><span> </span><span class="hs-identifier">the</span><span>
</span><span id="line-702"></span><span class="hs-identifier">tests</span><span> </span><span class="hs-identifier">so</span><span> </span><span class="hs-identifier">it</span><span> </span><span class="hs-identifier">is</span><span> </span><span class="hs-identifier">much</span><span> </span><span class="hs-identifier">easier</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">run</span><span> </span><span class="hs-identifier">all</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">tests</span><span> </span><span class="hs-identifier">except</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">lexing</span><span>
</span><span id="line-703"></span><span class="hs-identifier">tests</span><span> </span><span class="hs-identifier">which</span><span> </span><span class="hs-identifier">only</span><span> </span><span class="hs-identifier">need</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">run</span><span> </span><span class="hs-identifier">when</span><span> </span><span class="hs-identifier">working</span><span> </span><span class="hs-identifier">on</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">lexer</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">which</span><span>
</span><span id="line-704"></span><span class="hs-identifier">should</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">relatively</span><span> </span><span class="hs-identifier">uncommon</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">or</span><span> </span><span class="hs-identifier">doing</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">commit</span><span> </span><span class="hs-identifier">or</span><span> </span><span class="hs-identifier">finishing</span><span> </span><span class="hs-identifier">off</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-705"></span><span class="hs-identifier">series</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">commits</span><span class="hs-special">,</span><span>
</span><span id="line-706"></span><span>
</span><span id="line-707"></span><span class="hs-identifier">start</span><span> </span><span class="hs-identifier">writing</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-identifier">message</span><span> </span><span class="hs-identifier">tests</span><span class="hs-glyph">:</span><span>
</span><span id="line-708"></span><span>  </span><span class="hs-identifier">generate</span><span class="hs-operator">/</span><span class="hs-identifier">write</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">large</span><span> </span><span class="hs-identifier">number</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">syntax</span><span> </span><span class="hs-identifier">errors</span><span>
</span><span id="line-709"></span><span>  </span><span class="hs-identifier">create</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">table</span><span> </span><span class="hs-identifier">with</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">source</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-identifier">message</span><span>
</span><span id="line-710"></span><span>  </span><span class="hs-identifier">try</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">some</span><span> </span><span class="hs-identifier">different</span><span> </span><span class="hs-identifier">versions</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">code</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">the</span><span>
</span><span id="line-711"></span><span>    </span><span class="hs-identifier">quality</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-identifier">messages</span><span> </span><span class="hs-identifier">by</span><span> </span><span class="hs-identifier">hand</span><span>
</span><span id="line-712"></span><span>
</span><span id="line-713"></span><span>  </span><span class="hs-identifier">get</span><span> </span><span class="hs-identifier">this</span><span> </span><span class="hs-identifier">checked</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">so</span><span> </span><span class="hs-identifier">improvements</span><span> </span><span class="hs-identifier">and</span><span> </span><span class="hs-identifier">regressions</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">error</span><span>
</span><span id="line-714"></span><span>    </span><span class="hs-identifier">message</span><span> </span><span class="hs-identifier">quality</span><span> </span><span class="hs-identifier">can</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">tracked</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">little</span><span> </span><span class="hs-identifier">more</span><span> </span><span class="hs-identifier">easily</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">although</span><span> </span><span class="hs-identifier">it</span><span> </span><span class="hs-identifier">will</span><span>
</span><span id="line-715"></span><span>    </span><span class="hs-identifier">still</span><span> </span><span class="hs-identifier">be</span><span> </span><span class="hs-identifier">manual</span><span class="hs-special">)</span><span>
</span><span id="line-716"></span><span>
</span><span id="line-717"></span><span class="hs-identifier">try</span><span> </span><span class="hs-identifier">again</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">add</span><span> </span><span class="hs-identifier">annotation</span><span> </span><span class="hs-identifier">to</span><span> </span><span class="hs-identifier">the</span><span> </span><span class="hs-identifier">ast</span><span>
</span><span id="line-718"></span></pre></body></html>