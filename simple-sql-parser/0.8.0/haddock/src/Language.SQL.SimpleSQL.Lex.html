<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-comment">{-
The parser uses a separate lexer for two reasons:

1. sql syntax is very awkward to parse, the separate lexer makes it
easier to handle this in most places (in some places it makes it
harder or impossible, the fix is to switch to something better than
parsec)

2. using a separate lexer gives a huge speed boost because it reduces
backtracking. (We could get this by making the parsing code a lot more
complex also.)

3. we can test the lexer relatively exhaustively, then even when we
don't do nearly as comprehensive testing on the syntax level, we still
have a relatively high assurance of the low level of bugs. This is
much more difficult to get parity with when testing the syntax parser
directly without the separately testing lexing stage.

TODO:

optimisations:

check for left factor opportunities
check for places where it parses a few substrings from the source,
  then puts them back together with a concatenate of some flavour
  -&gt; this is better if can find a way to parse the entire string
  from the source and lift it in one go into the lexical token
before this is done, a smaller optimisation is when any code matches
  a constant string in the lexer, use that constant string instead
  of the string from the parser, it might make a small difference in
  a few places
maybe every token should carry the exact source as well as any fields
  it's been broken into - so pretty printing is trivial


make the tokenswill print more dialect accurate. Maybe add symbol
  chars and identifier chars to the dialect definition and use them from
  here

start adding negative / different parse dialect tests

add token tables and tests for oracle, sql server
review existing tables

look for refactoring opportunities, especially the token
generation tables in the tests

do some user documentation on lexing, and lexing/dialects

start thinking about a more separated design for the dialect handling

lexing tests are starting to take a really long time, so split the
tests so it is much easier to run all the tests except the lexing
tests which only need to be run when working on the lexer (which
should be relatively uncommon), or doing a commit or finishing off a
series of commits,

start writing the error message tests:
  generate/write a large number of syntax errors
  create a table with the source and the error message
  try to compare some different versions of code to compare the
    quality of the error messages by hand

  get this checked in so improvements and regressions in the error
    message quality can be tracked a little more easily (although it will
    still be manual)

try again to add annotation to the ast

-}</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="annot"><span class="hs-comment">-- | Lexer for SQL.</span></span><span>
</span><span id="line-74"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-75"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards   #-}</span><span>
</span><span id="line-76"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies      #-}</span><span>
</span><span id="line-77"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html"><span class="hs-identifier">Language.SQL.SimpleSQL.Lex</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier">Token</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier">WithPos</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#lexSQL"><span class="hs-identifier">lexSQL</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#lexSQLWithPositions"><span class="hs-identifier">lexSQLWithPositions</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier">prettyToken</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyTokens"><span class="hs-identifier">prettyTokens</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#ParseError"><span class="hs-identifier">ParseError</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyError"><span class="hs-identifier">prettyError</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier">tokenListWillPrintAndLex</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#ansi2011"><span class="hs-identifier">ansi2011</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier">SQLStream</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html"><span class="hs-identifier">Language.SQL.SimpleSQL.Dialect</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier">Dialect</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#ansi2011"><span class="hs-identifier">ansi2011</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Megaparsec</span></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Parsec</span></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">runParser'</span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">PosState</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">TraversableStream</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">VisualStream</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>    </span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">ParseErrorBundle</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">errorBundlePretty</span></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">SourcePos</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">getSourcePos</span></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">getOffset</span></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">pstateSourcePos</span></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">statePosState</span></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">mkPos</span></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">hidden</span></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">setErrorOffset</span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">choice</span></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">satisfy</span></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">takeWhileP</span></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">takeWhile1P</span></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">eof</span></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">many</span></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">try</span></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">option</span></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">notFollowedBy</span></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">lookAhead</span></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">match</span></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">optional</span></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-keyword">label</span></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">chunk</span></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">region</span></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">anySingle</span></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Text.Megaparsec</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Megaparsec.Char</span></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">string</span></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">char</span></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Megaparsec.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">initialState</span></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DL</span></span><span>
</span><span id="line-142"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-143"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Void</span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isAlphaNum</span></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">isAlpha</span></span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">isSpace</span></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">isDigit</span></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">void</span></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-155"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span class="hs-comment">--import Text.Megaparsec.Debug (dbg)</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- syntax</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="annot"><span class="hs-comment">-- | Represents a lexed token</span></span><span>
</span><span id="line-163"></span><span class="hs-keyword">data</span><span> </span><span id="Token"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-var">Token</span></a></span></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-comment">-- | A symbol (in ansi dialect) is one of the following</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-comment">-- * multi char symbols &lt;&gt; \&lt;= \&gt;= != ||</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-comment">-- * single char symbols: * + -  &lt; &gt;  ^ / %  ~ &amp; | ? ( ) [ ] , ; ( )</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="Symbol"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-var">Symbol</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-comment">-- | This is an identifier or keyword. The first field is</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-comment">-- the quotes used, or nothing if no quotes were used. The quotes</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-comment">-- can be &quot; or u&amp; or something dialect specific like []</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Identifier"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-comment">-- | This is a prefixed variable symbol, such as :var, @var or #var</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-comment">-- (only :var is used in ansi dialect)</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PrefixedVariable"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-var">PrefixedVariable</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="hs-comment">-- | This is a positional arg identifier e.g. $1</span></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PositionalArg"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PositionalArg"><span class="hs-identifier hs-var">PositionalArg</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-comment">-- | This is a string literal. The first two fields are the --</span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-comment">-- start and end quotes, which are usually both ', but can be</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-comment">-- the character set (one of nNbBxX, or u&amp;, U&amp;), or a dialect</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-comment">-- specific string quoting (such as $$ in postgres)</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SqlString"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-var">SqlString</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-comment">-- | A number literal (integral or otherwise), stored in original format</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-comment">-- unchanged</span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SqlNumber"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-var">SqlNumber</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Whitespace, one or more of space, tab or newline.</span></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Whitespace"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Whitespace"><span class="hs-identifier hs-var">Whitespace</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-comment">-- | A commented line using --, contains every character starting with the</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-comment">-- \'--\' and including the terminating newline character if there is one</span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-comment">-- - this will be missing if the last line in the source is a line comment</span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-comment">-- with no trailing newline</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LineComment"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#LineComment"><span class="hs-identifier hs-var">LineComment</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="hs-comment">-- | A block comment, \/* stuff *\/, includes the comment delimiters</span></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="BlockComment"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#BlockComment"><span class="hs-identifier hs-var">BlockComment</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-comment">-- | Used for generating better error messages when using the</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-comment">--     output of the lexer in a parser</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="InvalidToken"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#InvalidToken"><span class="hs-identifier hs-var">InvalidToken</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-199"></span><span>      </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160235"><span id="local-6989586621679160256"><span class="annot"><span class="annottext">Token -&gt; Token -&gt; Bool
(Token -&gt; Token -&gt; Bool) -&gt; (Token -&gt; Token -&gt; Bool) -&gt; Eq Token
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Token -&gt; Token -&gt; Bool
== :: Token -&gt; Token -&gt; Bool
$c/= :: Token -&gt; Token -&gt; Bool
/= :: Token -&gt; Token -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679160261"><span id="local-6989586621679160292"><span id="local-6989586621679160296"><span class="annot"><span class="annottext">Int -&gt; Token -&gt; ShowS
[Token] -&gt; ShowS
Token -&gt; [Char]
(Int -&gt; Token -&gt; ShowS)
-&gt; (Token -&gt; [Char]) -&gt; ([Token] -&gt; ShowS) -&gt; Show Token
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Token -&gt; ShowS
showsPrec :: Int -&gt; Token -&gt; ShowS
$cshow :: Token -&gt; [Char]
show :: Token -&gt; [Char]
$cshowList :: [Token] -&gt; ShowS
showList :: [Token] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679160304"><span id="local-6989586621679160330"><span id="local-6989586621679160334"><span id="local-6989586621679160337"><span id="local-6989586621679160340"><span id="local-6989586621679160343"><span id="local-6989586621679160346"><span class="annot"><span class="annottext">Eq Token
Eq Token =&gt;
(Token -&gt; Token -&gt; Ordering)
-&gt; (Token -&gt; Token -&gt; Bool)
-&gt; (Token -&gt; Token -&gt; Bool)
-&gt; (Token -&gt; Token -&gt; Bool)
-&gt; (Token -&gt; Token -&gt; Bool)
-&gt; (Token -&gt; Token -&gt; Token)
-&gt; (Token -&gt; Token -&gt; Token)
-&gt; Ord Token
Token -&gt; Token -&gt; Bool
Token -&gt; Token -&gt; Ordering
Token -&gt; Token -&gt; Token
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Token -&gt; Token -&gt; Ordering
compare :: Token -&gt; Token -&gt; Ordering
$c&lt; :: Token -&gt; Token -&gt; Bool
&lt; :: Token -&gt; Token -&gt; Bool
$c&lt;= :: Token -&gt; Token -&gt; Bool
&lt;= :: Token -&gt; Token -&gt; Bool
$c&gt; :: Token -&gt; Token -&gt; Bool
&gt; :: Token -&gt; Token -&gt; Bool
$c&gt;= :: Token -&gt; Token -&gt; Bool
&gt;= :: Token -&gt; Token -&gt; Bool
$cmax :: Token -&gt; Token -&gt; Token
max :: Token -&gt; Token -&gt; Token
$cmin :: Token -&gt; Token -&gt; Token
min :: Token -&gt; Token -&gt; Token
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-comment">-- main api functions</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- | Lex some SQL to a list of tokens. The invalid token setting</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- changes the behaviour so that if there's a parse error at the start</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- of parsing an invalid token, it adds a final InvalidToken with the</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- character to the result then stop parsing. This can then be used to</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- produce a parse error with more context in the parser. Parse errors</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- within tokens still produce Left errors.</span><span>
</span><span id="line-211"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#lexSQLWithPositions"><span class="hs-identifier hs-type">lexSQLWithPositions</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ dialect of SQL to use</span></span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ produce InvalidToken</span></span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ filename to use in error messages</span></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-comment">-- ^ line number and column number of the first character</span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-comment">-- in the source to use in error messages</span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ the SQL source to lex</span></span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-type">WithPos</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-224"></span><span id="lexSQLWithPositions"><span class="annot"><span class="annottext">lexSQLWithPositions :: Dialect
-&gt; Bool
-&gt; Text
-&gt; Maybe (Int, Int)
-&gt; Text
-&gt; Either ParseError [WithPos Token]
</span><a href="Language.SQL.SimpleSQL.Lex.html#lexSQLWithPositions"><span class="hs-identifier hs-var hs-var">lexSQLWithPositions</span></a></span></span><span> </span><span id="local-6989586621679160351"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160351"><span class="hs-identifier hs-var">dialect</span></a></span></span><span> </span><span id="local-6989586621679160352"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679160352"><span class="hs-identifier hs-var">pit</span></a></span></span><span> </span><span id="local-6989586621679160353"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160353"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679160354"><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679160354"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679160355"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160355"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; Maybe (Int, Int)
-&gt; Parser [WithPos Token]
-&gt; Text
-&gt; Either ParseError [WithPos Token]
forall a.
Text -&gt; Maybe (Int, Int) -&gt; Parser a -&gt; Text -&gt; Either ParseError a
</span><a href="Language.SQL.SimpleSQL.Lex.html#myParse"><span class="hs-identifier hs-var">myParse</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160353"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679160354"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Bool -&gt; Parser [WithPos Token]
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokens"><span class="hs-identifier hs-var">tokens</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160351"><span class="hs-identifier hs-var">dialect</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679160352"><span class="hs-identifier hs-var">pit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160355"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="annot"><span class="hs-comment">-- | Lex some SQL to a list of tokens.</span></span><span>
</span><span id="line-227"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#lexSQL"><span class="hs-identifier hs-type">lexSQL</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ dialect of SQL to use</span></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ produce InvalidToken, see lexSQLWithPositions</span></span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ filename to use in error messages</span></span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-comment">-- ^ line number and column number of the first character</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-comment">-- in the source to use in error messages</span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-238"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ the SQL source to lex</span></span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-240"></span><span id="lexSQL"><span class="annot"><span class="annottext">lexSQL :: Dialect
-&gt; Bool
-&gt; Text
-&gt; Maybe (Int, Int)
-&gt; Text
-&gt; Either ParseError [Token]
</span><a href="Language.SQL.SimpleSQL.Lex.html#lexSQL"><span class="hs-identifier hs-var hs-var">lexSQL</span></a></span></span><span> </span><span id="local-6989586621679160358"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160358"><span class="hs-identifier hs-var">dialect</span></a></span></span><span> </span><span id="local-6989586621679160359"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679160359"><span class="hs-identifier hs-var">pit</span></a></span></span><span> </span><span id="local-6989586621679160360"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160360"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679160361"><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679160361"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679160362"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160362"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-241"></span><span>    </span><span class="annot"><span class="annottext">(WithPos Token -&gt; Token) -&gt; [WithPos Token] -&gt; [Token]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">WithPos Token -&gt; Token
forall a. WithPos a -&gt; a
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokenVal"><span class="hs-identifier hs-var">tokenVal</span></a></span><span> </span><span class="annot"><span class="annottext">([WithPos Token] -&gt; [Token])
-&gt; Either ParseError [WithPos Token] -&gt; Either ParseError [Token]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Dialect
-&gt; Bool
-&gt; Text
-&gt; Maybe (Int, Int)
-&gt; Text
-&gt; Either ParseError [WithPos Token]
</span><a href="Language.SQL.SimpleSQL.Lex.html#lexSQLWithPositions"><span class="hs-identifier hs-var">lexSQLWithPositions</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160358"><span class="hs-identifier hs-var">dialect</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679160359"><span class="hs-identifier hs-var">pit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160360"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679160361"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160362"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span id="local-6989586621679159725"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#myParse"><span class="hs-identifier hs-type">myParse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159725"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-244"></span><span id="myParse"><span class="annot"><span class="annottext">myParse :: forall a.
Text -&gt; Maybe (Int, Int) -&gt; Parser a -&gt; Text -&gt; Either ParseError a
</span><a href="Language.SQL.SimpleSQL.Lex.html#myParse"><span class="hs-identifier hs-var hs-var">myParse</span></a></span></span><span> </span><span id="local-6989586621679160368"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160368"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679160369"><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679160369"><span class="hs-identifier hs-var">sp'</span></a></span></span><span> </span><span id="local-6989586621679160370"><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621679160370"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679160371"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160371"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-245"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679160372"><span class="annot"><span class="annottext">sp :: (Int, Int)
</span><a href="#local-6989586621679160372"><span class="hs-identifier hs-var hs-var">sp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Maybe (Int, Int) -&gt; (Int, Int)
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679160369"><span class="hs-identifier hs-var">sp'</span></a></span><span>
</span><span id="line-246"></span><span>            </span><span id="local-6989586621679160373"><span class="annot"><span class="annottext">ps :: SourcePos
</span><a href="#local-6989586621679160373"><span class="hs-identifier hs-var hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Pos -&gt; Pos -&gt; SourcePos
</span><span class="hs-identifier hs-var">SourcePos</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160368"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Pos
</span><span class="hs-identifier hs-var">mkPos</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Pos) -&gt; Int -&gt; Pos
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679160372"><span class="hs-identifier hs-var">sp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Pos
</span><span class="hs-identifier hs-var">mkPos</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Pos) -&gt; Int -&gt; Pos
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679160372"><span class="hs-identifier hs-var">sp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>            </span><span id="local-6989586621679160378"><span class="annot"><span class="annottext">is :: State Text Void
</span><a href="#local-6989586621679160378"><span class="hs-identifier hs-var hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text -&gt; State Text Void
forall s e. [Char] -&gt; s -&gt; State s e
</span><span class="hs-identifier hs-var">initialState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160368"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160371"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-248"></span><span>            </span><span id="local-6989586621679160379"><span class="annot"><span class="annottext">sps :: PosState Text
</span><a href="#local-6989586621679160379"><span class="hs-identifier hs-var hs-var">sps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State Text Void -&gt; PosState Text
forall s e. State s e -&gt; PosState s
</span><span class="hs-identifier hs-var">statePosState</span></span><span> </span><span class="annot"><span class="annottext">State Text Void
</span><a href="#local-6989586621679160378"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span class="annot"><span class="hs-identifier hs-var">pstateSourcePos</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679160373"><span class="hs-identifier hs-type">ps</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-249"></span><span>            </span><span id="local-6989586621679160380"><span class="annot"><span class="annottext">is' :: State Text Void
</span><a href="#local-6989586621679160380"><span class="hs-identifier hs-var hs-var">is'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State Text Void
</span><a href="#local-6989586621679160378"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="hs-identifier hs-var">statePosState</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679160379"><span class="hs-identifier hs-type">sps</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-250"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(State Text Void, Either ParseError a) -&gt; Either ParseError a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((State Text Void, Either ParseError a) -&gt; Either ParseError a)
-&gt; (State Text Void, Either ParseError a) -&gt; Either ParseError a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parser a
-&gt; State Text Void -&gt; (State Text Void, Either ParseError a)
forall e s a.
Parsec e s a
-&gt; State s e -&gt; (State s e, Either (ParseErrorBundle s e) a)
</span><span class="hs-identifier hs-var">runParser'</span></span><span> </span><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621679160370"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">State Text Void
</span><a href="#local-6989586621679160380"><span class="hs-identifier hs-var">is'</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyError"><span class="hs-identifier hs-type">prettyError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-253"></span><span id="prettyError"><span class="annot"><span class="annottext">prettyError :: ParseError -&gt; Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyError"><span class="hs-identifier hs-var hs-var">prettyError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Text) -&gt; (ParseError -&gt; [Char]) -&gt; ParseError -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParseError -&gt; [Char]
forall s e.
(VisualStream s, TraversableStream s, ShowErrorComponent e) =&gt;
ParseErrorBundle s e -&gt; [Char]
</span><span class="hs-identifier hs-var">errorBundlePretty</span></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">-- parsing boilerplate</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-keyword">type</span><span> </span><span id="ParseError"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#ParseError"><span class="hs-identifier hs-var">ParseError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ParseErrorBundle</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-keyword">type</span><span> </span><span id="Parser"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-var">Parser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parsec</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-comment">-- | Positional information added to tokens to preserve source positions</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- for the parser</span><span>
</span><span id="line-265"></span><span class="hs-keyword">data</span><span> </span><span id="WithPos"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-var">WithPos</span></a></span></span><span> </span><span id="local-6989586621679159728"><span class="annot"><a href="#local-6989586621679159728"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="WithPos"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-var">WithPos</span></a></span></span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="startPos"><span class="annot"><span class="annottext">forall a. WithPos a -&gt; SourcePos
</span><a href="Language.SQL.SimpleSQL.Lex.html#startPos"><span class="hs-identifier hs-var hs-var">startPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SourcePos</span></span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="endPos"><span class="annot"><span class="annottext">forall a. WithPos a -&gt; SourcePos
</span><a href="Language.SQL.SimpleSQL.Lex.html#endPos"><span class="hs-identifier hs-var hs-var">endPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SourcePos</span></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tokenLength"><span class="annot"><span class="annottext">forall a. WithPos a -&gt; Int
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokenLength"><span class="hs-identifier hs-var hs-var">tokenLength</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tokenVal"><span class="annot"><span class="annottext">forall a. WithPos a -&gt; a
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokenVal"><span class="hs-identifier hs-var hs-var">tokenVal</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679159728"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160389"><span id="local-6989586621679160396"><span class="annot"><span class="annottext">WithPos a -&gt; WithPos a -&gt; Bool
(WithPos a -&gt; WithPos a -&gt; Bool)
-&gt; (WithPos a -&gt; WithPos a -&gt; Bool) -&gt; Eq (WithPos a)
forall a. Eq a =&gt; WithPos a -&gt; WithPos a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a. Eq a =&gt; WithPos a -&gt; WithPos a -&gt; Bool
== :: WithPos a -&gt; WithPos a -&gt; Bool
$c/= :: forall a. Eq a =&gt; WithPos a -&gt; WithPos a -&gt; Bool
/= :: WithPos a -&gt; WithPos a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160404"><span id="local-6989586621679160411"><span id="local-6989586621679160417"><span id="local-6989586621679160421"><span id="local-6989586621679160424"><span id="local-6989586621679160427"><span id="local-6989586621679160430"><span class="annot"><span class="annottext">Eq (WithPos a)
Eq (WithPos a) =&gt;
(WithPos a -&gt; WithPos a -&gt; Ordering)
-&gt; (WithPos a -&gt; WithPos a -&gt; Bool)
-&gt; (WithPos a -&gt; WithPos a -&gt; Bool)
-&gt; (WithPos a -&gt; WithPos a -&gt; Bool)
-&gt; (WithPos a -&gt; WithPos a -&gt; Bool)
-&gt; (WithPos a -&gt; WithPos a -&gt; WithPos a)
-&gt; (WithPos a -&gt; WithPos a -&gt; WithPos a)
-&gt; Ord (WithPos a)
WithPos a -&gt; WithPos a -&gt; Bool
WithPos a -&gt; WithPos a -&gt; Ordering
WithPos a -&gt; WithPos a -&gt; WithPos a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. Ord a =&gt; Eq (WithPos a)
forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; Bool
forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; Ordering
forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; WithPos a
$ccompare :: forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; Ordering
compare :: WithPos a -&gt; WithPos a -&gt; Ordering
$c&lt; :: forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; Bool
&lt; :: WithPos a -&gt; WithPos a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; Bool
&lt;= :: WithPos a -&gt; WithPos a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; Bool
&gt; :: WithPos a -&gt; WithPos a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; Bool
&gt;= :: WithPos a -&gt; WithPos a -&gt; Bool
$cmax :: forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; WithPos a
max :: WithPos a -&gt; WithPos a -&gt; WithPos a
$cmin :: forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; WithPos a
min :: WithPos a -&gt; WithPos a -&gt; WithPos a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160438"><span id="local-6989586621679160446"><span id="local-6989586621679160450"><span class="annot"><span class="annottext">Int -&gt; WithPos a -&gt; ShowS
[WithPos a] -&gt; ShowS
WithPos a -&gt; [Char]
(Int -&gt; WithPos a -&gt; ShowS)
-&gt; (WithPos a -&gt; [Char])
-&gt; ([WithPos a] -&gt; ShowS)
-&gt; Show (WithPos a)
forall a. Show a =&gt; Int -&gt; WithPos a -&gt; ShowS
forall a. Show a =&gt; [WithPos a] -&gt; ShowS
forall a. Show a =&gt; WithPos a -&gt; [Char]
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; WithPos a -&gt; ShowS
showsPrec :: Int -&gt; WithPos a -&gt; ShowS
$cshow :: forall a. Show a =&gt; WithPos a -&gt; [Char]
show :: WithPos a -&gt; [Char]
$cshowList :: forall a. Show a =&gt; [WithPos a] -&gt; ShowS
showList :: [WithPos a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-comment">-- pretty print</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">-- | Pretty printing, if you lex a bunch of tokens, then pretty</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- print them, should should get back exactly the same string</span><span>
</span><span id="line-278"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-type">prettyToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-279"></span><span id="prettyToken"><span class="annot"><span class="annottext">prettyToken :: Dialect -&gt; Token -&gt; Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var hs-var">prettyToken</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span id="local-6989586621679160452"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160452"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160452"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-280"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-type">Identifier</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Text, Text)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679160453"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160453"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160453"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-281"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-type">Identifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160454"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160454"><span class="hs-identifier hs-var">q1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679160455"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160455"><span class="hs-identifier hs-var">q2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679160456"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160456"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160454"><span class="hs-identifier hs-var">q1</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160456"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160455"><span class="hs-identifier hs-var">q2</span></a></span><span>
</span><span id="line-282"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-type">PrefixedVariable</span></a></span><span> </span><span id="local-6989586621679160457"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160457"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679160458"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160458"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.cons</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160457"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160458"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-283"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PositionalArg"><span class="hs-identifier hs-type">PositionalArg</span></a></span><span> </span><span id="local-6989586621679160460"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160460"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.cons</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'$'</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Text) -&gt; [Char] -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160460"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-284"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-type">SqlString</span></a></span><span> </span><span id="local-6989586621679160462"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160462"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679160463"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160463"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679160464"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160464"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160462"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160464"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160463"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-285"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-type">SqlNumber</span></a></span><span> </span><span id="local-6989586621679160465"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160465"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160465"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-286"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Whitespace"><span class="hs-identifier hs-type">Whitespace</span></a></span><span> </span><span id="local-6989586621679160466"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160466"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160466"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-287"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#LineComment"><span class="hs-identifier hs-type">LineComment</span></a></span><span> </span><span id="local-6989586621679160467"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160467"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160467"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-288"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#BlockComment"><span class="hs-identifier hs-type">BlockComment</span></a></span><span> </span><span id="local-6989586621679160468"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160468"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160468"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-289"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#InvalidToken"><span class="hs-identifier hs-type">InvalidToken</span></a></span><span> </span><span id="local-6989586621679160469"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160469"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160469"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyTokens"><span class="hs-identifier hs-type">prettyTokens</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-292"></span><span id="prettyTokens"><span class="annot"><span class="annottext">prettyTokens :: Dialect -&gt; [Token] -&gt; Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyTokens"><span class="hs-identifier hs-var hs-var">prettyTokens</span></a></span></span><span> </span><span id="local-6989586621679160470"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160470"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679160471"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679160471"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.concat</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Text) -&gt; [Text] -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Token -&gt; Text) -&gt; [Token] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Token -&gt; Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160470"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679160471"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-comment">-- token parsers</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="annot"><span class="hs-comment">-- | parser for a sql token</span></span><span>
</span><span id="line-299"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#sqlToken"><span class="hs-identifier hs-type">sqlToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-type">WithPos</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span id="sqlToken"><span class="annot"><span class="annottext">sqlToken :: Dialect -&gt; Parser (WithPos Token)
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlToken"><span class="hs-identifier hs-var hs-var">sqlToken</span></a></span></span><span> </span><span id="local-6989586621679160474"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160474"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser (WithPos Token)
forall a. Parser a -&gt; Parser (WithPos a)
</span><a href="Language.SQL.SimpleSQL.Lex.html#withPos"><span class="hs-identifier hs-var">withPos</span></a></span><span> </span><span class="annot"><span class="annottext">(Parser Token -&gt; Parser (WithPos Token))
-&gt; Parser Token -&gt; Parser (WithPos Token)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Token
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">hidden</span></span><span> </span><span class="annot"><span class="annottext">(Parser Token -&gt; Parser Token) -&gt; Parser Token -&gt; Parser Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Parser Token] -&gt; Parser Token
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="annot"><span class="annottext">([Parser Token] -&gt; Parser Token) -&gt; [Parser Token] -&gt; Parser Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlString"><span class="hs-identifier hs-var">sqlString</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160474"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifier"><span class="hs-identifier hs-var">identifier</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160474"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#lineComment"><span class="hs-identifier hs-var">lineComment</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160474"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#blockComment"><span class="hs-identifier hs-var">blockComment</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160474"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlNumber"><span class="hs-identifier hs-var">sqlNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160474"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#positionalArg"><span class="hs-identifier hs-var">positionalArg</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160474"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#dontParseEndBlockComment"><span class="hs-identifier hs-var">dontParseEndBlockComment</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160474"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#prefixedVariable"><span class="hs-identifier hs-var">prefixedVariable</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160474"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160474"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlWhitespace"><span class="hs-identifier hs-var">sqlWhitespace</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160474"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-comment">--fakeSourcePos :: SourcePos</span><span>
</span><span id="line-314"></span><span class="hs-comment">--fakeSourcePos = SourcePos &quot;&quot; (mkPos 1) (mkPos 1)</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="hs-comment">-- position and error helpers</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span id="local-6989586621679159772"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#withPos"><span class="hs-identifier hs-type">withPos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159772"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-type">WithPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159772"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-321"></span><span id="withPos"><span class="annot"><span class="annottext">withPos :: forall a. Parser a -&gt; Parser (WithPos a)
</span><a href="Language.SQL.SimpleSQL.Lex.html#withPos"><span class="hs-identifier hs-var hs-var">withPos</span></a></span></span><span> </span><span id="local-6989586621679160499"><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621679160499"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621679160500"><span class="annot"><a href="#local-6989586621679160500"><span class="hs-identifier hs-var">sp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity SourcePos
forall s e (m :: * -&gt; *).
(TraversableStream s, MonadParsec e s m) =&gt;
m SourcePos
</span><span class="hs-identifier hs-var">getSourcePos</span></span><span>
</span><span id="line-323"></span><span>    </span><span id="local-6989586621679160501"><span class="annot"><a href="#local-6989586621679160501"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">getOffset</span></span><span>
</span><span id="line-324"></span><span>    </span><span id="local-6989586621679160502"><span class="annot"><a href="#local-6989586621679160502"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679160499"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-325"></span><span>    </span><span id="local-6989586621679160503"><span class="annot"><a href="#local-6989586621679160503"><span class="hs-identifier hs-var">off1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">getOffset</span></span><span>
</span><span id="line-326"></span><span>    </span><span id="local-6989586621679160504"><span class="annot"><a href="#local-6989586621679160504"><span class="hs-identifier hs-var">ep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">getSourcePos</span></span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-type">WithPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160500"><span class="hs-identifier hs-type">sp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160504"><span class="hs-identifier hs-type">ep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679160503"><span class="hs-identifier hs-type">off1</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621679160501"><span class="hs-identifier hs-type">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679160502"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">{-

TODO: extend this idea, to recover to parsing regular tokens after an
invalid one. This can then support resumption after error in the parser.
This would also need something similar being done for parse errors
within lexical tokens.

-}</span><span>
</span><span id="line-337"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#invalidToken"><span class="hs-identifier hs-type">invalidToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-type">WithPos</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span id="invalidToken"><span class="annot"><span class="annottext">invalidToken :: Dialect -&gt; Parser (WithPos Token)
</span><a href="Language.SQL.SimpleSQL.Lex.html#invalidToken"><span class="hs-identifier hs-var hs-var">invalidToken</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser (WithPos Token)
forall a. Parser a -&gt; Parser (WithPos a)
</span><a href="Language.SQL.SimpleSQL.Lex.html#withPos"><span class="hs-identifier hs-var">withPos</span></a></span><span> </span><span class="annot"><span class="annottext">(Parser Token -&gt; Parser (WithPos Token))
-&gt; Parser Token -&gt; Parser (WithPos Token)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">hidden</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *). MonadParsec e s m =&gt; m ()
</span><span class="hs-identifier hs-var">eof</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; Parser Token -&gt; Parser Token
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser Token
forall a. [Char] -&gt; ParsecT Void Text Identity a
forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Token -&gt; Parser Token
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#InvalidToken"><span class="hs-identifier hs-var">InvalidToken</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token) -&gt; (Char -&gt; Text) -&gt; Char -&gt; Token
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Token) -&gt; ParsecT Void Text Identity Char -&gt; Parser Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *). MonadParsec e s m =&gt; m (Token s)
</span><span class="hs-identifier hs-var">anySingle</span></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#tokens"><span class="hs-identifier hs-type">tokens</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-type">WithPos</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-342"></span><span id="tokens"><span class="annot"><span class="annottext">tokens :: Dialect -&gt; Bool -&gt; Parser [WithPos Token]
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokens"><span class="hs-identifier hs-var hs-var">tokens</span></a></span></span><span> </span><span id="local-6989586621679160507"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160507"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679160508"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679160508"><span class="hs-identifier hs-var">pit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-343"></span><span>    </span><span id="local-6989586621679160509"><span class="annot"><a href="#local-6989586621679160509"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser (WithPos Token) -&gt; Parser [WithPos Token]
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Parser (WithPos Token)
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlToken"><span class="hs-identifier hs-var">sqlToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160507"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679160508"><span class="hs-identifier hs-type">pit</span></a></span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">choice</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679160509"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">hidden</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">eof</span></span><span>
</span><span id="line-346"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679160511"><span class="annot"><span class="annottext">WithPos Token
</span><a href="#local-6989586621679160511"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160509"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[WithPos Token] -&gt; [WithPos Token] -&gt; [WithPos Token]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">WithPos Token
</span><a href="#local-6989586621679160511"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">hidden</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#invalidToken"><span class="hs-identifier hs-type">invalidToken</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160507"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-347"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621679160509"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">hidden</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">eof</span></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-comment">{-
Parse a SQL string. Examples:

'basic string'
'string with '' a quote'
n'international text'
b'binary string'
x'hexidecimal string'
-}</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#sqlString"><span class="hs-identifier hs-type">sqlString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-362"></span><span id="sqlString"><span class="annot"><span class="annottext">sqlString :: Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlString"><span class="hs-identifier hs-var hs-var">sqlString</span></a></span></span><span> </span><span id="local-6989586621679160512"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160512"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diDollarString"><span class="hs-identifier hs-var">diDollarString</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160512"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Token
</span><a href="#local-6989586621679160514"><span class="hs-identifier hs-var">dollarString</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Token -&gt; Parser Token
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Token
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Token
</span><a href="#local-6989586621679160516"><span class="hs-identifier hs-var">csString</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Token -&gt; Parser Token
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Token
</span><a href="#local-6989586621679160517"><span class="hs-identifier hs-var">normalString</span></a></span><span>
</span><span id="line-366"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-367"></span><span>    </span><span id="local-6989586621679160514"><span class="annot"><span class="annottext">dollarString :: Parser Token
</span><a href="#local-6989586621679160514"><span class="hs-identifier hs-var hs-var">dollarString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-368"></span><span>        </span><span class="hs-comment">-- use try because of ambiguity with symbols and with</span><span>
</span><span id="line-369"></span><span>        </span><span class="hs-comment">-- positional arg</span><span>
</span><span id="line-370"></span><span>        </span><span id="local-6989586621679160541"><span class="annot"><a href="#local-6989586621679160541"><span class="hs-identifier hs-var">delim</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; Parser Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#fstMatch"><span class="hs-identifier hs-var">fstMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'$'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#hoptional_"><span class="hs-identifier hs-var">hoptional_</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var">identifierString</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'$'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679160546"><span class="annot"><a href="#local-6989586621679160546"><span class="hs-identifier hs-var hs-var">moreDollarString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-372"></span><span>                </span><span class="annot"><span class="annottext">[Char]
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
[Char]
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
[Char] -&gt; m a -&gt; m a
</span><span class="hs-keyword hs-var">label</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160541"><span class="hs-identifier hs-var">delim</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ())
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char] -&gt; (Char -&gt; Bool) -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#takeWhileP_"><span class="hs-identifier hs-var">takeWhileP_</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'$'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160549"><span class="hs-identifier hs-var">checkDollar</span></a></span><span>
</span><span id="line-373"></span><span>            </span><span id="local-6989586621679160549"><span class="annot"><a href="#local-6989586621679160549"><span class="hs-identifier hs-var hs-var">checkDollar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
[Char]
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
[Char] -&gt; m a -&gt; m a
</span><span class="hs-keyword hs-var">label</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160541"><span class="hs-identifier hs-var">delim</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ())
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span>
</span><span id="line-374"></span><span>                </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity ()] -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-375"></span><span>                </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">lookAhead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#chunk_"><span class="hs-identifier hs-var">chunk_</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160541"><span class="hs-identifier hs-var">delim</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; ParsecT Void Text Identity ()
forall a. a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- would be nice not to parse it twice?</span><span>
</span><span id="line-376"></span><span>                                                     </span><span class="hs-comment">-- but makes the whole match trick much less neat</span><span>
</span><span id="line-377"></span><span>                </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'$'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160546"><span class="hs-identifier hs-var">moreDollarString</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-378"></span><span>        </span><span id="local-6989586621679160552"><span class="annot"><a href="#local-6989586621679160552"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#fstMatch"><span class="hs-identifier hs-type">fstMatch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160546"><span class="hs-identifier hs-type">moreDollarString</span></a></span><span>
</span><span id="line-379"></span><span>        </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#chunk_"><span class="hs-identifier hs-type">chunk_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160541"><span class="hs-identifier hs-type">delim</span></a></span><span>
</span><span id="line-380"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-type">SqlString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160541"><span class="hs-identifier hs-type">delim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160541"><span class="hs-identifier hs-type">delim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160552"><span class="hs-identifier hs-type">str</span></a></span><span>
</span><span id="line-381"></span><span>    </span><span id="local-6989586621679160556"><span class="annot"><span class="annottext">lq :: ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160556"><span class="hs-identifier hs-var hs-var">lq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
[Char]
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
[Char] -&gt; m a -&gt; m a
</span><span class="hs-keyword hs-var">label</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ())
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span>
</span><span id="line-382"></span><span>    </span><span id="local-6989586621679160517"><span class="annot"><span class="annottext">normalString :: Parser Token
</span><a href="#local-6989586621679160517"><span class="hs-identifier hs-var hs-var">normalString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-var">SqlString</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token) -&gt; Parser Text -&gt; Parser Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160556"><span class="hs-identifier hs-var">lq</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; Parser Text -&gt; Parser Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Parser Text
</span><a href="#local-6989586621679160562"><span class="hs-identifier hs-var">normalStringSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>    </span><span id="local-6989586621679160562"><span class="annot"><span class="annottext">normalStringSuffix :: Bool -&gt; Parser Text
</span><a href="#local-6989586621679160562"><span class="hs-identifier hs-var hs-var">normalStringSuffix</span></a></span></span><span> </span><span id="local-6989586621679160573"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679160573"><span class="hs-identifier hs-var">allowBackslash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser Text -&gt; Parser Text
forall a.
[Char]
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
[Char] -&gt; m a -&gt; m a
</span><span class="hs-keyword hs-var">label</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Parser Text -&gt; Parser Text) -&gt; Parser Text -&gt; Parser Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-384"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679160574"><span class="annot"><span class="annottext">regularChar :: Char -&gt; Bool
</span><a href="#local-6989586621679160574"><span class="hs-identifier hs-var hs-var">regularChar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679160573"><span class="hs-identifier hs-var">allowBackslash</span></a></span><span>
</span><span id="line-385"></span><span>                          </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679160575"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160575"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160575"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160575"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\\'</span></span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679160577"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160577"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160577"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>            </span><span id="local-6989586621679160578"><span class="annot"><span class="annottext">nonQuoteStringChar :: ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160578"><span class="hs-identifier hs-var hs-var">nonQuoteStringChar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [Char] -&gt; (Char -&gt; Bool) -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#takeWhileP_"><span class="hs-identifier hs-var">takeWhileP_</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679160574"><span class="hs-identifier hs-var">regularChar</span></a></span><span>
</span><span id="line-388"></span><span>            </span><span id="local-6989586621679160585"><span class="annot"><span class="annottext">nonRegularContinue :: ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160585"><span class="hs-identifier hs-var hs-var">nonRegularContinue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-389"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#hchunk_"><span class="hs-identifier hs-var">hchunk_</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;''&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#hchunk_"><span class="hs-identifier hs-var">hchunk_</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\\'&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#hchar_"><span class="hs-identifier hs-var">hchar_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\\'</span></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>            </span><span id="local-6989586621679160588"><span class="annot"><span class="annottext">moreChars :: ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160588"><span class="hs-identifier hs-var hs-var">moreChars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160578"><span class="hs-identifier hs-var">nonQuoteStringChar</span></a></span><span>
</span><span id="line-391"></span><span>                </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall (m :: * -&gt; *) a. Alternative m =&gt; a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160585"><span class="hs-identifier hs-var">nonRegularContinue</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160588"><span class="hs-identifier hs-var">moreChars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>        </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; Parser Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#fstMatch"><span class="hs-identifier hs-var">fstMatch</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160588"><span class="hs-identifier hs-var">moreChars</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; ParsecT Void Text Identity () -&gt; Parser Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160556"><span class="hs-identifier hs-var">lq</span></a></span><span>
</span><span id="line-393"></span><span>            </span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-comment">-- try is used to to avoid conflicts with</span><span>
</span><span id="line-395"></span><span>    </span><span class="hs-comment">-- identifiers which can start with n,b,x,u</span><span>
</span><span id="line-396"></span><span>    </span><span class="hs-comment">-- once we read the quote type and the starting '</span><span>
</span><span id="line-397"></span><span>    </span><span class="hs-comment">-- then we commit to a string</span><span>
</span><span id="line-398"></span><span>    </span><span class="hs-comment">-- it's possible that this will reject some valid syntax</span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-comment">-- but only pathalogical stuff, and I think the improved</span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-comment">-- error messages and user predictability make it a good</span><span>
</span><span id="line-401"></span><span>    </span><span class="hs-comment">-- pragmatic choice</span><span>
</span><span id="line-402"></span><span>    </span><span id="local-6989586621679160516"><span class="annot"><span class="annottext">csString :: Parser Token
</span><a href="#local-6989586621679160516"><span class="hs-identifier hs-var hs-var">csString</span></a></span></span><span>
</span><span id="line-403"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diEString"><span class="hs-identifier hs-var">diEString</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160512"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-404"></span><span>        </span><span class="annot"><span class="annottext">[Parser Token] -&gt; Parser Token
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-var">SqlString</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text -&gt; Text -&gt; Token)
-&gt; Parser Text
-&gt; ParsecT Void Text Identity (Text -&gt; Text -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
Text
</span><span class="hs-string">&quot;e'&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
Text
</span><span class="hs-string">&quot;E'&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>                          </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Text -&gt; Token)
-&gt; Parser Text -&gt; ParsecT Void Text Identity (Text -&gt; Token)
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
forall a. a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Token)
-&gt; Parser Text -&gt; Parser Token
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Parser Text
</span><a href="#local-6989586621679160562"><span class="hs-identifier hs-var">normalStringSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-406"></span><span>               </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Parser Token
</span><a href="#local-6989586621679160590"><span class="hs-identifier hs-var">csString'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-407"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Token
</span><a href="#local-6989586621679160590"><span class="hs-identifier hs-var">csString'</span></a></span><span>
</span><span id="line-408"></span><span>    </span><span id="local-6989586621679160590"><span class="annot"><span class="annottext">csString' :: Parser Token
</span><a href="#local-6989586621679160590"><span class="hs-identifier hs-var hs-var">csString'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-var">SqlString</span></a></span><span>
</span><span id="line-409"></span><span>                </span><span class="annot"><span class="annottext">(Text -&gt; Text -&gt; Text -&gt; Token)
-&gt; Parser Text
-&gt; ParsecT Void Text Identity (Text -&gt; Text -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="#local-6989586621679160599"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-410"></span><span>                </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Text -&gt; Token)
-&gt; Parser Text -&gt; ParsecT Void Text Identity (Text -&gt; Token)
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
forall a. a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;'&quot;</span></span><span>
</span><span id="line-411"></span><span>                </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Token)
-&gt; Parser Text -&gt; Parser Token
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Parser Text
</span><a href="#local-6989586621679160562"><span class="hs-identifier hs-var">normalStringSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-412"></span><span>    </span><span id="local-6989586621679160605"><span class="annot"><span class="annottext">csPrefixes :: [Text]
</span><a href="#local-6989586621679160605"><span class="hs-identifier hs-var hs-var">csPrefixes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Text) -&gt; [Char] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-operator hs-var">`T.cons`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;'&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;nNbBxX&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; [Text] -&gt; [Text]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;u&amp;'&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;U&amp;'&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-413"></span><span>    </span><span class="annot"><a href="#local-6989586621679160599"><span class="hs-identifier hs-type">cs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-414"></span><span>    </span><span id="local-6989586621679160599"><span class="annot"><span class="annottext">cs :: Parser Text
</span><a href="#local-6989586621679160599"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Parser Text] -&gt; Parser Text
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="annot"><span class="annottext">([Parser Text] -&gt; Parser Text) -&gt; [Parser Text] -&gt; Parser Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Parser Text) -&gt; [Text] -&gt; [Parser Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
Text -&gt; Parser Text
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679160605"><span class="hs-identifier hs-var">csPrefixes</span></a></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-comment">{-
Parses identifiers:

simple_identifier_23
u&amp;&quot;unicode quoted identifier&quot;
&quot;quoted identifier&quot;
&quot;quoted identifier &quot;&quot; with double quote char&quot;
`mysql quoted identifier`
-}</span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#identifier"><span class="hs-identifier hs-type">identifier</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-429"></span><span id="identifier"><span class="annot"><span class="annottext">identifier :: Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifier"><span class="hs-identifier hs-var hs-var">identifier</span></a></span></span><span> </span><span id="local-6989586621679160606"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160606"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-430"></span><span>    </span><span class="annot"><span class="annottext">[Parser Token] -&gt; Parser Token
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="annot"><span class="annottext">([Parser Token] -&gt; Parser Token) -&gt; [Parser Token] -&gt; Parser Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Parser Token
</span><a href="#local-6989586621679160607"><span class="hs-identifier hs-var">quotedIden</span></a></span><span>
</span><span id="line-432"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Parser Token
</span><a href="#local-6989586621679160608"><span class="hs-identifier hs-var">unicodeQuotedIden</span></a></span><span>
</span><span id="line-433"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Parser Token
</span><a href="#local-6989586621679160609"><span class="hs-identifier hs-var">regularIden</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-434"></span><span>    </span><span class="annot"><span class="annottext">[Parser Token] -&gt; [Parser Token] -&gt; [Parser Token]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Parser Token
</span><a href="#local-6989586621679160610"><span class="hs-identifier hs-var">mySqlQuotedIden</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diBackquotedIden"><span class="hs-identifier hs-var">diBackquotedIden</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160606"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-435"></span><span>    </span><span class="annot"><span class="annottext">[Parser Token] -&gt; [Parser Token] -&gt; [Parser Token]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Parser Token
</span><a href="#local-6989586621679160612"><span class="hs-identifier hs-var">sqlServerQuotedIden</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diSquareBracketQuotedIden"><span class="hs-identifier hs-var">diSquareBracketQuotedIden</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160606"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-437"></span><span>    </span><span id="local-6989586621679160609"><span class="annot"><span class="annottext">regularIden :: Parser Token
</span><a href="#local-6989586621679160609"><span class="hs-identifier hs-var hs-var">regularIden</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Text, Text) -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Text, Text)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token) -&gt; Parser Text -&gt; Parser Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var">identifierString</span></a></span><span>
</span><span id="line-438"></span><span>    </span><span id="local-6989586621679160607"><span class="annot"><span class="annottext">quotedIden :: Parser Token
</span><a href="#local-6989586621679160607"><span class="hs-identifier hs-var hs-var">quotedIden</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Text, Text) -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text, Text) -&gt; Maybe (Text, Text)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token) -&gt; Parser Text -&gt; Parser Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="#local-6989586621679160618"><span class="hs-identifier hs-var">qiden</span></a></span><span>
</span><span id="line-439"></span><span>    </span><span id="local-6989586621679160620"><span class="annot"><span class="annottext">failEmptyIden :: Char -&gt; Parser a
</span><a href="#local-6989586621679160620"><span class="hs-identifier hs-var hs-var">failEmptyIden</span></a></span></span><span> </span><span id="local-6989586621679160621"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160621"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; Text -&gt; Parser a
forall a. ParsecT Void Text Identity () -&gt; Text -&gt; Parser a
</span><a href="Language.SQL.SimpleSQL.Lex.html#failOnThis"><span class="hs-identifier hs-var">failOnThis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160621"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;empty identifier&quot;</span></span><span>
</span><span id="line-440"></span><span>    </span><span id="local-6989586621679160610"><span class="annot"><span class="annottext">mySqlQuotedIden :: Parser Token
</span><a href="#local-6989586621679160610"><span class="hs-identifier hs-var hs-var">mySqlQuotedIden</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-441"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Text, Text) -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text, Text) -&gt; Maybe (Text, Text)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;`&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;`&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token) -&gt; Parser Text -&gt; Parser Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-442"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'`'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; Parser Text -&gt; Parser Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span>
</span><span id="line-443"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Parser Text
forall {a}. Char -&gt; Parser a
</span><a href="#local-6989586621679160620"><span class="hs-identifier hs-var">failEmptyIden</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'`'</span></span><span>
</span><span id="line-444"></span><span>          </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [Char]
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe [Char] -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhile1P</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; Token Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'`'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; ParsecT Void Text Identity () -&gt; Parser Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'`'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>    </span><span id="local-6989586621679160612"><span class="annot"><span class="annottext">sqlServerQuotedIden :: Parser Token
</span><a href="#local-6989586621679160612"><span class="hs-identifier hs-var hs-var">sqlServerQuotedIden</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-446"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Text, Text) -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text, Text) -&gt; Maybe (Text, Text)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;[&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;]&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token) -&gt; Parser Text -&gt; Parser Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-447"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; Parser Text -&gt; Parser Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span>
</span><span id="line-448"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Parser Text
forall {a}. Char -&gt; Parser a
</span><a href="#local-6989586621679160620"><span class="hs-identifier hs-var">failEmptyIden</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span>
</span><span id="line-449"></span><span>         </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [Char]
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe [Char] -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhileP</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; [Char] -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#notElemChar"><span class="hs-operator hs-var">`notElemChar`</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;[]&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>              </span><span class="annot"><span class="annottext">Parser Text -&gt; ParsecT Void Text Identity () -&gt; Parser Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity ()] -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span>
</span><span id="line-451"></span><span>                         </span><span class="hs-comment">-- should probably do this error message as</span><span>
</span><span id="line-452"></span><span>                         </span><span class="hs-comment">-- a proper unexpected message</span><span>
</span><span id="line-453"></span><span>                         </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; Text -&gt; ParsecT Void Text Identity ()
forall a. ParsecT Void Text Identity () -&gt; Text -&gt; Parser a
</span><a href="Language.SQL.SimpleSQL.Lex.html#failOnThis"><span class="hs-identifier hs-var">failOnThis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;unexpected [&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>    </span><span class="hs-comment">-- try is used here to avoid a conflict with identifiers</span><span>
</span><span id="line-455"></span><span>    </span><span class="hs-comment">-- and quoted strings which also start with a 'u'</span><span>
</span><span id="line-456"></span><span>    </span><span id="local-6989586621679160608"><span class="annot"><span class="annottext">unicodeQuotedIden :: Parser Token
</span><a href="#local-6989586621679160608"><span class="hs-identifier hs-var hs-var">unicodeQuotedIden</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Text, Text) -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span>
</span><span id="line-457"></span><span>                        </span><span class="annot"><span class="annottext">(Maybe (Text, Text) -&gt; Text -&gt; Token)
-&gt; ParsecT Void Text Identity (Maybe (Text, Text))
-&gt; ParsecT Void Text Identity (Text -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Maybe (Text, Text)
forall {b}. IsString b =&gt; Char -&gt; Maybe (Text, b)
</span><a href="#local-6989586621679160659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Maybe (Text, Text))
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity (Maybe (Text, Text))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;uU&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;&amp;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>                        </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Token)
-&gt; Parser Text -&gt; Parser Token
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="#local-6989586621679160618"><span class="hs-identifier hs-var">qiden</span></a></span><span>
</span><span id="line-459"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679160659"><span class="annot"><span class="annottext">f :: Char -&gt; Maybe (Text, b)
</span><a href="#local-6989586621679160659"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679160664"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160664"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text, b) -&gt; Maybe (Text, b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.cons</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160664"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&amp;\&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>    </span><span id="local-6989586621679160618"><span class="annot"><span class="annottext">qiden :: Parser Text
</span><a href="#local-6989586621679160618"><span class="hs-identifier hs-var hs-var">qiden</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-461"></span><span>        </span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; Parser Text -&gt; Parser Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Parser Text
forall {a}. Char -&gt; Parser a
</span><a href="#local-6989586621679160620"><span class="hs-identifier hs-var">failEmptyIden</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; Parser Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#fstMatch"><span class="hs-identifier hs-var">fstMatch</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160670"><span class="hs-identifier hs-var">moreQIden</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; ParsecT Void Text Identity () -&gt; Parser Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>    </span><span id="local-6989586621679160670"><span class="annot"><span class="annottext">moreQIden :: ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160670"><span class="hs-identifier hs-var hs-var">moreQIden</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-463"></span><span>        </span><span class="annot"><span class="annottext">[Char]
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
[Char]
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
[Char] -&gt; m a -&gt; m a
</span><span class="hs-keyword hs-var">label</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span>
</span><span id="line-464"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [Char] -&gt; (Char -&gt; Bool) -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#takeWhileP_"><span class="hs-identifier hs-var">takeWhileP_</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>         </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#hoptional_"><span class="hs-identifier hs-var">hoptional_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">chunk</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;\&quot;\&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160670"><span class="hs-identifier hs-var">moreQIden</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-type">identifierString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-468"></span><span id="identifierString"><span class="annot"><span class="annottext">identifierString :: Parser Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var hs-var">identifierString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser Text -&gt; Parser Text
forall a.
[Char]
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
[Char] -&gt; m a -&gt; m a
</span><span class="hs-keyword hs-var">label</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;identifier&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Parser Text -&gt; Parser Text) -&gt; Parser Text -&gt; Parser Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-469"></span><span>    </span><span id="local-6989586621679160680"><span class="annot"><a href="#local-6989586621679160680"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
(Token s -&gt; Bool) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
Token Text -&gt; Bool
</span><a href="#local-6989586621679160681"><span class="hs-identifier hs-var">isFirstLetter</span></a></span><span>
</span><span id="line-470"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">choice</span></span><span>
</span><span id="line-471"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.cons</span></span><span> </span><span class="annot"><a href="#local-6989586621679160680"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">takeWhileP</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-type">isIdentifierChar</span></a></span><span>
</span><span id="line-472"></span><span>        </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.singleton</span></span><span> </span><span class="annot"><a href="#local-6989586621679160680"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-474"></span><span>     </span><span id="local-6989586621679160681"><span class="annot"><span class="annottext">isFirstLetter :: Char -&gt; Bool
</span><a href="#local-6989586621679160681"><span class="hs-identifier hs-var hs-var">isFirstLetter</span></a></span></span><span> </span><span id="local-6989586621679160684"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160684"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160684"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlpha</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160684"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-type">isIdentifierChar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-477"></span><span id="isIdentifierChar"><span class="annot"><span class="annottext">isIdentifierChar :: Char -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-var hs-var">isIdentifierChar</span></a></span></span><span> </span><span id="local-6989586621679160686"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160686"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160686"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlphaNum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160686"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#lineComment"><span class="hs-identifier hs-type">lineComment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-482"></span><span id="lineComment"><span class="annot"><span class="annottext">lineComment :: Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#lineComment"><span class="hs-identifier hs-var hs-var">lineComment</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#LineComment"><span class="hs-identifier hs-var">LineComment</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token) -&gt; Parser Text -&gt; Parser Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; Parser Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#fstMatch"><span class="hs-identifier hs-var">fstMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><span id="line-483"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">hidden</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#string_"><span class="hs-identifier hs-var">string_</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;--&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>    </span><span class="annot"><span class="annottext">Maybe [Char] -&gt; (Char -&gt; Bool) -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#takeWhileP_"><span class="hs-identifier hs-var">takeWhileP_</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>    </span><span class="hs-comment">-- can you optionally read the \n to terminate the takewhilep without reparsing it?</span><span>
</span><span id="line-486"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#hoptional_"><span class="hs-identifier hs-var">hoptional_</span></a></span><span>  </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ())
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span class="hs-comment">-- TODO: the parser before the switch to megaparsec parsed nested block comments</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- I don't know any dialects that use this, but I think it's useful, if needed,</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- add it back in under a dialect flag?</span><span>
</span><span id="line-493"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#blockComment"><span class="hs-identifier hs-type">blockComment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-494"></span><span id="blockComment"><span class="annot"><span class="annottext">blockComment :: Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#blockComment"><span class="hs-identifier hs-var hs-var">blockComment</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#BlockComment"><span class="hs-identifier hs-var">BlockComment</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token) -&gt; Parser Text -&gt; Parser Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; Parser Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#fstMatch"><span class="hs-identifier hs-var">fstMatch</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160688"><span class="hs-identifier hs-var">bc</span></a></span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-496"></span><span>    </span><span id="local-6989586621679160688"><span class="annot"><span class="annottext">bc :: ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160688"><span class="hs-identifier hs-var hs-var">bc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#chunk_"><span class="hs-identifier hs-var">chunk_</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;/*&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160702"><span class="hs-identifier hs-var">moreBlockChars</span></a></span><span>
</span><span id="line-497"></span><span>    </span><span id="local-6989586621679160708"><span class="annot"><span class="annottext">regularBlockCommentChars :: ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160708"><span class="hs-identifier hs-var hs-var">regularBlockCommentChars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
[Char]
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
[Char] -&gt; m a -&gt; m a
</span><span class="hs-keyword hs-var">label</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;*/&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ())
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-498"></span><span>        </span><span class="annot"><span class="annottext">Maybe [Char] -&gt; (Char -&gt; Bool) -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#takeWhileP_"><span class="hs-identifier hs-var">takeWhileP_</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679160709"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160709"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160709"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'*'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160709"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>    </span><span id="local-6989586621679160710"><span class="annot"><span class="annottext">continueBlockComment :: ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160710"><span class="hs-identifier hs-var hs-var">continueBlockComment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
[Char]
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
[Char] -&gt; m a -&gt; m a
</span><span class="hs-keyword hs-var">label</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;*/&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'*'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160702"><span class="hs-identifier hs-var">moreBlockChars</span></a></span><span>
</span><span id="line-500"></span><span>    </span><span id="local-6989586621679160715"><span class="annot"><span class="annottext">endComment :: ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160715"><span class="hs-identifier hs-var hs-var">endComment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
[Char]
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
[Char] -&gt; m a -&gt; m a
</span><span class="hs-keyword hs-var">label</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;*/&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ())
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#chunk_"><span class="hs-identifier hs-var">chunk_</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;*/&quot;</span></span><span>
</span><span id="line-501"></span><span>    </span><span id="local-6989586621679160702"><span class="annot"><span class="annottext">moreBlockChars :: ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160702"><span class="hs-identifier hs-var hs-var">moreBlockChars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
[Char]
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
[Char] -&gt; m a -&gt; m a
</span><span class="hs-keyword hs-var">label</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;*/&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ())
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-502"></span><span>        </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160708"><span class="hs-identifier hs-var">regularBlockCommentChars</span></a></span><span>
</span><span id="line-503"></span><span>        </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160715"><span class="hs-identifier hs-var">endComment</span></a></span><span>
</span><span id="line-504"></span><span>           </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
[Char]
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
[Char] -&gt; m a -&gt; m a
</span><span class="hs-keyword hs-var">label</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;*/&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160688"><span class="hs-identifier hs-var">bc</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160702"><span class="hs-identifier hs-var">moreBlockChars</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- nest</span><span>
</span><span id="line-505"></span><span>           </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160710"><span class="hs-identifier hs-var">continueBlockComment</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span class="hs-comment">{-
This is to improve user experience: provide an error if we see */
outside a comment. This could potentially break postgres ops with */
in them (it is not sensible to use operators that contain this as a
substring). In other cases, the user should write * / instead (I can't
think of any cases when this would be valid syntax).
-}</span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#dontParseEndBlockComment"><span class="hs-identifier hs-type">dontParseEndBlockComment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-516"></span><span id="dontParseEndBlockComment"><span class="annot"><span class="annottext">dontParseEndBlockComment :: Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#dontParseEndBlockComment"><span class="hs-identifier hs-var hs-var">dontParseEndBlockComment</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-517"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; Text -&gt; Parser Token
forall a. ParsecT Void Text Identity () -&gt; Text -&gt; Parser a
</span><a href="Language.SQL.SimpleSQL.Lex.html#failOnThis"><span class="hs-identifier hs-var">failOnThis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#chunk_"><span class="hs-identifier hs-var">chunk_</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;*/&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;comment end without comment start&quot;</span></span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-520"></span><span>
</span><span id="line-521"></span><span class="hs-comment">{-
numbers

digits
digits.[digits][e[+-]digits]
[digits].digits[e[+-]digits]
digitse[+-]digits

where digits is one or more decimal digits (0 through 9). At least one
digit must be before or after the decimal point, if one is used. At
least one digit must follow the exponent marker (e), if one is
present. There cannot be any spaces or other characters embedded in
the constant. Note that any leading plus or minus sign is not actually
considered part of the constant; it is an operator applied to the
constant.


algorithm:
either
  parse 1 or more digits
    then an optional dot which isn't two dots
    then optional digits
  or: parse a dot which isn't two dots
    then digits
followed by an optional exponent
-}</span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#sqlNumber"><span class="hs-identifier hs-type">sqlNumber</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-549"></span><span id="sqlNumber"><span class="annot"><span class="annottext">sqlNumber :: Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlNumber"><span class="hs-identifier hs-var hs-var">sqlNumber</span></a></span></span><span> </span><span id="local-6989586621679160716"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160716"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-550"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-var">SqlNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token) -&gt; Parser Text -&gt; Parser Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; Parser Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#fstMatch"><span class="hs-identifier hs-var">fstMatch</span></a></span><span>
</span><span id="line-551"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160717"><span class="hs-identifier hs-var">numStartingWithDigits</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160718"><span class="hs-identifier hs-var">numStartingWithDot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>     </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#hoptional_"><span class="hs-identifier hs-var">hoptional_</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160719"><span class="hs-identifier hs-var">expo</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160720"><span class="hs-identifier hs-var">trailingCheck</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-554"></span><span>    </span><span id="local-6989586621679160717"><span class="annot"><span class="annottext">numStartingWithDigits :: ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160717"><span class="hs-identifier hs-var hs-var">numStartingWithDigits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160721"><span class="hs-identifier hs-var">digits_</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#hoptional_"><span class="hs-identifier hs-var">hoptional_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160722"><span class="hs-identifier hs-var">safeDot</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#hoptional_"><span class="hs-identifier hs-var">hoptional_</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160721"><span class="hs-identifier hs-var">digits_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>    </span><span class="hs-comment">-- use try, so we don't commit to a number when there's a . with no following digit</span><span>
</span><span id="line-556"></span><span>    </span><span id="local-6989586621679160718"><span class="annot"><span class="annottext">numStartingWithDot :: ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160718"><span class="hs-identifier hs-var hs-var">numStartingWithDot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160722"><span class="hs-identifier hs-var">safeDot</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160721"><span class="hs-identifier hs-var">digits_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>    </span><span id="local-6989586621679160719"><span class="annot"><span class="annottext">expo :: ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160719"><span class="hs-identifier hs-var hs-var">expo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'e'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'E'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#optional_"><span class="hs-identifier hs-var">optional_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'+'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160721"><span class="hs-identifier hs-var">digits_</span></a></span><span>
</span><span id="line-558"></span><span>    </span><span id="local-6989586621679160721"><span class="annot"><span class="annottext">digits_ :: ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160721"><span class="hs-identifier hs-var hs-var">digits_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
[Char]
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
[Char] -&gt; m a -&gt; m a
</span><span class="hs-keyword hs-var">label</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;digits&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ())
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char] -&gt; (Char -&gt; Bool) -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#takeWhile1P_"><span class="hs-identifier hs-var">takeWhile1P_</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span>
</span><span id="line-559"></span><span>    </span><span class="hs-comment">-- if there's a '..' next to the number, and it's a dialect that has .. as a</span><span>
</span><span id="line-560"></span><span>    </span><span class="hs-comment">-- lexical token, parse what we have so far and leave the dots in the chamber</span><span>
</span><span id="line-561"></span><span>    </span><span class="hs-comment">-- otherwise, give an error</span><span>
</span><span id="line-562"></span><span>    </span><span id="local-6989586621679160722"><span class="annot"><span class="annottext">safeDot :: ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160722"><span class="hs-identifier hs-var hs-var">safeDot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-563"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160716"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-564"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-565"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>    </span><span class="hs-comment">-- additional check to give an error if the number is immediately</span><span>
</span><span id="line-567"></span><span>    </span><span class="hs-comment">-- followed by e, E or . with an exception for .. if this symbol is supported</span><span>
</span><span id="line-568"></span><span>    </span><span id="local-6989586621679160720"><span class="annot"><span class="annottext">trailingCheck :: ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160720"><span class="hs-identifier hs-var hs-var">trailingCheck</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-569"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160716"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-570"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-comment">-- special case to allow e.g. 1..2</span><span>
</span><span id="line-571"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">lookAhead</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ())
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">hidden</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ())
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#chunk_"><span class="hs-identifier hs-var">chunk_</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;..&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;eE.&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;eE.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#digits"><span class="hs-identifier hs-type">digits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-576"></span><span id="digits"><span class="annot"><span class="annottext">digits :: Parser Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#digits"><span class="hs-identifier hs-var hs-var">digits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser Text -&gt; Parser Text
forall a.
[Char]
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
[Char] -&gt; m a -&gt; m a
</span><span class="hs-keyword hs-var">label</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;digits&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Parser Text -&gt; Parser Text) -&gt; Parser Text -&gt; Parser Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe [Char] -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhile1P</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
Token Text -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#positionalArg"><span class="hs-identifier hs-type">positionalArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-581"></span><span id="positionalArg"><span class="annot"><span class="annottext">positionalArg :: Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#positionalArg"><span class="hs-identifier hs-var hs-var">positionalArg</span></a></span></span><span> </span><span id="local-6989586621679160736"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160736"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-582"></span><span>    </span><span class="hs-comment">-- use try to avoid ambiguities with other syntax which starts with dollar</span><span>
</span><span id="line-583"></span><span>    </span><span class="annot"><span class="annottext">[Parser Token] -&gt; Parser Token
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#PositionalArg"><span class="hs-identifier hs-var">PositionalArg</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Token) -&gt; ParsecT Void Text Identity Int -&gt; Parser Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-584"></span><span>            </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Int -&gt; ParsecT Void Text Identity Int
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'$'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity Int -&gt; ParsecT Void Text Identity Int
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. Read a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Int) -&gt; (Text -&gt; [Char]) -&gt; Text -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Int) -&gt; Parser Text -&gt; ParsecT Void Text Identity Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#digits"><span class="hs-identifier hs-var">digits</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPositionalArg"><span class="hs-identifier hs-var">diPositionalArg</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160736"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-587"></span><span>
</span><span id="line-588"></span><span class="hs-comment">-- todo: I think the try here should read a prefix char, then a single valid</span><span>
</span><span id="line-589"></span><span class="hs-comment">-- identifier char, then commit</span><span>
</span><span id="line-590"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prefixedVariable"><span class="hs-identifier hs-type">prefixedVariable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-591"></span><span id="prefixedVariable"><span class="annot"><span class="annottext">prefixedVariable :: Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#prefixedVariable"><span class="hs-identifier hs-var hs-var">prefixedVariable</span></a></span></span><span> </span><span id="local-6989586621679160739"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160739"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Token -&gt; Parser Token
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(Parser Token -&gt; Parser Token) -&gt; Parser Token -&gt; Parser Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Parser Token] -&gt; Parser Token
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="annot"><span class="annottext">([Parser Token] -&gt; Parser Token) -&gt; [Parser Token] -&gt; Parser Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-592"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-var">PrefixedVariable</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Text -&gt; Token)
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity (Text -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Token)
-&gt; Parser Text -&gt; Parser Token
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var">identifierString</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-593"></span><span>    </span><span class="annot"><span class="annottext">[Parser Token] -&gt; [Parser Token] -&gt; [Parser Token]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-var">PrefixedVariable</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Text -&gt; Token)
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity (Text -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'@'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Token)
-&gt; Parser Text -&gt; Parser Token
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var">identifierString</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diAtIdentifier"><span class="hs-identifier hs-var">diAtIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160739"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-594"></span><span>    </span><span class="annot"><span class="annottext">[Parser Token] -&gt; [Parser Token] -&gt; [Parser Token]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-var">PrefixedVariable</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Text -&gt; Token)
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity (Text -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'#'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Token)
-&gt; Parser Text -&gt; Parser Token
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var">identifierString</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diHashIdentifier"><span class="hs-identifier hs-var">diHashIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160739"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-597"></span><span>
</span><span id="line-598"></span><span class="hs-comment">{-
Symbols

A symbol is an operator, or one of the misc symbols which include:
. .. := : :: ( ) ? ; , { } (for odbc)

The postgresql operator syntax allows a huge range of operators
compared with ansi and other dialects
-}</span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#symbol"><span class="hs-identifier hs-type">symbol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-609"></span><span id="symbol"><span class="annot"><span class="annottext">symbol :: Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#symbol"><span class="hs-identifier hs-var hs-var">symbol</span></a></span></span><span> </span><span id="local-6989586621679160742"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160742"><span class="hs-identifier hs-var">d</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-var">Symbol</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token) -&gt; Parser Text -&gt; Parser Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Parser Text] -&gt; Parser Text
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Parser Text]] -&gt; [Parser Text]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-610"></span><span>   </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[ParsecT Void Text Identity (Tokens Text)]
[Parser Text]
</span><a href="#local-6989586621679160744"><span class="hs-identifier hs-var">dots</span></a></span><span>
</span><span id="line-611"></span><span>   </span><span class="hs-special">,</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160742"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-612"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity (Tokens Text)]
[Parser Text]
</span><a href="#local-6989586621679160745"><span class="hs-identifier hs-var">postgresExtraSymbols</span></a></span><span>
</span><span id="line-613"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-614"></span><span>   </span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Parser Text]
</span><a href="#local-6989586621679160746"><span class="hs-identifier hs-var">miscSymbol</span></a></span><span>
</span><span id="line-615"></span><span>   </span><span class="hs-special">,</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diOdbc"><span class="hs-identifier hs-var">diOdbc</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160742"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity (Tokens Text)]
[Parser Text]
</span><a href="#local-6989586621679160748"><span class="hs-identifier hs-var">odbcSymbol</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-616"></span><span>   </span><span class="hs-special">,</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160742"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-617"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Parser Text]
</span><a href="Language.SQL.SimpleSQL.Lex.html#generalizedPostgresqlOperator"><span class="hs-identifier hs-var">generalizedPostgresqlOperator</span></a></span><span>
</span><span id="line-618"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Parser Text]
</span><a href="#local-6989586621679160750"><span class="hs-identifier hs-var">basicAnsiOps</span></a></span><span>
</span><span id="line-619"></span><span>   </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-620"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-621"></span><span>   </span><span id="local-6989586621679160744"><span class="annot"><span class="annottext">dots :: [ParsecT Void Text Identity (Tokens Text)]
</span><a href="#local-6989586621679160744"><span class="hs-identifier hs-var hs-var">dots</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe [Char]
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe [Char] -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhile1P</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; Token Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'.'</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-622"></span><span>   </span><span id="local-6989586621679160748"><span class="annot"><span class="annottext">odbcSymbol :: [ParsecT Void Text Identity (Tokens Text)]
</span><a href="#local-6989586621679160748"><span class="hs-identifier hs-var hs-var">odbcSymbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;{&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;}&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-623"></span><span>   </span><span id="local-6989586621679160745"><span class="annot"><span class="annottext">postgresExtraSymbols :: [ParsecT Void Text Identity (Tokens Text)]
</span><a href="#local-6989586621679160745"><span class="hs-identifier hs-var hs-var">postgresExtraSymbols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-624"></span><span>       </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity (Tokens Text)
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;:=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>        </span><span class="hs-comment">-- parse :: and : and avoid allowing ::: or more</span><span>
</span><span id="line-626"></span><span>       </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity (Tokens Text)
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;::&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity (Tokens Text)
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">':'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-627"></span><span>       </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity (Tokens Text)
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity (Tokens Text)
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">':'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-628"></span><span>   </span><span id="local-6989586621679160746"><span class="annot"><span class="annottext">miscSymbol :: [Parser Text]
</span><a href="#local-6989586621679160746"><span class="hs-identifier hs-var hs-var">miscSymbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Parser Text) -&gt; [Char] -&gt; [Parser Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
Text -&gt; Parser Text
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Parser Text) -&gt; (Char -&gt; Text) -&gt; Char -&gt; Parser Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Parser Text]) -&gt; [Char] -&gt; [Parser Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-629"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-630"></span><span>                    </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diSqlServerSymbols"><span class="hs-identifier hs-var">diSqlServerSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160742"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;,;():?&quot;</span></span><span>
</span><span id="line-631"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160742"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;[],;()&quot;</span></span><span>
</span><span id="line-632"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;[],;():?&quot;</span></span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span class="hs-comment">{-
try is used because most of the first characters of the two character
symbols can also be part of a single character symbol
-}</span><span>
</span><span id="line-638"></span><span>
</span><span id="line-639"></span><span>   </span><span id="local-6989586621679160750"><span class="annot"><span class="annottext">basicAnsiOps :: [Parser Text]
</span><a href="#local-6989586621679160750"><span class="hs-identifier hs-var hs-var">basicAnsiOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Tokens Text -&gt; Parser Text) -&gt; [Tokens Text] -&gt; [Parser Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(Parser Text -&gt; Parser Text)
-&gt; (Tokens Text -&gt; Parser Text) -&gt; Tokens Text -&gt; Parser Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
Tokens Text -&gt; Parser Text
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;&gt;=&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;&lt;=&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;!=&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;&lt;&gt;&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-640"></span><span>                  </span><span class="annot"><span class="annottext">[Parser Text] -&gt; [Parser Text] -&gt; [Parser Text]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Parser Text) -&gt; [Char] -&gt; [Parser Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
Text -&gt; Parser Text
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Parser Text) -&gt; (Char -&gt; Text) -&gt; Char -&gt; Parser Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;+-^*/%~&amp;&lt;&gt;=&quot;</span></span><span>
</span><span id="line-641"></span><span>                  </span><span class="annot"><span class="annottext">[Parser Text] -&gt; [Parser Text] -&gt; [Parser Text]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Parser Text]
</span><a href="#local-6989586621679160820"><span class="hs-identifier hs-var">pipes</span></a></span><span>
</span><span id="line-642"></span><span>   </span><span id="local-6989586621679160820"><span class="annot"><span class="annottext">pipes :: [Parser Text]
</span><a href="#local-6989586621679160820"><span class="hs-identifier hs-var hs-var">pipes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- what about using many1 (char '|'), then it will</span><span>
</span><span id="line-643"></span><span>           </span><span class="hs-comment">-- fail in the parser? Not sure exactly how</span><span>
</span><span id="line-644"></span><span>           </span><span class="hs-comment">-- standalone the lexer should be</span><span>
</span><span id="line-645"></span><span>           </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'|'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; Parser Text -&gt; Parser Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span>
</span><span id="line-646"></span><span>            </span><span class="annot"><span class="annottext">[Parser Text] -&gt; Parser Text
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;||&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity Char -&gt; Parser Text
forall a b.
a -&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'|'</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; ParsecT Void Text Identity () -&gt; Parser Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'|'</span></span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span>                   </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text -&gt; Parser Text
forall a. a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-648"></span><span>
</span><span id="line-649"></span><span class="hs-comment">{-
postgresql generalized operators

this includes the custom operators that postgres supports,
plus all the standard operators which could be custom operators
according to their grammar

rules

An operator name is a sequence of up to NAMEDATALEN-1 (63 by default) characters from the following list:

+ - * / &lt; &gt; = ~ ! @ # % ^ &amp; | ` ?

There are a few restrictions on operator names, however:
-- and /* cannot appear anywhere in an operator name, since they will be taken as the start of a comment.

A multiple-character operator name cannot end in + or -, unless the name also contains at least one of these characters:

~ ! @ # % ^ &amp; | ` ?

which allows the last character of a multi character symbol to be + or
-
-}</span><span>
</span><span id="line-672"></span><span>
</span><span id="line-673"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#generalizedPostgresqlOperator"><span class="hs-identifier hs-type">generalizedPostgresqlOperator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-674"></span><span id="generalizedPostgresqlOperator"><span class="annot"><span class="annottext">generalizedPostgresqlOperator :: [Parser Text]
</span><a href="Language.SQL.SimpleSQL.Lex.html#generalizedPostgresqlOperator"><span class="hs-identifier hs-var hs-var">generalizedPostgresqlOperator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Parser Text
</span><a href="#local-6989586621679160854"><span class="hs-identifier hs-var">singlePlusMinus</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Parser Text
</span><a href="#local-6989586621679160855"><span class="hs-identifier hs-var">opMoreChars</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-675"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-676"></span><span>    </span><span id="local-6989586621679160857"><span class="annot"><span class="annottext">allOpSymbols :: [Char]
</span><a href="#local-6989586621679160857"><span class="hs-identifier hs-var hs-var">allOpSymbols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;+-*/&lt;&gt;=~!@#%^&amp;|`?&quot;</span></span><span>
</span><span id="line-677"></span><span>    </span><span class="hs-comment">-- these are the symbols when if part of a multi character</span><span>
</span><span id="line-678"></span><span>    </span><span class="hs-comment">-- operator permit the operator to end with a + or - symbol</span><span>
</span><span id="line-679"></span><span>    </span><span id="local-6989586621679160859"><span class="annot"><span class="annottext">exceptionOpSymbols :: [Char]
</span><a href="#local-6989586621679160859"><span class="hs-identifier hs-var hs-var">exceptionOpSymbols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;~!@#%^&amp;|`?&quot;</span></span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span>    </span><span class="hs-comment">-- special case for parsing a single + or - symbol</span><span>
</span><span id="line-682"></span><span>    </span><span id="local-6989586621679160854"><span class="annot"><span class="annottext">singlePlusMinus :: Parser Text
</span><a href="#local-6989586621679160854"><span class="hs-identifier hs-var hs-var">singlePlusMinus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(Parser Text -&gt; Parser Text) -&gt; Parser Text -&gt; Parser Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-683"></span><span>      </span><span id="local-6989586621679160860"><span class="annot"><a href="#local-6989586621679160860"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;+-&quot;</span></span><span>
</span><span id="line-684"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">notFollowedBy</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-type">oneOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160857"><span class="hs-identifier hs-type">allOpSymbols</span></a></span><span>
</span><span id="line-685"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.singleton</span></span><span> </span><span class="annot"><a href="#local-6989586621679160860"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-686"></span><span>
</span><span id="line-687"></span><span>    </span><span class="hs-comment">-- this is used when we are parsing a potentially multi symbol</span><span>
</span><span id="line-688"></span><span>    </span><span class="hs-comment">-- operator and we have alread seen one of the 'exception chars'</span><span>
</span><span id="line-689"></span><span>    </span><span class="hs-comment">-- and so we can end with a + or -</span><span>
</span><span id="line-690"></span><span>    </span><span id="local-6989586621679160861"><span class="annot"><span class="annottext">moreOpCharsException :: Parser Text
</span><a href="#local-6989586621679160861"><span class="hs-identifier hs-var hs-var">moreOpCharsException</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-691"></span><span>       </span><span id="local-6989586621679160862"><span class="annot"><a href="#local-6989586621679160862"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ShowS
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; [Char] -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#notElemChar"><span class="hs-operator hs-var">`notElemChar`</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-/*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160857"><span class="hs-identifier hs-var">allOpSymbols</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-692"></span><span>            </span><span class="hs-comment">-- make sure we don't parse a comment starting token</span><span>
</span><span id="line-693"></span><span>            </span><span class="hs-comment">-- as part of an operator</span><span>
</span><span id="line-694"></span><span>            </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'/'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'*'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-695"></span><span>            </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'-'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'-'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-696"></span><span>            </span><span class="hs-comment">-- and make sure we don't parse a block comment end</span><span>
</span><span id="line-697"></span><span>            </span><span class="hs-comment">-- as part of another symbol</span><span>
</span><span id="line-698"></span><span>            </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'*'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-699"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">T.cons</span></span><span> </span><span class="annot"><a href="#local-6989586621679160862"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">option</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621679160861"><span class="hs-identifier hs-type">moreOpCharsException</span></a></span><span>
</span><span id="line-700"></span><span>
</span><span id="line-701"></span><span>    </span><span id="local-6989586621679160855"><span class="annot"><span class="annottext">opMoreChars :: Parser Text
</span><a href="#local-6989586621679160855"><span class="hs-identifier hs-var hs-var">opMoreChars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Parser Text] -&gt; Parser Text
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-702"></span><span>       </span><span class="hs-special">[</span><span class="hs-comment">-- parse an exception char, now we can finish with a + -</span><span>
</span><span id="line-703"></span><span>        </span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.cons</span></span><span>
</span><span id="line-704"></span><span>        </span><span class="annot"><span class="annottext">(Char -&gt; Text -&gt; Text)
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity (Text -&gt; Text)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160859"><span class="hs-identifier hs-var">exceptionOpSymbols</span></a></span><span>
</span><span id="line-705"></span><span>        </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Text)
-&gt; Parser Text -&gt; Parser Text
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text -&gt; Parser Text
forall (m :: * -&gt; *) a. Alternative m =&gt; a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="#local-6989586621679160861"><span class="hs-identifier hs-var">moreOpCharsException</span></a></span><span>
</span><span id="line-706"></span><span>       </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.cons</span></span><span>
</span><span id="line-707"></span><span>        </span><span class="annot"><span class="annottext">(Char -&gt; Text -&gt; Text)
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity (Text -&gt; Text)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-comment">-- parse +, make sure it isn't the last symbol</span><span>
</span><span id="line-708"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'+'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">lookAhead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160857"><span class="hs-identifier hs-var">allOpSymbols</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-709"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-comment">-- parse -, make sure it isn't the last symbol</span><span>
</span><span id="line-710"></span><span>                 </span><span class="hs-comment">-- or the start of a -- comment</span><span>
</span><span id="line-711"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'-'</span></span><span>
</span><span id="line-712"></span><span>                  </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'-'</span></span><span class="hs-special">)</span><span>
</span><span id="line-713"></span><span>                  </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">lookAhead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160857"><span class="hs-identifier hs-var">allOpSymbols</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-714"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-comment">-- parse / check it isn't the start of a /* comment</span><span>
</span><span id="line-715"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'/'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'*'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-716"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-comment">-- make sure we don't parse */ as part of a symbol</span><span>
</span><span id="line-717"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'*'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a. Parser a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-718"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-comment">-- any other ansi operator symbol</span><span>
</span><span id="line-719"></span><span>             </span><span class="annot"><span class="annottext">[Char] -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&lt;&gt;=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-720"></span><span>        </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Text)
-&gt; Parser Text -&gt; Parser Text
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text -&gt; Parser Text
forall (m :: * -&gt; *) a. Alternative m =&gt; a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="#local-6989586621679160855"><span class="hs-identifier hs-var">opMoreChars</span></a></span><span>
</span><span id="line-721"></span><span>       </span><span class="hs-special">]</span><span>
</span><span id="line-722"></span><span>
</span><span id="line-723"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-724"></span><span>
</span><span id="line-725"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#sqlWhitespace"><span class="hs-identifier hs-type">sqlWhitespace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-726"></span><span id="sqlWhitespace"><span class="annot"><span class="annottext">sqlWhitespace :: Dialect -&gt; Parser Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlWhitespace"><span class="hs-identifier hs-var hs-var">sqlWhitespace</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Whitespace"><span class="hs-identifier hs-var">Whitespace</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token) -&gt; Parser Text -&gt; Parser Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe [Char] -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhile1P</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
Token Text -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-729"></span><span>
</span><span id="line-730"></span><span class="hs-comment">-- parser helpers</span><span>
</span><span id="line-731"></span><span>
</span><span id="line-732"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-type">char_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-733"></span><span id="char_"><span class="annot"><span class="annottext">char_ :: Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var hs-var">char_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ())
-&gt; (Char -&gt; ParsecT Void Text Identity Char)
-&gt; Char
-&gt; ParsecT Void Text Identity ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity Char
Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span>
</span><span id="line-734"></span><span>
</span><span id="line-735"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#hchar_"><span class="hs-identifier hs-type">hchar_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-736"></span><span id="hchar_"><span class="annot"><span class="annottext">hchar_ :: Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#hchar_"><span class="hs-identifier hs-var hs-var">hchar_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ())
-&gt; (Char -&gt; ParsecT Void Text Identity Char)
-&gt; Char
-&gt; ParsecT Void Text Identity ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">hidden</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity Char
 -&gt; ParsecT Void Text Identity Char)
-&gt; (Char -&gt; ParsecT Void Text Identity Char)
-&gt; Char
-&gt; ParsecT Void Text Identity Char
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity Char
Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span>
</span><span id="line-737"></span><span>
</span><span id="line-738"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#string_"><span class="hs-identifier hs-type">string_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-739"></span><span id="string_"><span class="annot"><span class="annottext">string_ :: Text -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#string_"><span class="hs-identifier hs-var hs-var">string_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(Parser Text -&gt; ParsecT Void Text Identity ())
-&gt; (Text -&gt; Parser Text) -&gt; Text -&gt; ParsecT Void Text Identity ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
Text -&gt; Parser Text
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span>
</span><span id="line-740"></span><span>
</span><span id="line-741"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-type">oneOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-742"></span><span id="oneOf"><span class="annot"><span class="annottext">oneOf :: [Char] -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var hs-var">oneOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ParsecT Void Text Identity Char
[Token Text] -&gt; ParsecT Void Text Identity (Token Text)
forall (f :: * -&gt; *) e s (m :: * -&gt; *).
(Foldable f, MonadParsec e s m) =&gt;
f (Token s) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">M.oneOf</span></span><span>
</span><span id="line-743"></span><span>
</span><span id="line-744"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#notElemChar"><span class="hs-identifier hs-type">notElemChar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-745"></span><span id="notElemChar"><span class="annot"><span class="annottext">notElemChar :: Char -&gt; [Char] -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#notElemChar"><span class="hs-identifier hs-var hs-var">notElemChar</span></a></span></span><span> </span><span id="local-6989586621679160864"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160864"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679160865"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160865"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160864"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; [Char] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160865"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-746"></span><span>
</span><span id="line-747"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#fstMatch"><span class="hs-identifier hs-type">fstMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-748"></span><span id="fstMatch"><span class="annot"><span class="annottext">fstMatch :: ParsecT Void Text Identity () -&gt; Parser Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#fstMatch"><span class="hs-identifier hs-var hs-var">fstMatch</span></a></span></span><span> </span><span id="local-6989586621679160867"><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160867"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text, ()) -&gt; Text
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Text, ()) -&gt; Text)
-&gt; ParsecT Void Text Identity (Text, ()) -&gt; Parser Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity (Tokens Text, ())
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
m a -&gt; m (Tokens s, a)
</span><span class="hs-identifier hs-var">match</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160867"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-749"></span><span>
</span><span id="line-750"></span><span id="local-6989586621679159808"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#hoptional_"><span class="hs-identifier hs-type">hoptional_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159808"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-751"></span><span id="hoptional_"><span class="annot"><span class="annottext">hoptional_ :: forall a. Parser a -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#hoptional_"><span class="hs-identifier hs-var hs-var">hoptional_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Maybe a)
-&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity (Maybe a)
 -&gt; ParsecT Void Text Identity ())
-&gt; (Parser a -&gt; ParsecT Void Text Identity (Maybe a))
-&gt; Parser a
-&gt; ParsecT Void Text Identity ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Parser a -&gt; ParsecT Void Text Identity (Maybe a)
forall a. Parser a -&gt; Parser (Maybe a)
</span><a href="Language.SQL.SimpleSQL.Lex.html#hoptional"><span class="hs-identifier hs-var">hoptional</span></a></span><span>
</span><span id="line-752"></span><span>
</span><span id="line-753"></span><span id="local-6989586621679159844"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#hoptional"><span class="hs-identifier hs-type">hoptional</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159844"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679159844"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-754"></span><span id="hoptional"><span class="annot"><span class="annottext">hoptional :: forall a. Parser a -&gt; Parser (Maybe a)
</span><a href="Language.SQL.SimpleSQL.Lex.html#hoptional"><span class="hs-identifier hs-var hs-var">hoptional</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Maybe a)
-&gt; ParsecT Void Text Identity (Maybe a)
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">hidden</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity (Maybe a)
 -&gt; ParsecT Void Text Identity (Maybe a))
-&gt; (Parser a -&gt; ParsecT Void Text Identity (Maybe a))
-&gt; Parser a
-&gt; ParsecT Void Text Identity (Maybe a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Parser a -&gt; ParsecT Void Text Identity (Maybe a)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><span class="hs-identifier hs-var">optional</span></span><span>
</span><span id="line-755"></span><span>
</span><span id="line-756"></span><span id="local-6989586621679160872"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#optional_"><span class="hs-identifier hs-type">optional_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679160872"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-757"></span><span id="optional_"><span class="annot"><span class="annottext">optional_ :: forall a. Parser a -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#optional_"><span class="hs-identifier hs-var hs-var">optional_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Maybe a)
-&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity (Maybe a)
 -&gt; ParsecT Void Text Identity ())
-&gt; (Parser a -&gt; ParsecT Void Text Identity (Maybe a))
-&gt; Parser a
-&gt; ParsecT Void Text Identity ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Parser a -&gt; ParsecT Void Text Identity (Maybe a)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><span class="hs-identifier hs-var">optional</span></span><span>
</span><span id="line-758"></span><span>
</span><span id="line-759"></span><span class="hs-comment">--hoption :: a -&gt; Parser a -&gt; Parser a</span><span>
</span><span id="line-760"></span><span class="hs-comment">--hoption a p = hidden $ option a p</span><span>
</span><span id="line-761"></span><span>
</span><span id="line-762"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#takeWhileP_"><span class="hs-identifier hs-type">takeWhileP_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span id="takeWhileP_"><span class="annot"><span class="annottext">takeWhileP_ :: Maybe [Char] -&gt; (Char -&gt; Bool) -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#takeWhileP_"><span class="hs-identifier hs-var hs-var">takeWhileP_</span></a></span></span><span> </span><span id="local-6989586621679160875"><span class="annot"><span class="annottext">Maybe [Char]
</span><a href="#local-6989586621679160875"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679160876"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679160876"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity (Tokens Text)
 -&gt; ParsecT Void Text Identity ())
-&gt; ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe [Char] -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhileP</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
</span><a href="#local-6989586621679160875"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
Token Text -&gt; Bool
</span><a href="#local-6989586621679160876"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-764"></span><span>
</span><span id="line-765"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#takeWhile1P_"><span class="hs-identifier hs-type">takeWhile1P_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-766"></span><span id="takeWhile1P_"><span class="annot"><span class="annottext">takeWhile1P_ :: Maybe [Char] -&gt; (Char -&gt; Bool) -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#takeWhile1P_"><span class="hs-identifier hs-var hs-var">takeWhile1P_</span></a></span></span><span> </span><span id="local-6989586621679160877"><span class="annot"><span class="annottext">Maybe [Char]
</span><a href="#local-6989586621679160877"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679160878"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679160878"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity (Tokens Text)
 -&gt; ParsecT Void Text Identity ())
-&gt; ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe [Char] -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhile1P</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
</span><a href="#local-6989586621679160877"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
Token Text -&gt; Bool
</span><a href="#local-6989586621679160878"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-767"></span><span>
</span><span id="line-768"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#chunk_"><span class="hs-identifier hs-type">chunk_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-769"></span><span id="chunk_"><span class="annot"><span class="annottext">chunk_ :: Text -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#chunk_"><span class="hs-identifier hs-var hs-var">chunk_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(Parser Text -&gt; ParsecT Void Text Identity ())
-&gt; (Text -&gt; Parser Text) -&gt; Text -&gt; ParsecT Void Text Identity ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
Text -&gt; Parser Text
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">chunk</span></span><span>
</span><span id="line-770"></span><span>
</span><span id="line-771"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#hchunk_"><span class="hs-identifier hs-type">hchunk_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-772"></span><span id="hchunk_"><span class="annot"><span class="annottext">hchunk_ :: Text -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#hchunk_"><span class="hs-identifier hs-var hs-var">hchunk_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(Parser Text -&gt; ParsecT Void Text Identity ())
-&gt; (Text -&gt; Parser Text) -&gt; Text -&gt; ParsecT Void Text Identity ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">hidden</span></span><span> </span><span class="annot"><span class="annottext">(Parser Text -&gt; Parser Text)
-&gt; (Text -&gt; Parser Text) -&gt; Text -&gt; Parser Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
Text -&gt; Parser Text
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">chunk</span></span><span>
</span><span id="line-773"></span><span>
</span><span id="line-774"></span><span id="local-6989586621679159821"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#failOnThis"><span class="hs-identifier hs-type">failOnThis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159821"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-775"></span><span id="failOnThis"><span class="annot"><span class="annottext">failOnThis :: forall a. ParsecT Void Text Identity () -&gt; Text -&gt; Parser a
</span><a href="Language.SQL.SimpleSQL.Lex.html#failOnThis"><span class="hs-identifier hs-var hs-var">failOnThis</span></a></span></span><span> </span><span id="local-6989586621679160885"><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
</span><a href="#local-6989586621679160885"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679160886"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160886"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-776"></span><span>    </span><span id="local-6989586621679160887"><span class="annot"><a href="#local-6989586621679160887"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Int
forall e s (m :: * -&gt; *). MonadParsec e s m =&gt; m Int
</span><span class="hs-identifier hs-var">getOffset</span></span><span>
</span><span id="line-777"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">hidden</span></span><span> </span><span class="annot"><a href="#local-6989586621679160885"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-778"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">region</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">setErrorOffset</span></span><span> </span><span class="annot"><a href="#local-6989586621679160887"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fail</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.unpack</span></span><span> </span><span class="annot"><a href="#local-6989586621679160886"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-779"></span><span>
</span><span id="line-780"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-781"></span><span>
</span><span id="line-782"></span><span>
</span><span id="line-783"></span><span class="hs-comment">{-
This utility function will accurately report if the two tokens are
pretty printed, if they should lex back to the same two tokens. This
function is used in testing (and can be used in other places), and
must not be implemented by actually trying to print both tokens and
then lex them back from a single string (because then we would have
the risk of thinking two tokens cannot be together when there is bug
in the lexer, which the testing is supposed to find).

maybe do some quick checking to make sure this function only gives
true negatives: check pairs which return false actually fail to lex or
give different symbols in return: could use quickcheck for this

a good sanity test for this function is to change it to always return
true, then check that the automated tests return the same number of
successes. I don't think it succeeds this test at the moment
-}</span><span>
</span><span id="line-800"></span><span>
</span><span id="line-801"></span><span class="hs-comment">-- | Utility function to tell you if a list of tokens</span><span>
</span><span id="line-802"></span><span class="hs-comment">-- will pretty print then lex back to the same set of tokens.</span><span>
</span><span id="line-803"></span><span class="hs-comment">-- Used internally, might be useful for generating SQL via lexical tokens.</span><span>
</span><span id="line-804"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier hs-type">tokenListWillPrintAndLex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-805"></span><span id="tokenListWillPrintAndLex"><span class="annot"><span class="annottext">tokenListWillPrintAndLex :: Dialect -&gt; [Token] -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier hs-var hs-var">tokenListWillPrintAndLex</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-806"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier hs-var">tokenListWillPrintAndLex</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-807"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier hs-var">tokenListWillPrintAndLex</span></a></span><span> </span><span id="local-6989586621679160888"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160888"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160889"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160889"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679160890"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160890"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679160891"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679160891"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-808"></span><span>    </span><span class="annot"><span class="annottext">Dialect -&gt; Token -&gt; Token -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokensWillPrintAndLex"><span class="hs-identifier hs-var">tokensWillPrintAndLex</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160888"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160889"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160890"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; [Token] -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier hs-var">tokenListWillPrintAndLex</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160888"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160890"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679160891"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-809"></span><span>
</span><span id="line-810"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#tokensWillPrintAndLex"><span class="hs-identifier hs-type">tokensWillPrintAndLex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-811"></span><span id="tokensWillPrintAndLex"><span class="annot"><span class="annottext">tokensWillPrintAndLex :: Dialect -&gt; Token -&gt; Token -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokensWillPrintAndLex"><span class="hs-identifier hs-var hs-var">tokensWillPrintAndLex</span></a></span></span><span> </span><span id="local-6989586621679160893"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160893"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679160894"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160894"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679160895"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160895"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-812"></span><span>
</span><span id="line-813"></span><span class="hs-comment">{-
a : followed by an identifier character will look like a host param
followed by = or : makes a different symbol
-}</span><span>
</span><span id="line-817"></span><span>
</span><span id="line-818"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160894"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-819"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679160896"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679160897"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160897"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-var">isIdentifierChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160897"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160897"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.elem`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;:=&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-820"></span><span>
</span><span id="line-821"></span><span class="hs-comment">{-
two symbols next to eachother will fail if the symbols can combine and
(possibly just the prefix) look like a different symbol
-}</span><span>
</span><span id="line-825"></span><span>
</span><span id="line-826"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160893"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-827"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span id="local-6989586621679160899"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160899"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160894"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-828"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span id="local-6989586621679160900"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160900"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160895"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-829"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160900"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;+&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;-&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; [Char] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.elem`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160899"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;~!@#%^&amp;|`?&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-830"></span><span>
</span><span id="line-831"></span><span class="hs-comment">{-
check two adjacent symbols in non postgres where the combination
possibilities are much more limited. This is ansi behaviour, it might
be different when the other dialects are done properly
-}</span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span id="local-6989586621679160902"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160902"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160894"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-838"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span id="local-6989586621679160903"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160903"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160895"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-839"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160902"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160903"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text, Text) -&gt; [(Text, Text)] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&lt;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-840"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&lt;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-841"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-842"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;!&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-843"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-844"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;||&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-845"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;||&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-846"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;||&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;||&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-847"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&lt;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&gt;=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-848"></span><span>                    </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-849"></span><span>
</span><span id="line-850"></span><span class="hs-comment">-- two whitespaces will be combined</span><span>
</span><span id="line-851"></span><span>
</span><span id="line-852"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Whitespace"><span class="hs-identifier hs-type">Whitespace</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160894"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-853"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Whitespace"><span class="hs-identifier hs-type">Whitespace</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160895"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-854"></span><span>
</span><span id="line-855"></span><span class="hs-comment">-- line comment without a newline at the end will eat the next token</span><span>
</span><span id="line-856"></span><span>
</span><span id="line-857"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#LineComment"><span class="hs-identifier hs-type">LineComment</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160894"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-858"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679160905"><span class="hs-identifier hs-var">checkLastAChar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span class="hs-comment">{-
check the last character of the first token and the first character of
the second token forming a comment start or end symbol
-}</span><span>
</span><span id="line-864"></span><span>
</span><span id="line-865"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679160906"><span class="annot"><span class="annottext">f :: Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679160906"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-866"></span><span>         </span><span class="annot"><a href="#local-6989586621679160906"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'*'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-867"></span><span>         </span><span class="annot"><a href="#local-6989586621679160906"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'*'</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-868"></span><span>         </span><span class="annot"><a href="#local-6989586621679160906"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-869"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679160907"><span class="hs-identifier hs-var">checkBorderChars</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679160906"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-870"></span><span>
</span><span id="line-871"></span><span class="hs-comment">{-
a symbol will absorb a following .
TODO: not 100% on this always being bad
-}</span><span>
</span><span id="line-875"></span><span>
</span><span id="line-876"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160894"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-877"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679160896"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-878"></span><span>
</span><span id="line-879"></span><span class="hs-comment">-- cannot follow a symbol ending in : with another token starting with :</span><span>
</span><span id="line-880"></span><span>
</span><span id="line-881"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679160908"><span class="annot"><span class="annottext">f :: Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679160908"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-882"></span><span>         </span><span class="annot"><a href="#local-6989586621679160908"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-883"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679160907"><span class="hs-identifier hs-var">checkBorderChars</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679160908"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-884"></span><span>
</span><span id="line-885"></span><span class="hs-comment">-- unquoted identifier followed by an identifier letter</span><span>
</span><span id="line-886"></span><span>
</span><span id="line-887"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-type">Identifier</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Text, Text)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160894"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-888"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679160896"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-var">isIdentifierChar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-889"></span><span>
</span><span id="line-890"></span><span class="hs-comment">-- a quoted identifier using &quot;, followed by a &quot; will fail</span><span>
</span><span id="line-891"></span><span>
</span><span id="line-892"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-type">Identifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160894"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-893"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679160896"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-894"></span><span>
</span><span id="line-895"></span><span class="hs-comment">-- prefixed variable followed by an identifier char will be absorbed</span><span>
</span><span id="line-896"></span><span>
</span><span id="line-897"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-type">PrefixedVariable</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160894"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-898"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679160896"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-var">isIdentifierChar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-899"></span><span>
</span><span id="line-900"></span><span class="hs-comment">-- a positional arg will absorb a following digit</span><span>
</span><span id="line-901"></span><span>
</span><span id="line-902"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PositionalArg"><span class="hs-identifier hs-type">PositionalArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160894"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-903"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679160896"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-904"></span><span>
</span><span id="line-905"></span><span class="hs-comment">-- a string ending with ' followed by a token starting with ' will be absorbed</span><span>
</span><span id="line-906"></span><span>
</span><span id="line-907"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-type">SqlString</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160894"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-908"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679160896"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-909"></span><span>
</span><span id="line-910"></span><span class="hs-comment">-- a number followed by a . will fail or be absorbed</span><span>
</span><span id="line-911"></span><span>
</span><span id="line-912"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-type">SqlNumber</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160894"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-913"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679160896"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-914"></span><span>
</span><span id="line-915"></span><span class="hs-comment">-- a number followed by an e or E will fail or be absorbed</span><span>
</span><span id="line-916"></span><span>
</span><span id="line-917"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-type">SqlNumber</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160894"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-918"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679160896"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679160909"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160909"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160909"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'e'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160909"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'E'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-919"></span><span>
</span><span id="line-920"></span><span class="hs-comment">-- two numbers next to eachother will fail or be absorbed</span><span>
</span><span id="line-921"></span><span>
</span><span id="line-922"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-type">SqlNumber</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160894"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-923"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-type">SqlNumber</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160895"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-924"></span><span>
</span><span id="line-925"></span><span>
</span><span id="line-926"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-927"></span><span>
</span><span id="line-928"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-929"></span><span>    </span><span id="local-6989586621679160910"><span class="annot"><span class="annottext">prettya :: Text
</span><a href="#local-6989586621679160910"><span class="hs-identifier hs-var hs-var">prettya</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Token -&gt; Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160893"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160894"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-930"></span><span>    </span><span id="local-6989586621679160911"><span class="annot"><span class="annottext">prettyb :: Text
</span><a href="#local-6989586621679160911"><span class="hs-identifier hs-var hs-var">prettyb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Token -&gt; Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679160893"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679160895"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-931"></span><span>    </span><span class="hs-comment">-- helper function to run a predicate on the</span><span>
</span><span id="line-932"></span><span>    </span><span class="hs-comment">-- last character of the first token and the first</span><span>
</span><span id="line-933"></span><span>    </span><span class="hs-comment">-- character of the second token</span><span>
</span><span id="line-934"></span><span>    </span><span id="local-6989586621679160907"><span class="annot"><span class="annottext">checkBorderChars :: (Char -&gt; Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679160907"><span class="hs-identifier hs-var hs-var">checkBorderChars</span></a></span></span><span> </span><span id="local-6989586621679160912"><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679160912"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-935"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe (Text, Char)
</span><span class="hs-identifier hs-var">T.unsnoc</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160910"><span class="hs-identifier hs-var">prettya</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe (Char, Text)
</span><span class="hs-identifier hs-var">T.uncons</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160911"><span class="hs-identifier hs-var">prettyb</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-936"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679160915"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160915"><span class="hs-identifier hs-var">la</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160916"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160916"><span class="hs-identifier hs-var">fb</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679160912"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160915"><span class="hs-identifier hs-var">la</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160916"><span class="hs-identifier hs-var">fb</span></a></span><span>
</span><span id="line-937"></span><span>            </span><span class="annot"><span class="annottext">(Maybe (Text, Char), Maybe (Char, Text))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-938"></span><span>    </span><span id="local-6989586621679160896"><span class="annot"><span class="annottext">checkFirstBChar :: (Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679160896"><span class="hs-identifier hs-var hs-var">checkFirstBChar</span></a></span></span><span> </span><span id="local-6989586621679160917"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679160917"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe (Char, Text)
</span><span class="hs-identifier hs-var">T.uncons</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160911"><span class="hs-identifier hs-var">prettyb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-939"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160918"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160918"><span class="hs-identifier hs-var">b'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679160917"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160918"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-940"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Char, Text)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-941"></span><span>    </span><span id="local-6989586621679160905"><span class="annot"><span class="annottext">checkLastAChar :: (Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679160905"><span class="hs-identifier hs-var hs-var">checkLastAChar</span></a></span></span><span> </span><span id="local-6989586621679160919"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679160919"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe (Text, Char)
</span><span class="hs-identifier hs-var">T.unsnoc</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679160910"><span class="hs-identifier hs-var">prettya</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-942"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679160920"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160920"><span class="hs-identifier hs-var">la</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679160919"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160920"><span class="hs-identifier hs-var">la</span></a></span><span>
</span><span id="line-943"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Text, Char)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-944"></span><span>
</span><span id="line-945"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-946"></span><span>
</span><span id="line-947"></span><span class="hs-comment">-- megaparsec stream boilerplate</span><span>
</span><span id="line-948"></span><span>
</span><span id="line-949"></span><span class="annot"><span class="hs-comment">-- | Wrapper to allow using the lexer as input to a megaparsec parser.</span></span><span>
</span><span id="line-950"></span><span class="hs-keyword">data</span><span> </span><span id="SQLStream"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-var">SQLStream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SQLStream"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-var">SQLStream</span></a></span></span><span>
</span><span id="line-951"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="sqlStreamInput"><span class="annot"><span class="annottext">SQLStream -&gt; [Char]
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlStreamInput"><span class="hs-identifier hs-var hs-var">sqlStreamInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-952"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="unSQLStream"><span class="annot"><span class="annottext">SQLStream -&gt; [WithPos Token]
</span><a href="Language.SQL.SimpleSQL.Lex.html#unSQLStream"><span class="hs-identifier hs-var hs-var">unSQLStream</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-type">WithPos</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-953"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-954"></span><span>
</span><span id="line-955"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Stream</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-956"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Token"><span class="annot"><span class="hs-identifier hs-var">Token</span></span></span><span>  </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-type">WithPos</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-957"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tokens"><span class="annot"><span class="hs-identifier hs-var">Tokens</span></span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-type">WithPos</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-958"></span><span>
</span><span id="line-959"></span><span>  </span><span id="local-6989586621679160944"><span class="annot"><span class="annottext">tokenToChunk :: Proxy SQLStream -&gt; Token SQLStream -&gt; Tokens SQLStream
</span><a href="#local-6989586621679160944"><span class="hs-identifier hs-var hs-var hs-var">tokenToChunk</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span id="local-6989586621679160947"><span class="annot"><span class="annottext">Token SQLStream
</span><a href="#local-6989586621679160947"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Token SQLStream
WithPos Token
</span><a href="#local-6989586621679160947"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-960"></span><span>  </span><span id="local-6989586621679160948"><span class="annot"><span class="annottext">tokensToChunk :: Proxy SQLStream -&gt; [Token SQLStream] -&gt; Tokens SQLStream
</span><a href="#local-6989586621679160948"><span class="hs-identifier hs-var hs-var hs-var">tokensToChunk</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span id="local-6989586621679160950"><span class="annot"><span class="annottext">[Token SQLStream]
</span><a href="#local-6989586621679160950"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Token SQLStream]
Tokens SQLStream
</span><a href="#local-6989586621679160950"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-961"></span><span>  </span><span id="local-6989586621679160951"><span class="annot"><span class="annottext">chunkToTokens :: Proxy SQLStream -&gt; Tokens SQLStream -&gt; [Token SQLStream]
</span><a href="#local-6989586621679160951"><span class="hs-identifier hs-var hs-var hs-var">chunkToTokens</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WithPos Token] -&gt; [WithPos Token]
Tokens SQLStream -&gt; [Token SQLStream]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-962"></span><span>  </span><span id="local-6989586621679160954"><span class="annot"><span class="annottext">chunkLength :: Proxy SQLStream -&gt; Tokens SQLStream -&gt; Int
</span><a href="#local-6989586621679160954"><span class="hs-identifier hs-var hs-var hs-var">chunkLength</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WithPos Token] -&gt; Int
Tokens SQLStream -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span>
</span><span id="line-963"></span><span>  </span><span id="local-6989586621679160958"><span class="annot"><span class="annottext">chunkEmpty :: Proxy SQLStream -&gt; Tokens SQLStream -&gt; Bool
</span><a href="#local-6989586621679160958"><span class="hs-identifier hs-var hs-var hs-var">chunkEmpty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WithPos Token] -&gt; Bool
Tokens SQLStream -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span>
</span><span id="line-964"></span><span>  </span><span id="local-6989586621679160963"><span class="annot"><span class="annottext">take1_ :: SQLStream -&gt; Maybe (Token SQLStream, SQLStream)
</span><a href="#local-6989586621679160963"><span class="hs-identifier hs-var hs-var hs-var">take1_</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Token SQLStream, SQLStream)
Maybe (WithPos Token, SQLStream)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-965"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">take1_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span> </span><span id="local-6989586621679160965"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160965"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160966"><span class="annot"><span class="annottext">WithPos Token
</span><a href="#local-6989586621679160966"><span class="hs-identifier hs-var">t</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679160967"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160967"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WithPos Token, SQLStream) -&gt; Maybe (WithPos Token, SQLStream)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-966"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">WithPos Token
</span><a href="#local-6989586621679160966"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-967"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [WithPos Token] -&gt; SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-var">SQLStream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy SQLStream -&gt; NonEmpty (Token SQLStream) -&gt; Int
forall s. VisualStream s =&gt; Proxy s -&gt; NonEmpty (Token s) -&gt; Int
</span><span class="hs-identifier hs-var">tokensLength</span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#pxy"><span class="hs-identifier hs-var">pxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WithPos Token
</span><a href="#local-6989586621679160966"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">WithPos Token -&gt; [WithPos Token] -&gt; NonEmpty (WithPos Token)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">NE.:|</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160965"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160967"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-968"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-969"></span><span>  </span><span id="local-6989586621679160976"><span class="annot"><span class="annottext">takeN_ :: Int -&gt; SQLStream -&gt; Maybe (Tokens SQLStream, SQLStream)
</span><a href="#local-6989586621679160976"><span class="hs-identifier hs-var hs-var hs-var">takeN_</span></a></span></span><span> </span><span id="local-6989586621679160978"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160978"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span> </span><span id="local-6989586621679160979"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160979"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679160980"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160980"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-970"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160978"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([WithPos Token], SQLStream) -&gt; Maybe ([WithPos Token], SQLStream)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [WithPos Token] -&gt; SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-var">SQLStream</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160979"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160980"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-971"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[WithPos Token] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160980"><span class="hs-identifier hs-var">s</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ([WithPos Token], SQLStream)
Maybe (Tokens SQLStream, SQLStream)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-972"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-973"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160981"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160981"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160982"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160982"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [WithPos Token] -&gt; ([WithPos Token], [WithPos Token])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160978"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160980"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-974"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[WithPos Token] -&gt; Maybe (NonEmpty (WithPos Token))
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NE.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160981"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-975"></span><span>          </span><span class="annot"><span class="annottext">Maybe (NonEmpty (WithPos Token))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([WithPos Token], SQLStream) -&gt; Maybe ([WithPos Token], SQLStream)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160981"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [WithPos Token] -&gt; SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-var">SQLStream</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160979"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160982"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-976"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679160985"><span class="annot"><span class="annottext">NonEmpty (WithPos Token)
</span><a href="#local-6989586621679160985"><span class="hs-identifier hs-var">nex</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([WithPos Token], SQLStream) -&gt; Maybe ([WithPos Token], SQLStream)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160981"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [WithPos Token] -&gt; SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-var">SQLStream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy SQLStream -&gt; NonEmpty (Token SQLStream) -&gt; Int
forall s. VisualStream s =&gt; Proxy s -&gt; NonEmpty (Token s) -&gt; Int
</span><span class="hs-identifier hs-var">tokensLength</span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#pxy"><span class="hs-identifier hs-var">pxy</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Token SQLStream)
NonEmpty (WithPos Token)
</span><a href="#local-6989586621679160985"><span class="hs-identifier hs-var">nex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160979"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160982"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-977"></span><span>  </span><span id="local-6989586621679160987"><span class="annot"><span class="annottext">takeWhile_ :: (Token SQLStream -&gt; Bool)
-&gt; SQLStream -&gt; (Tokens SQLStream, SQLStream)
</span><a href="#local-6989586621679160987"><span class="hs-identifier hs-var hs-var hs-var">takeWhile_</span></a></span></span><span> </span><span id="local-6989586621679160989"><span class="annot"><span class="annottext">Token SQLStream -&gt; Bool
</span><a href="#local-6989586621679160989"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span> </span><span id="local-6989586621679160990"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160990"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679160991"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160991"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-978"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160992"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160992"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160993"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160993"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WithPos Token -&gt; Bool)
-&gt; [WithPos Token] -&gt; ([WithPos Token], [WithPos Token])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">DL.span</span></span><span> </span><span class="annot"><span class="annottext">Token SQLStream -&gt; Bool
WithPos Token -&gt; Bool
</span><a href="#local-6989586621679160989"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160991"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-979"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[WithPos Token] -&gt; Maybe (NonEmpty (WithPos Token))
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NE.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160992"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-980"></span><span>      </span><span class="annot"><span class="annottext">Maybe (NonEmpty (WithPos Token))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WithPos Token]
Tokens SQLStream
</span><a href="#local-6989586621679160992"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [WithPos Token] -&gt; SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-var">SQLStream</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160990"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160993"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-981"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679160995"><span class="annot"><span class="annottext">NonEmpty (WithPos Token)
</span><a href="#local-6989586621679160995"><span class="hs-identifier hs-var">nex</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WithPos Token]
Tokens SQLStream
</span><a href="#local-6989586621679160992"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [WithPos Token] -&gt; SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-var">SQLStream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy SQLStream -&gt; NonEmpty (Token SQLStream) -&gt; Int
forall s. VisualStream s =&gt; Proxy s -&gt; NonEmpty (Token s) -&gt; Int
</span><span class="hs-identifier hs-var">tokensLength</span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#pxy"><span class="hs-identifier hs-var">pxy</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Token SQLStream)
NonEmpty (WithPos Token)
</span><a href="#local-6989586621679160995"><span class="hs-identifier hs-var">nex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160990"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679160993"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-982"></span><span>
</span><span id="line-983"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VisualStream</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-984"></span><span>  </span><span id="local-6989586621679161004"><span class="annot"><span class="annottext">showTokens :: Proxy SQLStream -&gt; NonEmpty (Token SQLStream) -&gt; [Char]
</span><a href="#local-6989586621679161004"><span class="hs-identifier hs-var hs-var hs-var">showTokens</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">DL.intercalate</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-985"></span><span>    </span><span class="annot"><span class="annottext">([[Char]] -&gt; [Char])
-&gt; (NonEmpty (WithPos Token) -&gt; [[Char]])
-&gt; NonEmpty (WithPos Token)
-&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty [Char] -&gt; [[Char]]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NE.toList</span></span><span>
</span><span id="line-986"></span><span>    </span><span class="annot"><span class="annottext">(NonEmpty [Char] -&gt; [[Char]])
-&gt; (NonEmpty (WithPos Token) -&gt; NonEmpty [Char])
-&gt; NonEmpty (WithPos Token)
-&gt; [[Char]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(WithPos Token -&gt; [Char])
-&gt; NonEmpty (WithPos Token) -&gt; NonEmpty [Char]
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; [Char]
</span><a href="Language.SQL.SimpleSQL.Lex.html#showMyToken"><span class="hs-identifier hs-var">showMyToken</span></a></span><span> </span><span class="annot"><span class="annottext">(Token -&gt; [Char])
-&gt; (WithPos Token -&gt; Token) -&gt; WithPos Token -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WithPos Token -&gt; Token
forall a. WithPos a -&gt; a
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokenVal"><span class="hs-identifier hs-var">tokenVal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-987"></span><span>  </span><span id="local-6989586621679161013"><span class="annot"><span class="annottext">tokensLength :: Proxy SQLStream -&gt; NonEmpty (Token SQLStream) -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var">tokensLength</span></span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span id="local-6989586621679161014"><span class="annot"><span class="annottext">NonEmpty (Token SQLStream)
</span><a href="#local-6989586621679161014"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty Int -&gt; Int
forall a. Num a =&gt; NonEmpty a -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WithPos Token -&gt; Int
forall a. WithPos a -&gt; Int
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokenLength"><span class="hs-identifier hs-var">tokenLength</span></a></span><span> </span><span class="annot"><span class="annottext">(WithPos Token -&gt; Int) -&gt; NonEmpty (WithPos Token) -&gt; NonEmpty Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Token SQLStream)
NonEmpty (WithPos Token)
</span><a href="#local-6989586621679161014"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-988"></span><span>
</span><span id="line-989"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679161020"><span class="annot"><span class="hs-identifier hs-type">TraversableStream</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-990"></span><span>    </span><span class="hs-comment">-- I have no idea what all this is doing</span><span>
</span><span id="line-991"></span><span>  </span><span id="local-6989586621679161036"><span class="annot"><span class="annottext">reachOffset :: Int -&gt; PosState SQLStream -&gt; (Maybe [Char], PosState SQLStream)
</span><a href="#local-6989586621679161036"><span class="hs-identifier hs-var hs-var hs-var">reachOffset</span></a></span></span><span> </span><span id="local-6989586621679161038"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679161038"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679161039"><span class="annot"><span class="annottext">_x :: PosState SQLStream
</span><a href="#local-6989586621679161039"><span class="hs-identifier hs-var">_x</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.PosState</span></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679161041"><span id="local-6989586621679161042"><span id="local-6989586621679161043"><span id="local-6989586621679161044"><span id="local-6989586621679161045"><span class="annot"><span class="annottext">Int
[Char]
SourcePos
Pos
SQLStream
pstateSourcePos :: forall s. PosState s -&gt; SourcePos
pstateInput :: SQLStream
pstateOffset :: Int
pstateSourcePos :: SourcePos
pstateTabWidth :: Pos
pstateLinePrefix :: [Char]
pstateLinePrefix :: forall s. PosState s -&gt; [Char]
pstateTabWidth :: forall s. PosState s -&gt; Pos
pstateOffset :: forall s. PosState s -&gt; Int
pstateInput :: forall s. PosState s -&gt; s
</span><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-992"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Maybe [Char]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Maybe [Char]) -&gt; [Char] -&gt; Maybe [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161050"><span class="hs-identifier hs-var">actualLine</span></a></span><span>
</span><span id="line-993"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PosState</span></span><span>
</span><span id="line-994"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">pstateInput :: SQLStream
</span><span class="hs-identifier hs-var">pstateInput</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span>
</span><span id="line-995"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sqlStreamInput :: [Char]
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlStreamInput"><span class="hs-identifier hs-var">sqlStreamInput</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161051"><span class="hs-identifier hs-var">postStr</span></a></span><span>
</span><span id="line-996"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">unSQLStream :: [WithPos Token]
</span><a href="Language.SQL.SimpleSQL.Lex.html#unSQLStream"><span class="hs-identifier hs-var">unSQLStream</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679161052"><span class="hs-identifier hs-var">post</span></a></span><span>
</span><span id="line-997"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-998"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pstateOffset :: Int
</span><span class="hs-identifier hs-var">pstateOffset</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679161042"><span class="hs-identifier hs-var">pstateOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679161038"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-999"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pstateSourcePos :: SourcePos
</span><span class="hs-identifier hs-var">pstateSourcePos</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679161054"><span class="hs-identifier hs-var">newSourcePos</span></a></span><span>
</span><span id="line-1000"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pstateTabWidth :: Pos
</span><span class="hs-identifier hs-var">pstateTabWidth</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pos
</span><a href="#local-6989586621679161044"><span class="hs-identifier hs-var">pstateTabWidth</span></a></span><span>
</span><span id="line-1001"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pstateLinePrefix :: [Char]
</span><span class="hs-identifier hs-var">pstateLinePrefix</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161055"><span class="hs-identifier hs-var">prefix</span></a></span><span>
</span><span id="line-1002"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-1003"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-1004"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1005"></span><span>      </span><span id="local-6989586621679161056"><span class="annot"><span class="annottext">maybeitsthefullsource :: [Char]
</span><a href="#local-6989586621679161056"><span class="hs-identifier hs-var hs-var">maybeitsthefullsource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SQLStream -&gt; [Char]
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlStreamInput"><span class="hs-identifier hs-var">sqlStreamInput</span></a></span><span> </span><span class="annot"><span class="annottext">SQLStream
</span><a href="#local-6989586621679161041"><span class="hs-identifier hs-var">pstateInput</span></a></span><span>
</span><span id="line-1006"></span><span>      </span><span id="local-6989586621679161057"><span class="annot"><span class="annottext">targetLineNo :: Int
</span><a href="#local-6989586621679161057"><span class="hs-identifier hs-var hs-var">targetLineNo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pos -&gt; Int
</span><span class="hs-identifier hs-var">M.unPos</span></span><span> </span><span class="annot"><span class="annottext">(Pos -&gt; Int) -&gt; Pos -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SourcePos -&gt; Pos
</span><span class="hs-identifier hs-var">sourceLine</span></span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679161054"><span class="hs-identifier hs-var">newSourcePos</span></a></span><span>
</span><span id="line-1007"></span><span>      </span><span id="local-6989586621679161050"><span class="annot"><span class="annottext">actualLine :: [Char]
</span><a href="#local-6989586621679161050"><span class="hs-identifier hs-var hs-var">actualLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [[Char]] -&gt; [[Char]]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679161057"><span class="hs-identifier hs-var">targetLineNo</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [[Char]]) -&gt; [[Char]] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]]
</span><span class="hs-identifier hs-var">lines</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161056"><span class="hs-identifier hs-var">maybeitsthefullsource</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1008"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679161061"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161061"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[[Char]]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161061"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1009"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&lt;empty line&gt;&quot;</span></span><span>
</span><span id="line-1010"></span><span>      </span><span id="local-6989586621679161055"><span class="annot"><span class="annottext">prefix :: [Char]
</span><a href="#local-6989586621679161055"><span class="hs-identifier hs-var hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1011"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679161062"><span class="hs-identifier hs-var">sameLine</span></a></span><span>
</span><span id="line-1012"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161045"><span class="hs-identifier hs-var">pstateLinePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161063"><span class="hs-identifier hs-var">preLine</span></a></span><span>
</span><span id="line-1013"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161063"><span class="hs-identifier hs-var">preLine</span></a></span><span>
</span><span id="line-1014"></span><span>      </span><span id="local-6989586621679161062"><span class="annot"><span class="annottext">sameLine :: Bool
</span><a href="#local-6989586621679161062"><span class="hs-identifier hs-var hs-var">sameLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourcePos -&gt; Pos
</span><span class="hs-identifier hs-var">sourceLine</span></span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679161054"><span class="hs-identifier hs-var">newSourcePos</span></a></span><span> </span><span class="annot"><span class="annottext">Pos -&gt; Pos -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">SourcePos -&gt; Pos
</span><span class="hs-identifier hs-var">sourceLine</span></span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679161043"><span class="hs-identifier hs-var">pstateSourcePos</span></a></span><span>
</span><span id="line-1015"></span><span>      </span><span id="local-6989586621679161054"><span class="annot"><span class="annottext">newSourcePos :: SourcePos
</span><a href="#local-6989586621679161054"><span class="hs-identifier hs-var hs-var">newSourcePos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1016"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679161052"><span class="hs-identifier hs-var">post</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1017"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SQLStream -&gt; [WithPos Token]
</span><a href="Language.SQL.SimpleSQL.Lex.html#unSQLStream"><span class="hs-identifier hs-var">unSQLStream</span></a></span><span> </span><span class="annot"><span class="annottext">SQLStream
</span><a href="#local-6989586621679161041"><span class="hs-identifier hs-var">pstateInput</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1018"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679161043"><span class="hs-identifier hs-var">pstateSourcePos</span></a></span><span>
</span><span id="line-1019"></span><span>            </span><span id="local-6989586621679161064"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679161064"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WithPos Token -&gt; SourcePos
forall a. WithPos a -&gt; SourcePos
</span><a href="Language.SQL.SimpleSQL.Lex.html#endPos"><span class="hs-identifier hs-var">endPos</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WithPos Token] -&gt; WithPos Token
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679161064"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1020"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679161066"><span class="annot"><span class="annottext">WithPos Token
</span><a href="#local-6989586621679161066"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[WithPos Token]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WithPos Token -&gt; SourcePos
forall a. WithPos a -&gt; SourcePos
</span><a href="Language.SQL.SimpleSQL.Lex.html#startPos"><span class="hs-identifier hs-var">startPos</span></a></span><span> </span><span class="annot"><span class="annottext">WithPos Token
</span><a href="#local-6989586621679161066"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1021"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679161067"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679161067"><span class="hs-identifier hs-var">pre</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161052"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679161052"><span class="hs-identifier hs-var">post</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [WithPos Token] -&gt; ([WithPos Token], [WithPos Token])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679161038"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679161042"><span class="hs-identifier hs-var">pstateOffset</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SQLStream -&gt; [WithPos Token]
</span><a href="Language.SQL.SimpleSQL.Lex.html#unSQLStream"><span class="hs-identifier hs-var">unSQLStream</span></a></span><span> </span><span class="annot"><span class="annottext">SQLStream
</span><a href="#local-6989586621679161041"><span class="hs-identifier hs-var">pstateInput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1022"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679161068"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161068"><span class="hs-identifier hs-var">preStr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161051"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161051"><span class="hs-identifier hs-var">postStr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char] -&gt; ([Char], [Char])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679161069"><span class="hs-identifier hs-var">tokensConsumed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SQLStream -&gt; [Char]
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlStreamInput"><span class="hs-identifier hs-var">sqlStreamInput</span></a></span><span> </span><span class="annot"><span class="annottext">SQLStream
</span><a href="#local-6989586621679161041"><span class="hs-identifier hs-var">pstateInput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1023"></span><span>      </span><span id="local-6989586621679161063"><span class="annot"><span class="annottext">preLine :: [Char]
</span><a href="#local-6989586621679161063"><span class="hs-identifier hs-var hs-var">preLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ShowS
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161068"><span class="hs-identifier hs-var">preStr</span></a></span><span>
</span><span id="line-1024"></span><span>      </span><span id="local-6989586621679161069"><span class="annot"><span class="annottext">tokensConsumed :: Int
</span><a href="#local-6989586621679161069"><span class="hs-identifier hs-var hs-var">tokensConsumed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1025"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[WithPos Token] -&gt; Maybe (NonEmpty (WithPos Token))
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NE.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679161067"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1026"></span><span>          </span><span class="annot"><span class="annottext">Maybe (NonEmpty (WithPos Token))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1027"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679161072"><span class="annot"><span class="annottext">NonEmpty (WithPos Token)
</span><a href="#local-6989586621679161072"><span class="hs-identifier hs-var">nePre</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream -&gt; NonEmpty (Token SQLStream) -&gt; Int
forall s. VisualStream s =&gt; Proxy s -&gt; NonEmpty (Token s) -&gt; Int
</span><span class="hs-identifier hs-var">tokensLength</span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#pxy"><span class="hs-identifier hs-var">pxy</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Token SQLStream)
NonEmpty (WithPos Token)
</span><a href="#local-6989586621679161072"><span class="hs-identifier hs-var">nePre</span></a></span><span>
</span><span id="line-1028"></span><span>
</span><span id="line-1029"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#pxy"><span class="hs-identifier hs-type">pxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span>
</span><span id="line-1030"></span><span id="pxy"><span class="annot"><span class="annottext">pxy :: Proxy SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#pxy"><span class="hs-identifier hs-var hs-var">pxy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-1031"></span><span>
</span><span id="line-1032"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#showMyToken"><span class="hs-identifier hs-type">showMyToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-1033"></span><span class="hs-comment">-- todo: how to do this properly?</span><span>
</span><span id="line-1034"></span><span id="showMyToken"><span class="annot"><span class="annottext">showMyToken :: Token -&gt; [Char]
</span><a href="Language.SQL.SimpleSQL.Lex.html#showMyToken"><span class="hs-identifier hs-var hs-var">showMyToken</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; [Char]) -&gt; (Token -&gt; Text) -&gt; Token -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Token -&gt; Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="Language.SQL.SimpleSQL.Dialect.html#ansi2011"><span class="hs-identifier hs-var">ansi2011</span></a></span><span>
</span><span id="line-1035"></span></pre></body></html>