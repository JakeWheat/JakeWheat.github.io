<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-comment">{-
The parser uses a separate lexer for two reasons:

1. sql syntax is very awkward to parse, the separate lexer makes it
easier to handle this in most places (in some places it makes it
harder or impossible, the fix is to switch to something better than
parsec)

2. using a separate lexer gives a huge speed boost because it reduces
backtracking. (We could get this by making the parsing code a lot more
complex also.)

3. we can test the lexer relatively exhaustively, then even when we
don't do nearly as comprehensive testing on the syntax level, we still
have a relatively high assurance of the low level of bugs. This is
much more difficult to get parity with when testing the syntax parser
directly without the separately testing lexing stage.

TODO:

optimisations:

check for left factor opportunities
check for places where it parses a few substrings from the source,
  then puts them back together with a concatenate of some flavour
  -&gt; this is better if can find a way to parse the entire string
  from the source and lift it in one go into the lexical token
before this is done, a smaller optimisation is when any code matches
  a constant string in the lexer, use that constant string instead
  of the string from the parser, it might make a small difference in
  a few places
maybe every token should carry the exact source as well as any fields
  it's been broken into - so pretty printing is trivial


make the tokenswill print more dialect accurate. Maybe add symbol
  chars and identifier chars to the dialect definition and use them from
  here

start adding negative / different parse dialect tests

add token tables and tests for oracle, sql server
review existing tables

look for refactoring opportunities, especially the token
generation tables in the tests

do some user documentation on lexing, and lexing/dialects

start thinking about a more separated design for the dialect handling

lexing tests are starting to take a really long time, so split the
tests so it is much easier to run all the tests except the lexing
tests which only need to be run when working on the lexer (which
should be relatively uncommon), or doing a commit or finishing off a
series of commits,

start writing the error message tests:
  generate/write a large number of syntax errors
  create a table with the source and the error message
  try to compare some different versions of code to compare the
    quality of the error messages by hand

  get this checked in so improvements and regressions in the error
    message quality can be tracked a little more easily (although it will
    still be manual)

try again to add annotation to the ast

-}</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="annot"><span class="hs-comment">-- | Lexer for SQL.</span></span><span>
</span><span id="line-74"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-75"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards   #-}</span><span>
</span><span id="line-76"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies      #-}</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.SQL.SimpleSQL.Lex</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier">Token</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier">WithPos</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#lexSQL"><span class="hs-identifier">lexSQL</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#lexSQLWithPositions"><span class="hs-identifier">lexSQLWithPositions</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier">prettyToken</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyTokens"><span class="hs-identifier">prettyTokens</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#ParseError"><span class="hs-identifier">ParseError</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyError"><span class="hs-identifier">prettyError</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier">tokenListWillPrintAndLex</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#ansi2011"><span class="hs-identifier">ansi2011</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier">SQLStream</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html"><span class="hs-identifier">Language.SQL.SimpleSQL.Dialect</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier">Dialect</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#ansi2011"><span class="hs-identifier">ansi2011</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Megaparsec</span></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Parsec</span></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">runParser'</span></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">PosState</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">TraversableStream</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">VisualStream</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>    </span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">ParseErrorBundle</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">errorBundlePretty</span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">SourcePos</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">getSourcePos</span></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">getOffset</span></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">pstateSourcePos</span></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">statePosState</span></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">mkPos</span></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">choice</span></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">satisfy</span></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">takeWhileP</span></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">takeWhile1P</span></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-operator">(&lt;?&gt;)</span></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">eof</span></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">many</span></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">try</span></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">option</span></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">notFollowedBy</span></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">manyTill</span></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">anySingle</span></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">lookAhead</span></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Text.Megaparsec</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Megaparsec.Char</span></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">string</span></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">char</span></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Megaparsec.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">initialState</span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DL</span></span><span>
</span><span id="line-138"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-139"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Void</span></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;**&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isAlphaNum</span></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">isAlpha</span></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">isSpace</span></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">isDigit</span></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">void</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">guard</span></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-152"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- syntax</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="annot"><span class="hs-comment">-- | Represents a lexed token</span></span><span>
</span><span id="line-159"></span><span class="hs-keyword">data</span><span> </span><span id="Token"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-var">Token</span></a></span></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-comment">-- | A symbol (in ansi dialect) is one of the following</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-comment">-- * multi char symbols &lt;&gt; \&lt;= \&gt;= != ||</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-comment">-- * single char symbols: * + -  &lt; &gt;  ^ / %  ~ &amp; | ? ( ) [ ] , ; ( )</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="Symbol"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-var">Symbol</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-comment">-- | This is an identifier or keyword. The first field is</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-comment">-- the quotes used, or nothing if no quotes were used. The quotes</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-comment">-- can be &quot; or u&amp; or something dialect specific like []</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Identifier"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-comment">-- | This is a prefixed variable symbol, such as :var, @var or #var</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-comment">-- (only :var is used in ansi dialect)</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PrefixedVariable"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-var">PrefixedVariable</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><span class="hs-comment">-- | This is a positional arg identifier e.g. $1</span></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PositionalArg"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PositionalArg"><span class="hs-identifier hs-var">PositionalArg</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-comment">-- | This is a string literal. The first two fields are the --</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-comment">-- start and end quotes, which are usually both ', but can be</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-comment">-- the character set (one of nNbBxX, or u&amp;, U&amp;), or a dialect</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-comment">-- specific string quoting (such as $$ in postgres)</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SqlString"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-var">SqlString</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-comment">-- | A number literal (integral or otherwise), stored in original format</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-comment">-- unchanged</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SqlNumber"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-var">SqlNumber</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Whitespace, one or more of space, tab or newline.</span></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Whitespace"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Whitespace"><span class="hs-identifier hs-var">Whitespace</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-comment">-- | A commented line using --, contains every character starting with the</span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-comment">-- \'--\' and including the terminating newline character if there is one</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-comment">-- - this will be missing if the last line in the source is a line comment</span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-comment">-- with no trailing newline</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LineComment"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#LineComment"><span class="hs-identifier hs-var">LineComment</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><span class="hs-comment">-- | A block comment, \/* stuff *\/, includes the comment delimiters</span></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="BlockComment"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#BlockComment"><span class="hs-identifier hs-var">BlockComment</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-192"></span><span>      </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679158476"><span id="local-6989586621679158493"><span class="annot"><span class="annottext">Token -&gt; Token -&gt; Bool
(Token -&gt; Token -&gt; Bool) -&gt; (Token -&gt; Token -&gt; Bool) -&gt; Eq Token
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Token -&gt; Token -&gt; Bool
== :: Token -&gt; Token -&gt; Bool
$c/= :: Token -&gt; Token -&gt; Bool
/= :: Token -&gt; Token -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679158498"><span id="local-6989586621679158527"><span id="local-6989586621679158531"><span class="annot"><span class="annottext">Int -&gt; Token -&gt; ShowS
[Token] -&gt; ShowS
Token -&gt; String
(Int -&gt; Token -&gt; ShowS)
-&gt; (Token -&gt; String) -&gt; ([Token] -&gt; ShowS) -&gt; Show Token
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Token -&gt; ShowS
showsPrec :: Int -&gt; Token -&gt; ShowS
$cshow :: Token -&gt; String
show :: Token -&gt; String
$cshowList :: [Token] -&gt; ShowS
showList :: [Token] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679158538"><span id="local-6989586621679158557"><span id="local-6989586621679158561"><span id="local-6989586621679158564"><span id="local-6989586621679158567"><span id="local-6989586621679158570"><span id="local-6989586621679158573"><span class="annot"><span class="annottext">Eq Token
Eq Token =&gt;
(Token -&gt; Token -&gt; Ordering)
-&gt; (Token -&gt; Token -&gt; Bool)
-&gt; (Token -&gt; Token -&gt; Bool)
-&gt; (Token -&gt; Token -&gt; Bool)
-&gt; (Token -&gt; Token -&gt; Bool)
-&gt; (Token -&gt; Token -&gt; Token)
-&gt; (Token -&gt; Token -&gt; Token)
-&gt; Ord Token
Token -&gt; Token -&gt; Bool
Token -&gt; Token -&gt; Ordering
Token -&gt; Token -&gt; Token
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Token -&gt; Token -&gt; Ordering
compare :: Token -&gt; Token -&gt; Ordering
$c&lt; :: Token -&gt; Token -&gt; Bool
&lt; :: Token -&gt; Token -&gt; Bool
$c&lt;= :: Token -&gt; Token -&gt; Bool
&lt;= :: Token -&gt; Token -&gt; Bool
$c&gt; :: Token -&gt; Token -&gt; Bool
&gt; :: Token -&gt; Token -&gt; Bool
$c&gt;= :: Token -&gt; Token -&gt; Bool
&gt;= :: Token -&gt; Token -&gt; Bool
$cmax :: Token -&gt; Token -&gt; Token
max :: Token -&gt; Token -&gt; Token
$cmin :: Token -&gt; Token -&gt; Token
min :: Token -&gt; Token -&gt; Token
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- main api functions</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="annot"><span class="hs-comment">-- | Lex some SQL to a list of tokens.</span></span><span>
</span><span id="line-199"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#lexSQLWithPositions"><span class="hs-identifier hs-type">lexSQLWithPositions</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ dialect of SQL to use</span></span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ filename to use in error messages</span></span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-comment">-- ^ line number and column number of the first character</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-comment">-- in the source to use in error messages</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ the SQL source to lex</span></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-type">WithPos</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-210"></span><span id="lexSQLWithPositions"><span class="annot"><span class="annottext">lexSQLWithPositions :: Dialect
-&gt; Text
-&gt; Maybe (Int, Int)
-&gt; Text
-&gt; Either ParseError [WithPos Token]
</span><a href="Language.SQL.SimpleSQL.Lex.html#lexSQLWithPositions"><span class="hs-identifier hs-var hs-var">lexSQLWithPositions</span></a></span></span><span> </span><span id="local-6989586621679158577"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158577"><span class="hs-identifier hs-var">dialect</span></a></span></span><span> </span><span id="local-6989586621679158578"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158578"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679158579"><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679158579"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679158580"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158580"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; Maybe (Int, Int)
-&gt; Parser [WithPos Token]
-&gt; Text
-&gt; Either ParseError [WithPos Token]
forall a.
Text -&gt; Maybe (Int, Int) -&gt; Parser a -&gt; Text -&gt; Either ParseError a
</span><a href="Language.SQL.SimpleSQL.Lex.html#myParse"><span class="hs-identifier hs-var">myParse</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158578"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679158579"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity (WithPos Token)
-&gt; Parser [WithPos Token]
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT Void Text Identity (WithPos Token)
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlToken"><span class="hs-identifier hs-var">sqlToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158577"><span class="hs-identifier hs-var">dialect</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser [WithPos Token]
-&gt; ParsecT Void Text Identity () -&gt; Parser [WithPos Token]
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *). MonadParsec e s m =&gt; m ()
</span><span class="hs-identifier hs-var">eof</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; String -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
m a -&gt; String -&gt; m a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158580"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="annot"><span class="hs-comment">-- | Lex some SQL to a list of tokens.</span></span><span>
</span><span id="line-214"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#lexSQL"><span class="hs-identifier hs-type">lexSQL</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ dialect of SQL to use</span></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ filename to use in error messages</span></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-comment">-- ^ line number and column number of the first character</span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-comment">-- in the source to use in error messages</span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ the SQL source to lex</span></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-225"></span><span id="lexSQL"><span class="annot"><span class="annottext">lexSQL :: Dialect
-&gt; Text -&gt; Maybe (Int, Int) -&gt; Text -&gt; Either ParseError [Token]
</span><a href="Language.SQL.SimpleSQL.Lex.html#lexSQL"><span class="hs-identifier hs-var hs-var">lexSQL</span></a></span></span><span> </span><span id="local-6989586621679158584"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158584"><span class="hs-identifier hs-var">dialect</span></a></span></span><span> </span><span id="local-6989586621679158585"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158585"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679158586"><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679158586"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679158587"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158587"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><span class="annottext">(WithPos Token -&gt; Token) -&gt; [WithPos Token] -&gt; [Token]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">WithPos Token -&gt; Token
forall a. WithPos a -&gt; a
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokenVal"><span class="hs-identifier hs-var">tokenVal</span></a></span><span> </span><span class="annot"><span class="annottext">([WithPos Token] -&gt; [Token])
-&gt; Either ParseError [WithPos Token] -&gt; Either ParseError [Token]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Dialect
-&gt; Text
-&gt; Maybe (Int, Int)
-&gt; Text
-&gt; Either ParseError [WithPos Token]
</span><a href="Language.SQL.SimpleSQL.Lex.html#lexSQLWithPositions"><span class="hs-identifier hs-var">lexSQLWithPositions</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158584"><span class="hs-identifier hs-var">dialect</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158585"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679158586"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158587"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span id="local-6989586621679157909"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#myParse"><span class="hs-identifier hs-type">myParse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679157909"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679157909"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-229"></span><span id="myParse"><span class="annot"><span class="annottext">myParse :: forall a.
Text -&gt; Maybe (Int, Int) -&gt; Parser a -&gt; Text -&gt; Either ParseError a
</span><a href="Language.SQL.SimpleSQL.Lex.html#myParse"><span class="hs-identifier hs-var hs-var">myParse</span></a></span></span><span> </span><span id="local-6989586621679158592"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158592"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679158593"><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679158593"><span class="hs-identifier hs-var">sp'</span></a></span></span><span> </span><span id="local-6989586621679158594"><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621679158594"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679158595"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158595"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-230"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679158596"><span class="annot"><span class="annottext">sp :: (Int, Int)
</span><a href="#local-6989586621679158596"><span class="hs-identifier hs-var hs-var">sp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Maybe (Int, Int) -&gt; (Int, Int)
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int)
</span><a href="#local-6989586621679158593"><span class="hs-identifier hs-var">sp'</span></a></span><span>
</span><span id="line-231"></span><span>            </span><span id="local-6989586621679158597"><span class="annot"><span class="annottext">ps :: SourcePos
</span><a href="#local-6989586621679158597"><span class="hs-identifier hs-var hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Pos -&gt; Pos -&gt; SourcePos
</span><span class="hs-identifier hs-var">SourcePos</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158592"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Pos
</span><span class="hs-identifier hs-var">mkPos</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Pos) -&gt; Int -&gt; Pos
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679158596"><span class="hs-identifier hs-var">sp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Pos
</span><span class="hs-identifier hs-var">mkPos</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Pos) -&gt; Int -&gt; Pos
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679158596"><span class="hs-identifier hs-var">sp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>            </span><span id="local-6989586621679158602"><span class="annot"><span class="annottext">is :: State Text Void
</span><a href="#local-6989586621679158602"><span class="hs-identifier hs-var hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text -&gt; State Text Void
forall s e. String -&gt; s -&gt; State s e
</span><span class="hs-identifier hs-var">initialState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158592"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158595"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-233"></span><span>            </span><span id="local-6989586621679158603"><span class="annot"><span class="annottext">sps :: PosState Text
</span><a href="#local-6989586621679158603"><span class="hs-identifier hs-var hs-var">sps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State Text Void -&gt; PosState Text
forall s e. State s e -&gt; PosState s
</span><span class="hs-identifier hs-var">statePosState</span></span><span> </span><span class="annot"><span class="annottext">State Text Void
</span><a href="#local-6989586621679158602"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span class="annot"><span class="hs-identifier hs-var">pstateSourcePos</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679158597"><span class="hs-identifier hs-type">ps</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-234"></span><span>            </span><span id="local-6989586621679158604"><span class="annot"><span class="annottext">is' :: State Text Void
</span><a href="#local-6989586621679158604"><span class="hs-identifier hs-var hs-var">is'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State Text Void
</span><a href="#local-6989586621679158602"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="hs-identifier hs-var">statePosState</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679158603"><span class="hs-identifier hs-type">sps</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-235"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(State Text Void, Either ParseError a) -&gt; Either ParseError a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((State Text Void, Either ParseError a) -&gt; Either ParseError a)
-&gt; (State Text Void, Either ParseError a) -&gt; Either ParseError a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parser a
-&gt; State Text Void -&gt; (State Text Void, Either ParseError a)
forall e s a.
Parsec e s a
-&gt; State s e -&gt; (State s e, Either (ParseErrorBundle s e) a)
</span><span class="hs-identifier hs-var">runParser'</span></span><span> </span><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621679158594"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">State Text Void
</span><a href="#local-6989586621679158604"><span class="hs-identifier hs-var">is'</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyError"><span class="hs-identifier hs-type">prettyError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#ParseError"><span class="hs-identifier hs-type">ParseError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-238"></span><span id="prettyError"><span class="annot"><span class="annottext">prettyError :: ParseError -&gt; Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyError"><span class="hs-identifier hs-var hs-var">prettyError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; (ParseError -&gt; String) -&gt; ParseError -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParseError -&gt; String
forall s e.
(VisualStream s, TraversableStream s, ShowErrorComponent e) =&gt;
ParseErrorBundle s e -&gt; String
</span><span class="hs-identifier hs-var">errorBundlePretty</span></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">-- parsing boilerplate</span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-keyword">type</span><span> </span><span id="ParseError"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#ParseError"><span class="hs-identifier hs-var">ParseError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ParseErrorBundle</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-keyword">type</span><span> </span><span id="Parser"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-var">Parser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parsec</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">-- | Positional information added to tokens to preserve source positions</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- for the parser</span><span>
</span><span id="line-250"></span><span class="hs-keyword">data</span><span> </span><span id="WithPos"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-var">WithPos</span></a></span></span><span> </span><span id="local-6989586621679157924"><span class="annot"><a href="#local-6989586621679157924"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="WithPos"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-var">WithPos</span></a></span></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="startPos"><span class="annot"><span class="annottext">forall a. WithPos a -&gt; SourcePos
</span><a href="Language.SQL.SimpleSQL.Lex.html#startPos"><span class="hs-identifier hs-var hs-var">startPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SourcePos</span></span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="endPos"><span class="annot"><span class="annottext">forall a. WithPos a -&gt; SourcePos
</span><a href="Language.SQL.SimpleSQL.Lex.html#endPos"><span class="hs-identifier hs-var hs-var">endPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SourcePos</span></span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tokenLength"><span class="annot"><span class="annottext">forall a. WithPos a -&gt; Int
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokenLength"><span class="hs-identifier hs-var hs-var">tokenLength</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tokenVal"><span class="annot"><span class="annottext">forall a. WithPos a -&gt; a
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokenVal"><span class="hs-identifier hs-var hs-var">tokenVal</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679157924"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679158613"><span id="local-6989586621679158620"><span class="annot"><span class="annottext">WithPos a -&gt; WithPos a -&gt; Bool
(WithPos a -&gt; WithPos a -&gt; Bool)
-&gt; (WithPos a -&gt; WithPos a -&gt; Bool) -&gt; Eq (WithPos a)
forall a. Eq a =&gt; WithPos a -&gt; WithPos a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a. Eq a =&gt; WithPos a -&gt; WithPos a -&gt; Bool
== :: WithPos a -&gt; WithPos a -&gt; Bool
$c/= :: forall a. Eq a =&gt; WithPos a -&gt; WithPos a -&gt; Bool
/= :: WithPos a -&gt; WithPos a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679158628"><span id="local-6989586621679158635"><span id="local-6989586621679158641"><span id="local-6989586621679158645"><span id="local-6989586621679158648"><span id="local-6989586621679158651"><span id="local-6989586621679158654"><span class="annot"><span class="annottext">Eq (WithPos a)
Eq (WithPos a) =&gt;
(WithPos a -&gt; WithPos a -&gt; Ordering)
-&gt; (WithPos a -&gt; WithPos a -&gt; Bool)
-&gt; (WithPos a -&gt; WithPos a -&gt; Bool)
-&gt; (WithPos a -&gt; WithPos a -&gt; Bool)
-&gt; (WithPos a -&gt; WithPos a -&gt; Bool)
-&gt; (WithPos a -&gt; WithPos a -&gt; WithPos a)
-&gt; (WithPos a -&gt; WithPos a -&gt; WithPos a)
-&gt; Ord (WithPos a)
WithPos a -&gt; WithPos a -&gt; Bool
WithPos a -&gt; WithPos a -&gt; Ordering
WithPos a -&gt; WithPos a -&gt; WithPos a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. Ord a =&gt; Eq (WithPos a)
forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; Bool
forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; Ordering
forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; WithPos a
$ccompare :: forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; Ordering
compare :: WithPos a -&gt; WithPos a -&gt; Ordering
$c&lt; :: forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; Bool
&lt; :: WithPos a -&gt; WithPos a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; Bool
&lt;= :: WithPos a -&gt; WithPos a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; Bool
&gt; :: WithPos a -&gt; WithPos a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; Bool
&gt;= :: WithPos a -&gt; WithPos a -&gt; Bool
$cmax :: forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; WithPos a
max :: WithPos a -&gt; WithPos a -&gt; WithPos a
$cmin :: forall a. Ord a =&gt; WithPos a -&gt; WithPos a -&gt; WithPos a
min :: WithPos a -&gt; WithPos a -&gt; WithPos a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679158659"><span id="local-6989586621679158667"><span id="local-6989586621679158671"><span class="annot"><span class="annottext">Int -&gt; WithPos a -&gt; ShowS
[WithPos a] -&gt; ShowS
WithPos a -&gt; String
(Int -&gt; WithPos a -&gt; ShowS)
-&gt; (WithPos a -&gt; String)
-&gt; ([WithPos a] -&gt; ShowS)
-&gt; Show (WithPos a)
forall a. Show a =&gt; Int -&gt; WithPos a -&gt; ShowS
forall a. Show a =&gt; [WithPos a] -&gt; ShowS
forall a. Show a =&gt; WithPos a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; WithPos a -&gt; ShowS
showsPrec :: Int -&gt; WithPos a -&gt; ShowS
$cshow :: forall a. Show a =&gt; WithPos a -&gt; String
show :: WithPos a -&gt; String
$cshowList :: forall a. Show a =&gt; [WithPos a] -&gt; ShowS
showList :: [WithPos a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-comment">-- pretty print</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">-- | Pretty printing, if you lex a bunch of tokens, then pretty</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- print them, should should get back exactly the same string</span><span>
</span><span id="line-263"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-type">prettyToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-264"></span><span id="prettyToken"><span class="annot"><span class="annottext">prettyToken :: Dialect -&gt; Token -&gt; Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var hs-var">prettyToken</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span id="local-6989586621679158673"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158673"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158673"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-265"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-type">Identifier</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Text, Text)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679158674"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158674"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158674"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-266"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-type">Identifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679158675"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158675"><span class="hs-identifier hs-var">q1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679158676"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158676"><span class="hs-identifier hs-var">q2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679158677"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158677"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158675"><span class="hs-identifier hs-var">q1</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158677"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158676"><span class="hs-identifier hs-var">q2</span></a></span><span>
</span><span id="line-267"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-type">PrefixedVariable</span></a></span><span> </span><span id="local-6989586621679158678"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679158678"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679158679"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158679"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.cons</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679158678"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158679"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-268"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PositionalArg"><span class="hs-identifier hs-type">PositionalArg</span></a></span><span> </span><span id="local-6989586621679158681"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158681"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.cons</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'$'</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158681"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-269"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-type">SqlString</span></a></span><span> </span><span id="local-6989586621679158683"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158683"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679158684"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158684"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679158685"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158685"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158683"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158685"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158684"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-270"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-type">SqlNumber</span></a></span><span> </span><span id="local-6989586621679158686"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158686"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158686"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-271"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Whitespace"><span class="hs-identifier hs-type">Whitespace</span></a></span><span> </span><span id="local-6989586621679158687"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158687"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158687"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-272"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#LineComment"><span class="hs-identifier hs-type">LineComment</span></a></span><span> </span><span id="local-6989586621679158688"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158688"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158688"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-273"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#BlockComment"><span class="hs-identifier hs-type">BlockComment</span></a></span><span> </span><span id="local-6989586621679158689"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158689"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158689"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prettyTokens"><span class="hs-identifier hs-type">prettyTokens</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-276"></span><span id="prettyTokens"><span class="annot"><span class="annottext">prettyTokens :: Dialect -&gt; [Token] -&gt; Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyTokens"><span class="hs-identifier hs-var hs-var">prettyTokens</span></a></span></span><span> </span><span id="local-6989586621679158690"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158690"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679158691"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679158691"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.concat</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Text) -&gt; [Text] -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Token -&gt; Text) -&gt; [Token] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Token -&gt; Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158690"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679158691"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-comment">-- token parsers</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="annot"><span class="hs-comment">-- | parser for a sql token</span></span><span>
</span><span id="line-283"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#sqlToken"><span class="hs-identifier hs-type">sqlToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-type">WithPos</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span id="sqlToken"><span class="annot"><span class="annottext">sqlToken :: Dialect -&gt; ParsecT Void Text Identity (WithPos Token)
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlToken"><span class="hs-identifier hs-var hs-var">sqlToken</span></a></span></span><span> </span><span id="local-6989586621679158693"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158693"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-comment">-- possibly there's a more efficient way of doing the source positions?</span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621679158694"><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679158694"><span class="hs-identifier hs-var">sp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity SourcePos
forall s e (m :: * -&gt; *).
(TraversableStream s, MonadParsec e s m) =&gt;
m SourcePos
</span><span class="hs-identifier hs-var">getSourcePos</span></span><span>
</span><span id="line-287"></span><span>    </span><span id="local-6989586621679158695"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158695"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Int
forall e s (m :: * -&gt; *). MonadParsec e s m =&gt; m Int
</span><span class="hs-identifier hs-var">getOffset</span></span><span>
</span><span id="line-288"></span><span>    </span><span id="local-6989586621679158696"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679158696"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity Token]
-&gt; ParsecT Void Text Identity Token
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-289"></span><span>         </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlString"><span class="hs-identifier hs-var">sqlString</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158693"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-290"></span><span>         </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifier"><span class="hs-identifier hs-var">identifier</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158693"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-291"></span><span>         </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#lineComment"><span class="hs-identifier hs-var">lineComment</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158693"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-292"></span><span>         </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#blockComment"><span class="hs-identifier hs-var">blockComment</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158693"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-293"></span><span>         </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlNumber"><span class="hs-identifier hs-var">sqlNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158693"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-294"></span><span>         </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#positionalArg"><span class="hs-identifier hs-var">positionalArg</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158693"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-295"></span><span>         </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#dontParseEndBlockComment"><span class="hs-identifier hs-var">dontParseEndBlockComment</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158693"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-296"></span><span>         </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#prefixedVariable"><span class="hs-identifier hs-var">prefixedVariable</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158693"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-297"></span><span>         </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158693"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-298"></span><span>         </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlWhitespace"><span class="hs-identifier hs-var">sqlWhitespace</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158693"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-299"></span><span>    </span><span id="local-6989586621679158707"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158707"><span class="hs-identifier hs-var">off1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Int
forall e s (m :: * -&gt; *). MonadParsec e s m =&gt; m Int
</span><span class="hs-identifier hs-var">getOffset</span></span><span>
</span><span id="line-300"></span><span>    </span><span id="local-6989586621679158708"><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679158708"><span class="hs-identifier hs-var">ep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity SourcePos
forall s e (m :: * -&gt; *).
(TraversableStream s, MonadParsec e s m) =&gt;
m SourcePos
</span><span class="hs-identifier hs-var">getSourcePos</span></span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><span class="annottext">WithPos Token -&gt; ParsecT Void Text Identity (WithPos Token)
forall a. a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(WithPos Token -&gt; ParsecT Void Text Identity (WithPos Token))
-&gt; WithPos Token -&gt; ParsecT Void Text Identity (WithPos Token)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SourcePos -&gt; SourcePos -&gt; Int -&gt; Token -&gt; WithPos Token
forall a. SourcePos -&gt; SourcePos -&gt; Int -&gt; a -&gt; WithPos a
</span><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-var">WithPos</span></a></span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679158694"><span class="hs-identifier hs-var">sp</span></a></span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679158708"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158707"><span class="hs-identifier hs-var">off1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158695"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679158696"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (WithPos Token)
-&gt; String -&gt; ParsecT Void Text Identity (WithPos Token)
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
m a -&gt; String -&gt; m a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;valid lexical token&quot;</span></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">{-
Parse a SQL string. Examples:

'basic string'
'string with '' a quote'
n'international text'
b'binary string'
x'hexidecimal string'
-}</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#sqlString"><span class="hs-identifier hs-type">sqlString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-316"></span><span id="sqlString"><span class="annot"><span class="annottext">sqlString :: Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlString"><span class="hs-identifier hs-var hs-var">sqlString</span></a></span></span><span> </span><span id="local-6989586621679158709"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158709"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158710"><span class="hs-identifier hs-var">dollarString</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Token
-&gt; ParsecT Void Text Identity Token
-&gt; ParsecT Void Text Identity Token
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158711"><span class="hs-identifier hs-var">csString</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Token
-&gt; ParsecT Void Text Identity Token
-&gt; ParsecT Void Text Identity Token
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158712"><span class="hs-identifier hs-var">normalString</span></a></span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-318"></span><span>    </span><span id="local-6989586621679158710"><span class="annot"><span class="annottext">dollarString :: ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158710"><span class="hs-identifier hs-var hs-var">dollarString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-319"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; ParsecT Void Text Identity ())
-&gt; Bool -&gt; ParsecT Void Text Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diDollarString"><span class="hs-identifier hs-var">diDollarString</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158709"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-320"></span><span>        </span><span class="hs-comment">-- use try because of ambiguity with symbols and with</span><span>
</span><span id="line-321"></span><span>        </span><span class="hs-comment">-- positional arg</span><span>
</span><span id="line-322"></span><span>        </span><span id="local-6989586621679158714"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158714"><span class="hs-identifier hs-var">delim</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679158715"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158715"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;$&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158715"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;$&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>                 </span><span class="annot"><span class="annottext">(Text -&gt; Text)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text -&gt; ParsecT Void Text Identity Text
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'$'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall (m :: * -&gt; *) a. Alternative m =&gt; a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var">identifierString</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'$'</span></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-var">SqlString</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158714"><span class="hs-identifier hs-var">delim</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158714"><span class="hs-identifier hs-var">delim</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token) -&gt; (String -&gt; Text) -&gt; String -&gt; Token
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Token)
-&gt; ParsecT Void Text Identity String
-&gt; ParsecT Void Text Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity String
forall (m :: * -&gt; *) a end. MonadPlus m =&gt; m a -&gt; m end -&gt; m [a]
</span><span class="hs-identifier hs-var">manyTill</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *). MonadParsec e s m =&gt; m (Token s)
</span><span class="hs-identifier hs-var">anySingle</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity (Tokens Text)
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity (Tokens Text)
 -&gt; ParsecT Void Text Identity (Tokens Text))
-&gt; ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity (Tokens Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
Text
</span><a href="#local-6989586621679158714"><span class="hs-identifier hs-var">delim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>    </span><span id="local-6989586621679158712"><span class="annot"><span class="annottext">normalString :: ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158712"><span class="hs-identifier hs-var hs-var">normalString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-var">SqlString</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'\''</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Text -&gt; ParsecT Void Text Identity Text
forall {s} {m :: * -&gt; *} {e}.
(Token s ~ Char, Tokens s ~ Text, MonadParsec e s m) =&gt;
Bool -&gt; Text -&gt; m Text
</span><a href="#local-6989586621679158744"><span class="hs-identifier hs-var">normalStringSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>    </span><span id="local-6989586621679158744"><span class="annot"><span class="annottext">normalStringSuffix :: Bool -&gt; Text -&gt; m Text
</span><a href="#local-6989586621679158744"><span class="hs-identifier hs-var hs-var">normalStringSuffix</span></a></span></span><span> </span><span id="local-6989586621679158808"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679158808"><span class="hs-identifier hs-var">allowBackslash</span></a></span></span><span> </span><span id="local-6989586621679158809"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158809"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-327"></span><span>        </span><span id="local-6989586621679158810"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158810"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe String -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhileP</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">((Token s -&gt; Bool) -&gt; m (Tokens s))
-&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679158808"><span class="hs-identifier hs-var">allowBackslash</span></a></span><span>
</span><span id="line-328"></span><span>                                  </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#notElemChar"><span class="hs-operator hs-var">`notElemChar`</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;'\\&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>                                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token s -&gt; Token s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
Token s
</span><span class="hs-char">'\''</span></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>        </span><span class="hs-comment">-- deal with '' or \' as literal quote character</span><span>
</span><span id="line-331"></span><span>        </span><span class="annot"><span class="annottext">[m Text] -&gt; m Text
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="hs-keyword">do</span><span>
</span><span id="line-332"></span><span>                </span><span id="local-6989586621679158813"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158813"><span class="hs-identifier hs-var">ctu</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[m Text] -&gt; m Text
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;''&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; m (Tokens s) -&gt; m Text
forall a b. a -&gt; m b -&gt; m a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">m (Tokens s) -&gt; m (Tokens s)
forall a. m a -&gt; m a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens s -&gt; m (Tokens s)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens s
</span><span class="hs-string">&quot;''&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>                              </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\\'&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; m (Tokens s) -&gt; m Text
forall a b. a -&gt; m b -&gt; m a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Tokens s -&gt; m (Tokens s)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens s
</span><span class="hs-string">&quot;\\'&quot;</span></span><span>
</span><span id="line-334"></span><span>                              </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\\&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; m Char -&gt; m Text
forall a b. a -&gt; m b -&gt; m a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token s -&gt; m (Token s)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token s
</span><span class="hs-char">'\\'</span></span><span class="hs-special">]</span><span>
</span><span id="line-335"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Text -&gt; m Text
</span><a href="#local-6989586621679158744"><span class="hs-identifier hs-var">normalStringSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679158808"><span class="hs-identifier hs-var">allowBackslash</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m Text) -&gt; Text -&gt; m Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158809"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158810"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158813"><span class="hs-identifier hs-var">ctu</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-336"></span><span>               </span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158809"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158810"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Text -&gt; m Char -&gt; m Text
forall a b. a -&gt; m b -&gt; m a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token s -&gt; m (Token s)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token s
</span><span class="hs-char">'\''</span></span><span class="hs-special">]</span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-comment">-- try is used to to avoid conflicts with</span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-comment">-- identifiers which can start with n,b,x,u</span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-comment">-- once we read the quote type and the starting '</span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-comment">-- then we commit to a string</span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-comment">-- it's possible that this will reject some valid syntax</span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-comment">-- but only pathalogical stuff, and I think the improved</span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-comment">-- error messages and user predictability make it a good</span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-comment">-- pragmatic choice</span><span>
</span><span id="line-345"></span><span>    </span><span id="local-6989586621679158711"><span class="annot"><span class="annottext">csString :: ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158711"><span class="hs-identifier hs-var hs-var">csString</span></a></span></span><span>
</span><span id="line-346"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diEString"><span class="hs-identifier hs-var">diEString</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158709"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-347"></span><span>        </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity Token]
-&gt; ParsecT Void Text Identity Token
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-var">SqlString</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text -&gt; Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity (Text -&gt; Text -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text -&gt; ParsecT Void Text Identity Text
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
Text
</span><span class="hs-string">&quot;e'&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
Text
</span><span class="hs-string">&quot;E'&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>                          </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity (Text -&gt; Token)
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity Text
forall a. a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Token
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Text -&gt; ParsecT Void Text Identity Text
forall {s} {m :: * -&gt; *} {e}.
(Token s ~ Char, Tokens s ~ Text, MonadParsec e s m) =&gt;
Bool -&gt; Text -&gt; m Text
</span><a href="#local-6989586621679158744"><span class="hs-identifier hs-var">normalStringSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-349"></span><span>               </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158816"><span class="hs-identifier hs-var">csString'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-350"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158816"><span class="hs-identifier hs-var">csString'</span></a></span><span>
</span><span id="line-351"></span><span>    </span><span id="local-6989586621679158816"><span class="annot"><span class="annottext">csString' :: ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158816"><span class="hs-identifier hs-var hs-var">csString'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-var">SqlString</span></a></span><span>
</span><span id="line-352"></span><span>                </span><span class="annot"><span class="annottext">(Text -&gt; Text -&gt; Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity (Text -&gt; Text -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text -&gt; ParsecT Void Text Identity Text
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="#local-6989586621679158829"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-353"></span><span>                </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity (Text -&gt; Token)
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity Text
forall a. a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;'&quot;</span></span><span>
</span><span id="line-354"></span><span>                </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Token
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Text -&gt; ParsecT Void Text Identity Text
forall {s} {m :: * -&gt; *} {e}.
(Token s ~ Char, Tokens s ~ Text, MonadParsec e s m) =&gt;
Bool -&gt; Text -&gt; m Text
</span><a href="#local-6989586621679158744"><span class="hs-identifier hs-var">normalStringSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-355"></span><span>    </span><span id="local-6989586621679158835"><span class="annot"><span class="annottext">csPrefixes :: [Text]
</span><a href="#local-6989586621679158835"><span class="hs-identifier hs-var hs-var">csPrefixes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Text) -&gt; String -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-operator hs-var">`T.cons`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;'&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nNbBxX&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; [Text] -&gt; [Text]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;u&amp;'&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;U&amp;'&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-356"></span><span>    </span><span class="annot"><a href="#local-6989586621679158829"><span class="hs-identifier hs-type">cs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-357"></span><span>    </span><span id="local-6989586621679158829"><span class="annot"><span class="annottext">cs :: ParsecT Void Text Identity Text
</span><a href="#local-6989586621679158829"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity Text]
-&gt; ParsecT Void Text Identity Text
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="annot"><span class="annottext">([ParsecT Void Text Identity Text]
 -&gt; ParsecT Void Text Identity Text)
-&gt; [ParsecT Void Text Identity Text]
-&gt; ParsecT Void Text Identity Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ParsecT Void Text Identity Text)
-&gt; [Text] -&gt; [ParsecT Void Text Identity Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
Text -&gt; ParsecT Void Text Identity Text
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679158835"><span class="hs-identifier hs-var">csPrefixes</span></a></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-comment">{-
Parses identifiers:

simple_identifier_23
u&amp;&quot;unicode quoted identifier&quot;
&quot;quoted identifier&quot;
&quot;quoted identifier &quot;&quot; with double quote char&quot;
`mysql quoted identifier`
-}</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#identifier"><span class="hs-identifier hs-type">identifier</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-372"></span><span id="identifier"><span class="annot"><span class="annottext">identifier :: Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifier"><span class="hs-identifier hs-var hs-var">identifier</span></a></span></span><span> </span><span id="local-6989586621679158836"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158836"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-373"></span><span>    </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity Token]
-&gt; ParsecT Void Text Identity Token
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158837"><span class="hs-identifier hs-var">quotedIden</span></a></span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158838"><span class="hs-identifier hs-var">unicodeQuotedIden</span></a></span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158839"><span class="hs-identifier hs-var">regularIden</span></a></span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diBackquotedIden"><span class="hs-identifier hs-var">diBackquotedIden</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158836"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity Token
-&gt; ParsecT Void Text Identity Token
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158841"><span class="hs-identifier hs-var">mySqlQuotedIden</span></a></span><span>
</span><span id="line-378"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diSquareBracketQuotedIden"><span class="hs-identifier hs-var">diSquareBracketQuotedIden</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679158836"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity Token
-&gt; ParsecT Void Text Identity Token
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158843"><span class="hs-identifier hs-var">sqlServerQuotedIden</span></a></span><span>
</span><span id="line-379"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-381"></span><span>    </span><span id="local-6989586621679158839"><span class="annot"><span class="annottext">regularIden :: ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158839"><span class="hs-identifier hs-var hs-var">regularIden</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Text, Text) -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Text, Text)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var">identifierString</span></a></span><span>
</span><span id="line-382"></span><span>    </span><span id="local-6989586621679158837"><span class="annot"><span class="annottext">quotedIden :: ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158837"><span class="hs-identifier hs-var hs-var">quotedIden</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Text, Text) -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text, Text) -&gt; Maybe (Text, Text)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="#local-6989586621679158845"><span class="hs-identifier hs-var">qidenPart</span></a></span><span>
</span><span id="line-383"></span><span>    </span><span id="local-6989586621679158841"><span class="annot"><span class="annottext">mySqlQuotedIden :: ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158841"><span class="hs-identifier hs-var hs-var">mySqlQuotedIden</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Text, Text) -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text, Text) -&gt; Maybe (Text, Text)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;`&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;`&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>                      </span><span class="annot"><span class="annottext">(Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'`'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe String -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhile1P</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; Token Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'`'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'`'</span></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>    </span><span id="local-6989586621679158843"><span class="annot"><span class="annottext">sqlServerQuotedIden :: ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158843"><span class="hs-identifier hs-var hs-var">sqlServerQuotedIden</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Text, Text) -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text, Text) -&gt; Maybe (Text, Text)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;[&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;]&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>                          </span><span class="annot"><span class="annottext">(Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'['</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe String -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhile1P</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#notElemChar"><span class="hs-operator hs-var">`notElemChar`</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[]&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">']'</span></span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>    </span><span class="hs-comment">-- try is used here to avoid a conflict with identifiers</span><span>
</span><span id="line-388"></span><span>    </span><span class="hs-comment">-- and quoted strings which also start with a 'u'</span><span>
</span><span id="line-389"></span><span>    </span><span id="local-6989586621679158838"><span class="annot"><span class="annottext">unicodeQuotedIden :: ParsecT Void Text Identity Token
</span><a href="#local-6989586621679158838"><span class="hs-identifier hs-var hs-var">unicodeQuotedIden</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Text, Text) -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-var">Identifier</span></a></span><span>
</span><span id="line-390"></span><span>                        </span><span class="annot"><span class="annottext">(Maybe (Text, Text) -&gt; Text -&gt; Token)
-&gt; ParsecT Void Text Identity (Maybe (Text, Text))
-&gt; ParsecT Void Text Identity (Text -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Maybe (Text, Text)
forall {b}. IsString b =&gt; Char -&gt; Maybe (Text, b)
</span><a href="#local-6989586621679158903"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Maybe (Text, Text))
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity (Maybe (Text, Text))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;uU&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;&amp;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>                        </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Token
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="#local-6989586621679158845"><span class="hs-identifier hs-var">qidenPart</span></a></span><span>
</span><span id="line-392"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679158903"><span class="annot"><span class="annottext">f :: Char -&gt; Maybe (Text, b)
</span><a href="#local-6989586621679158903"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679158908"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679158908"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text, b) -&gt; Maybe (Text, b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.cons</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679158908"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&amp;\&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>    </span><span id="local-6989586621679158845"><span class="annot"><span class="annottext">qidenPart :: ParsecT Void Text Identity Text
</span><a href="#local-6989586621679158845"><span class="hs-identifier hs-var hs-var">qidenPart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'&quot;'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity Text
forall {s} {m :: * -&gt; *} {e}.
(Token s ~ Char, Tokens s ~ Text, MonadParsec e s m) =&gt;
Text -&gt; m Text
</span><a href="#local-6989586621679158933"><span class="hs-identifier hs-var">qidenSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-394"></span><span>    </span><span id="local-6989586621679158933"><span class="annot"><span class="annottext">qidenSuffix :: Text -&gt; m Text
</span><a href="#local-6989586621679158933"><span class="hs-identifier hs-var hs-var">qidenSuffix</span></a></span></span><span> </span><span id="local-6989586621679158981"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158981"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-395"></span><span>        </span><span id="local-6989586621679158982"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158982"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe String -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhileP</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token s -&gt; Token s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">Char
Token s
</span><span class="hs-char">'&quot;'</span></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>        </span><span class="annot"><span class="annottext">m Char -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(m Char -&gt; m ()) -&gt; m Char -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Token s -&gt; m (Token s)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token s
</span><span class="hs-char">'&quot;'</span></span><span>
</span><span id="line-397"></span><span>        </span><span class="hs-comment">-- deal with &quot;&quot; as literal double quote character</span><span>
</span><span id="line-398"></span><span>        </span><span class="annot"><span class="annottext">[m Text] -&gt; m Text
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="hs-keyword">do</span><span>
</span><span id="line-399"></span><span>                </span><span class="annot"><span class="annottext">m Char -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(m Char -&gt; m ()) -&gt; m Char -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Token s -&gt; m (Token s)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token s
</span><span class="hs-char">'&quot;'</span></span><span>
</span><span id="line-400"></span><span>                </span><span class="annot"><span class="annottext">Text -&gt; m Text
</span><a href="#local-6989586621679158933"><span class="hs-identifier hs-var">qidenSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m Text) -&gt; Text -&gt; m Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158981"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158982"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\&quot;\&quot;&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-401"></span><span>               </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text -&gt; m Text
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m Text) -&gt; Text -&gt; m Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158981"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158982"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-type">identifierString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-404"></span><span id="identifierString"><span class="annot"><span class="annottext">identifierString :: ParsecT Void Text Identity Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var hs-var">identifierString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><span id="line-405"></span><span>    </span><span id="local-6989586621679158983"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679158983"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
(Token s -&gt; Bool) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
Token Text -&gt; Bool
</span><a href="#local-6989586621679158984"><span class="hs-identifier hs-var">isFirstLetter</span></a></span><span>
</span><span id="line-406"></span><span>    </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity Text]
-&gt; ParsecT Void Text Identity Text
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-407"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.cons</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679158983"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe String -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhileP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;identifier char&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
Token Text -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-var">isIdentifierChar</span></a></span><span>
</span><span id="line-408"></span><span>        </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity Text
forall a. a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ParsecT Void Text Identity Text)
-&gt; Text -&gt; ParsecT Void Text Identity Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679158983"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
-&gt; String -&gt; ParsecT Void Text Identity Text
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
m a -&gt; String -&gt; m a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;identifier&quot;</span></span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-410"></span><span>     </span><span id="local-6989586621679158984"><span class="annot"><span class="annottext">isFirstLetter :: Char -&gt; Bool
</span><a href="#local-6989586621679158984"><span class="hs-identifier hs-var hs-var">isFirstLetter</span></a></span></span><span> </span><span id="local-6989586621679158988"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679158988"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679158988"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlpha</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679158988"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-type">isIdentifierChar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-413"></span><span id="isIdentifierChar"><span class="annot"><span class="annottext">isIdentifierChar :: Char -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-var hs-var">isIdentifierChar</span></a></span></span><span> </span><span id="local-6989586621679158990"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679158990"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679158990"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlphaNum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679158990"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#lineComment"><span class="hs-identifier hs-type">lineComment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-418"></span><span id="lineComment"><span class="annot"><span class="annottext">lineComment :: Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#lineComment"><span class="hs-identifier hs-var hs-var">lineComment</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-419"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#string_"><span class="hs-identifier hs-var">string_</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;--&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; String -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
m a -&gt; String -&gt; m a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-420"></span><span>    </span><span id="local-6989586621679158992"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158992"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe String
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe String -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhileP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;non newline character&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; Token Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>    </span><span class="hs-comment">-- can you optionally read the \n to terminate the takewhilep without reparsing it?</span><span>
</span><span id="line-422"></span><span>    </span><span id="local-6989586621679158993"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158993"><span class="hs-identifier hs-var">suf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall (m :: * -&gt; *) a. Alternative m =&gt; a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity Text
forall a b.
a -&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>    </span><span class="annot"><span class="annottext">Token -&gt; ParsecT Void Text Identity Token
forall a. a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Token -&gt; ParsecT Void Text Identity Token)
-&gt; Token -&gt; ParsecT Void Text Identity Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#LineComment"><span class="hs-identifier hs-var">LineComment</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token) -&gt; Text -&gt; Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;--&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158992"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679158993"><span class="hs-identifier hs-var">suf</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="hs-comment">-- TODO: the parser before the switch to megaparsec parsed nested block comments</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- I don't know any dialects that use this, but I think it's useful, if needed,</span><span>
</span><span id="line-429"></span><span class="hs-comment">-- add it back in under a dialect flag?</span><span>
</span><span id="line-430"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#blockComment"><span class="hs-identifier hs-type">blockComment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-431"></span><span id="blockComment"><span class="annot"><span class="annottext">blockComment :: Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#blockComment"><span class="hs-identifier hs-var hs-var">blockComment</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><span id="line-432"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ())
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#string_"><span class="hs-identifier hs-var">string_</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;/*&quot;</span></span><span>
</span><span id="line-433"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#BlockComment"><span class="hs-identifier hs-var">BlockComment</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token) -&gt; ([Text] -&gt; Text) -&gt; [Text] -&gt; Token
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.concat</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Text) -&gt; ([Text] -&gt; [Text]) -&gt; [Text] -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;/*&quot;</span></span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; [Text]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Token)
-&gt; ParsecT Void Text Identity [Text]
-&gt; ParsecT Void Text Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity [Text]
</span><a href="#local-6989586621679158995"><span class="hs-identifier hs-var">more</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Token
-&gt; String -&gt; ParsecT Void Text Identity Token
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
m a -&gt; String -&gt; m a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-434"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-435"></span><span>    </span><span id="local-6989586621679158995"><span class="annot"><span class="annottext">more :: ParsecT Void Text Identity [Tokens Text]
</span><a href="#local-6989586621679158995"><span class="hs-identifier hs-var hs-var">more</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity [Tokens Text]]
-&gt; ParsecT Void Text Identity [Tokens Text]
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-436"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;*/&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Tokens Text]
-&gt; ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity [Tokens Text]
forall a b.
a -&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#string_"><span class="hs-identifier hs-var">string_</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;*/&quot;</span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- comment ended</span><span>
</span><span id="line-437"></span><span>        </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'*'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity [Tokens Text]
-&gt; ParsecT Void Text Identity [Tokens Text]
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;*&quot;</span></span><span class="annot"><span class="annottext">Tokens Text -&gt; [Tokens Text] -&gt; [Tokens Text]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Tokens Text] -&gt; [Tokens Text])
-&gt; ParsecT Void Text Identity [Tokens Text]
-&gt; ParsecT Void Text Identity [Tokens Text]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity [Tokens Text]
</span><a href="#local-6989586621679158995"><span class="hs-identifier hs-var">more</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- comment contains * but this isn't the comment end token</span><span>
</span><span id="line-438"></span><span>        </span><span class="hs-comment">-- not sure if there's an easy optimisation here</span><span>
</span><span id="line-439"></span><span>        </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Tokens Text -&gt; [Tokens Text] -&gt; [Tokens Text])
-&gt; ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity ([Tokens Text] -&gt; [Tokens Text])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe String -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhile1P</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;non comment terminator text&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; Token Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'*'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ([Tokens Text] -&gt; [Tokens Text])
-&gt; ParsecT Void Text Identity [Tokens Text]
-&gt; ParsecT Void Text Identity [Tokens Text]
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity [Tokens Text]
</span><a href="#local-6989586621679158995"><span class="hs-identifier hs-var">more</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="hs-comment">{-
This is to improve user experience: provide an error if we see */
outside a comment. This could potentially break postgres ops with */
in them (which is a stupid thing to do). In other cases, the user
should write * / instead (I can't think of any cases when this would
be valid syntax though).
-}</span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#dontParseEndBlockComment"><span class="hs-identifier hs-type">dontParseEndBlockComment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-450"></span><span id="dontParseEndBlockComment"><span class="annot"><span class="annottext">dontParseEndBlockComment :: Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#dontParseEndBlockComment"><span class="hs-identifier hs-var hs-var">dontParseEndBlockComment</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-451"></span><span>    </span><span class="hs-comment">-- don't use try, then it should commit to the error</span><span>
</span><span id="line-452"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity (Tokens Text)
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;*/&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity Token
-&gt; ParsecT Void Text Identity Token
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT Void Text Identity Token
forall a. String -&gt; ParsecT Void Text Identity a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;comment end without comment start&quot;</span></span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span class="hs-comment">{-
numbers

digits
digits.[digits][e[+-]digits]
[digits].digits[e[+-]digits]
digitse[+-]digits

where digits is one or more decimal digits (0 through 9). At least one
digit must be before or after the decimal point, if one is used. At
least one digit must follow the exponent marker (e), if one is
present. There cannot be any spaces or other characters embedded in
the constant. Note that any leading plus or minus sign is not actually
considered part of the constant; it is an operator applied to the
constant.


algorithm:
either
  parse 1 or more digits
    then an optional dot which isn't two dots
    then optional digits
  or: parse a dot which isn't two dots
    then digits
followed by an optional exponent
-}</span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#sqlNumber"><span class="hs-identifier hs-type">sqlNumber</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-484"></span><span id="sqlNumber"><span class="annot"><span class="annottext">sqlNumber :: Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlNumber"><span class="hs-identifier hs-var hs-var">sqlNumber</span></a></span></span><span> </span><span id="local-6989586621679159014"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159014"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-485"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-var">SqlNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159015"><span class="hs-identifier hs-var">completeNumber</span></a></span><span>
</span><span id="line-486"></span><span>    </span><span class="hs-comment">-- this is for definitely avoiding possibly ambiguous source</span><span>
</span><span id="line-487"></span><span>    </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Token
-&gt; ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity Token
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity ()] -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="hs-comment">-- special case to allow e.g. 1..2</span><span>
</span><span id="line-488"></span><span>               </span><span class="annot"><span class="annottext">Bool -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159014"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>               </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity (Tokens Text)
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">lookAhead</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity (Tokens Text)
 -&gt; ParsecT Void Text Identity (Tokens Text))
-&gt; ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity (Tokens Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity (Tokens Text)
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;..&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; String -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
m a -&gt; String -&gt; m a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>                  </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;eE.&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>              </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;eE.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-493"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-494"></span><span>    </span><span id="local-6989586621679159015"><span class="annot"><span class="annottext">completeNumber :: ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159015"><span class="hs-identifier hs-var hs-var">completeNumber</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-495"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#digits"><span class="hs-identifier hs-var">digits</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity (Text -&gt; Text)
-&gt; ParsecT Void Text Identity Text
forall {f :: * -&gt; *} {b}. Alternative f =&gt; f b -&gt; f (b -&gt; b) -&gt; f b
</span><a href="#local-6989586621679159018"><span class="hs-operator hs-var">&lt;??&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity (Text -&gt; Text)
</span><a href="#local-6989586621679159019"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159020"><span class="hs-identifier hs-var">dot</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Text)
-&gt; ParsecT Void Text Identity (Text -&gt; Text)
-&gt; ParsecT Void Text Identity (Text -&gt; Text)
forall {f :: * -&gt; *} {a} {c}.
Alternative f =&gt;
f (a -&gt; c) -&gt; f (c -&gt; c) -&gt; f (a -&gt; c)
</span><a href="#local-6989586621679159021"><span class="hs-operator hs-var">&lt;??.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity (Text -&gt; Text)
</span><a href="#local-6989586621679159019"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#digits"><span class="hs-identifier hs-var">digits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>      </span><span class="hs-comment">-- try is used in case we read a dot</span><span>
</span><span id="line-497"></span><span>      </span><span class="hs-comment">-- and it isn't part of a number</span><span>
</span><span id="line-498"></span><span>      </span><span class="hs-comment">-- if there are any following digits, then we commit</span><span>
</span><span id="line-499"></span><span>      </span><span class="hs-comment">-- to it being a number and not something else</span><span>
</span><span id="line-500"></span><span>      </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text -&gt; ParsecT Void Text Identity Text
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text -&gt; Text)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity (Text -&gt; Text)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159020"><span class="hs-identifier hs-var">dot</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Text)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#digits"><span class="hs-identifier hs-var">digits</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>      </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity (Text -&gt; Text)
-&gt; ParsecT Void Text Identity Text
forall {f :: * -&gt; *} {b}. Alternative f =&gt; f b -&gt; f (b -&gt; b) -&gt; f b
</span><a href="#local-6989586621679159018"><span class="hs-operator hs-var">&lt;??&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity (Text -&gt; Text)
</span><a href="#local-6989586621679159019"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159022"><span class="hs-identifier hs-var">expon</span></a></span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span>    </span><span class="hs-comment">-- make sure we don't parse two adjacent dots in a number</span><span>
</span><span id="line-504"></span><span>    </span><span class="hs-comment">-- special case for postgresql, we backtrack if we see two adjacent dots</span><span>
</span><span id="line-505"></span><span>    </span><span class="hs-comment">-- to parse 1..2, but in other dialects we commit to the failure</span><span>
</span><span id="line-506"></span><span>    </span><span id="local-6989586621679159020"><span class="annot"><span class="annottext">dot :: ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159020"><span class="hs-identifier hs-var hs-var">dot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679159045"><span class="annot"><span class="annottext">p :: ParsecT Void Text Identity (Tokens Text)
</span><a href="#local-6989586621679159045"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity (Tokens Text)
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'.'</span></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159014"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-508"></span><span>             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text -&gt; ParsecT Void Text Identity Text
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159045"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-509"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159045"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-510"></span><span>    </span><span id="local-6989586621679159022"><span class="annot"><span class="annottext">expon :: ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159022"><span class="hs-identifier hs-var hs-var">expon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.cons</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Text -&gt; Text)
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity (Text -&gt; Text)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;eE&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Text)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159049"><span class="hs-identifier hs-var">sInt</span></a></span><span>
</span><span id="line-511"></span><span>    </span><span id="local-6989586621679159049"><span class="annot"><span class="annottext">sInt :: ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159049"><span class="hs-identifier hs-var hs-var">sInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text -&gt; Text)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity (Text -&gt; Text)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall (m :: * -&gt; *) a. Alternative m =&gt; a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Text)
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+-&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Text)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#digits"><span class="hs-identifier hs-var">digits</span></a></span><span>
</span><span id="line-512"></span><span>    </span><span id="local-6989586621679159019"><span class="annot"><span class="annottext">pp :: ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity (Text -&gt; Text)
</span><a href="#local-6989586621679159019"><span class="hs-identifier hs-var hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
-&gt; (Text -&gt; Text -&gt; Text)
-&gt; ParsecT Void Text Identity (Text -&gt; Text)
forall {f :: * -&gt; *} {a} {a} {c}.
Applicative f =&gt;
f a -&gt; (a -&gt; a -&gt; c) -&gt; f (a -&gt; c)
</span><a href="#local-6989586621679159061"><span class="hs-operator hs-var">&lt;$$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span>    </span><span id="local-6989586621679159070"><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679159070"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679159018"><span class="annot"><span class="annottext">&lt;??&gt; :: f b -&gt; f (b -&gt; b) -&gt; f b
</span><a href="#local-6989586621679159018"><span class="hs-operator hs-var hs-var">&lt;??&gt;</span></a></span></span><span> </span><span id="local-6989586621679159071"><span class="annot"><span class="annottext">f (b -&gt; b)
</span><a href="#local-6989586621679159071"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679159070"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">f b -&gt; f (b -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;**&gt;</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; f (b -&gt; b) -&gt; f (b -&gt; b)
forall (m :: * -&gt; *) a. Alternative m =&gt; a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; b
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">f (b -&gt; b)
</span><a href="#local-6989586621679159071"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-514"></span><span>    </span><span id="local-6989586621679159078"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679159078"><span class="hs-identifier hs-var">pa</span></a></span></span><span> </span><span id="local-6989586621679159061"><span class="annot"><span class="annottext">&lt;$$&gt; :: f a -&gt; (a -&gt; a -&gt; c) -&gt; f (a -&gt; c)
</span><a href="#local-6989586621679159061"><span class="hs-operator hs-var hs-var">&lt;$$&gt;</span></a></span></span><span> </span><span id="local-6989586621679159079"><span class="annot"><span class="annottext">a -&gt; a -&gt; c
</span><a href="#local-6989586621679159079"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679159078"><span class="hs-identifier hs-var">pa</span></a></span><span> </span><span class="annot"><span class="annottext">f a -&gt; f (a -&gt; a -&gt; c) -&gt; f (a -&gt; c)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;**&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; c) -&gt; f (a -&gt; a -&gt; c)
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a -&gt; c) -&gt; a -&gt; a -&gt; c
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; c
</span><a href="#local-6989586621679159079"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>    </span><span id="local-6989586621679159089"><span class="annot"><span class="annottext">f (a -&gt; c)
</span><a href="#local-6989586621679159089"><span class="hs-identifier hs-var">pa</span></a></span></span><span> </span><span id="local-6989586621679159021"><span class="annot"><span class="annottext">&lt;??.&gt; :: f (a -&gt; c) -&gt; f (c -&gt; c) -&gt; f (a -&gt; c)
</span><a href="#local-6989586621679159021"><span class="hs-operator hs-var hs-var">&lt;??.&gt;</span></a></span></span><span> </span><span id="local-6989586621679159090"><span class="annot"><span class="annottext">f (c -&gt; c)
</span><a href="#local-6989586621679159090"><span class="hs-identifier hs-var">pb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-516"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679159092"><span class="annot"><span class="annottext">c :: (a -&gt; a -&gt; c) -&gt; f a -&gt; f (a -&gt; c)
</span><a href="#local-6989586621679159092"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; c) -&gt; f a -&gt; f (a -&gt; c)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">(&lt;$&gt;)</span></span><span> </span><span class="annot"><span class="annottext">((a -&gt; a -&gt; c) -&gt; f a -&gt; f (a -&gt; c))
-&gt; ((a -&gt; a -&gt; c) -&gt; a -&gt; a -&gt; c)
-&gt; (a -&gt; a -&gt; c)
-&gt; f a
-&gt; f (a -&gt; c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; c) -&gt; a -&gt; a -&gt; c
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span>
</span><span id="line-517"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(c -&gt; c) -&gt; (a -&gt; c) -&gt; a -&gt; c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">((c -&gt; c) -&gt; (a -&gt; c) -&gt; a -&gt; c)
-&gt; f (a -&gt; c) -&gt; f ((c -&gt; c) -&gt; a -&gt; c)
forall {a} {a} {c}. (a -&gt; a -&gt; c) -&gt; f a -&gt; f (a -&gt; c)
</span><a href="#local-6989586621679159092"><span class="hs-operator hs-var">`c`</span></a></span><span> </span><span class="annot"><span class="annottext">f (a -&gt; c)
</span><a href="#local-6989586621679159089"><span class="hs-identifier hs-var">pa</span></a></span><span> </span><span class="annot"><span class="annottext">f ((c -&gt; c) -&gt; a -&gt; c) -&gt; f (c -&gt; c) -&gt; f (a -&gt; c)
forall a b. f (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(c -&gt; c) -&gt; f (c -&gt; c) -&gt; f (c -&gt; c)
forall (m :: * -&gt; *) a. Alternative m =&gt; a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; c
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">f (c -&gt; c)
</span><a href="#local-6989586621679159090"><span class="hs-identifier hs-var">pb</span></a></span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#digits"><span class="hs-identifier hs-type">digits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-520"></span><span id="digits"><span class="annot"><span class="annottext">digits :: ParsecT Void Text Identity Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#digits"><span class="hs-identifier hs-var hs-var">digits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe String -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhile1P</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;digit&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
Token Text -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#positionalArg"><span class="hs-identifier hs-type">positionalArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-525"></span><span id="positionalArg"><span class="annot"><span class="annottext">positionalArg :: Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#positionalArg"><span class="hs-identifier hs-var hs-var">positionalArg</span></a></span></span><span> </span><span id="local-6989586621679159093"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159093"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-526"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPositionalArg"><span class="hs-identifier hs-var">diPositionalArg</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159093"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity Token
-&gt; ParsecT Void Text Identity Token
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span>
</span><span id="line-527"></span><span>    </span><span class="hs-comment">-- use try to avoid ambiguities with other syntax which starts with dollar</span><span>
</span><span id="line-528"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#PositionalArg"><span class="hs-identifier hs-var">PositionalArg</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Token)
-&gt; ParsecT Void Text Identity Int
-&gt; ParsecT Void Text Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Int -&gt; ParsecT Void Text Identity Int
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var">char_</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'$'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity Int -&gt; ParsecT Void Text Identity Int
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall a. Read a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int) -&gt; (Text -&gt; String) -&gt; Text -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Int)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#digits"><span class="hs-identifier hs-var">digits</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>
</span><span id="line-530"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="hs-comment">-- todo: I think the try here should read a prefix char, then a single valid</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- identifier char, then commit</span><span>
</span><span id="line-534"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#prefixedVariable"><span class="hs-identifier hs-type">prefixedVariable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-535"></span><span id="prefixedVariable"><span class="annot"><span class="annottext">prefixedVariable :: Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#prefixedVariable"><span class="hs-identifier hs-var hs-var">prefixedVariable</span></a></span></span><span> </span><span id="local-6989586621679159096"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159096"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Token
-&gt; ParsecT Void Text Identity Token
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity Token
 -&gt; ParsecT Void Text Identity Token)
-&gt; ParsecT Void Text Identity Token
-&gt; ParsecT Void Text Identity Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity Token]
-&gt; ParsecT Void Text Identity Token
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-536"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-var">PrefixedVariable</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Text -&gt; Token)
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity (Text -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Token
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var">identifierString</span></a></span><span>
</span><span id="line-537"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diAtIdentifier"><span class="hs-identifier hs-var">diAtIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159096"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity Token
-&gt; ParsecT Void Text Identity Token
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span>
</span><span id="line-538"></span><span>     </span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-var">PrefixedVariable</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Text -&gt; Token)
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity (Text -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'@'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Token
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var">identifierString</span></a></span><span>
</span><span id="line-539"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diHashIdentifier"><span class="hs-identifier hs-var">diHashIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159096"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity Token
-&gt; ParsecT Void Text Identity Token
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span>
</span><span id="line-540"></span><span>     </span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-var">PrefixedVariable</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Text -&gt; Token)
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity (Text -&gt; Token)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'#'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Token
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#identifierString"><span class="hs-identifier hs-var">identifierString</span></a></span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span class="hs-comment">{-
Symbols

A symbol is an operator, or one of the misc symbols which include:
. .. := : :: ( ) ? ; , { } (for odbc)

The postgresql operator syntax allows a huge range of operators
compared with ansi and other dialects
-}</span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#symbol"><span class="hs-identifier hs-type">symbol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-556"></span><span id="symbol"><span class="annot"><span class="annottext">symbol :: Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#symbol"><span class="hs-identifier hs-var hs-var">symbol</span></a></span></span><span> </span><span id="local-6989586621679159099"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159099"><span class="hs-identifier hs-var">d</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-var">Symbol</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity Text]
-&gt; ParsecT Void Text Identity Text
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[ParsecT Void Text Identity Text]]
-&gt; [ParsecT Void Text Identity Text]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-557"></span><span>   </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[ParsecT Void Text Identity (Tokens Text)]
[ParsecT Void Text Identity Text]
</span><a href="#local-6989586621679159101"><span class="hs-identifier hs-var">dots</span></a></span><span>
</span><span id="line-558"></span><span>   </span><span class="hs-special">,</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159099"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-559"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity (Tokens Text)]
[ParsecT Void Text Identity Text]
</span><a href="#local-6989586621679159102"><span class="hs-identifier hs-var">postgresExtraSymbols</span></a></span><span>
</span><span id="line-560"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-561"></span><span>   </span><span class="hs-special">,</span><span class="annot"><span class="annottext">[ParsecT Void Text Identity Text]
</span><a href="#local-6989586621679159103"><span class="hs-identifier hs-var">miscSymbol</span></a></span><span>
</span><span id="line-562"></span><span>   </span><span class="hs-special">,</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diOdbc"><span class="hs-identifier hs-var">diOdbc</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159099"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity (Tokens Text)]
[ParsecT Void Text Identity Text]
</span><a href="#local-6989586621679159105"><span class="hs-identifier hs-var">odbcSymbol</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-563"></span><span>   </span><span class="hs-special">,</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159099"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-564"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity Text]
</span><a href="Language.SQL.SimpleSQL.Lex.html#generalizedPostgresqlOperator"><span class="hs-identifier hs-var">generalizedPostgresqlOperator</span></a></span><span>
</span><span id="line-565"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity Text]
</span><a href="#local-6989586621679159107"><span class="hs-identifier hs-var">basicAnsiOps</span></a></span><span>
</span><span id="line-566"></span><span>   </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-568"></span><span>   </span><span id="local-6989586621679159101"><span class="annot"><span class="annottext">dots :: [ParsecT Void Text Identity (Tokens Text)]
</span><a href="#local-6989586621679159101"><span class="hs-identifier hs-var hs-var">dots</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe String
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe String -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhile1P</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dot&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; Token Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'.'</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-569"></span><span>   </span><span id="local-6989586621679159105"><span class="annot"><span class="annottext">odbcSymbol :: [ParsecT Void Text Identity (Tokens Text)]
</span><a href="#local-6989586621679159105"><span class="hs-identifier hs-var hs-var">odbcSymbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;{&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;}&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-570"></span><span>   </span><span id="local-6989586621679159102"><span class="annot"><span class="annottext">postgresExtraSymbols :: [ParsecT Void Text Identity (Tokens Text)]
</span><a href="#local-6989586621679159102"><span class="hs-identifier hs-var hs-var">postgresExtraSymbols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-571"></span><span>       </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity (Tokens Text)
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;:=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>        </span><span class="hs-comment">-- parse :: and : and avoid allowing ::: or more</span><span>
</span><span id="line-573"></span><span>       </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity (Tokens Text)
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;::&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity (Tokens Text)
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">':'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>       </span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity (Tokens Text)
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; ParsecT Void Text Identity ()
-&gt; ParsecT Void Text Identity (Tokens Text)
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">':'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-575"></span><span>   </span><span id="local-6989586621679159103"><span class="annot"><span class="annottext">miscSymbol :: [ParsecT Void Text Identity Text]
</span><a href="#local-6989586621679159103"><span class="hs-identifier hs-var hs-var">miscSymbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; ParsecT Void Text Identity Text)
-&gt; String -&gt; [ParsecT Void Text Identity Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
Text -&gt; ParsecT Void Text Identity Text
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ParsecT Void Text Identity Text)
-&gt; (Char -&gt; Text) -&gt; Char -&gt; ParsecT Void Text Identity Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; [ParsecT Void Text Identity Text])
-&gt; String -&gt; [ParsecT Void Text Identity Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-576"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-577"></span><span>                    </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diSqlServerSymbols"><span class="hs-identifier hs-var">diSqlServerSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159099"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,;():?&quot;</span></span><span>
</span><span id="line-578"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159099"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[],;()&quot;</span></span><span>
</span><span id="line-579"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[],;():?&quot;</span></span><span>
</span><span id="line-580"></span><span>
</span><span id="line-581"></span><span class="hs-comment">{-
try is used because most of the first characters of the two character
symbols can also be part of a single character symbol
-}</span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span>   </span><span id="local-6989586621679159107"><span class="annot"><span class="annottext">basicAnsiOps :: [ParsecT Void Text Identity Text]
</span><a href="#local-6989586621679159107"><span class="hs-identifier hs-var hs-var">basicAnsiOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Tokens Text -&gt; ParsecT Void Text Identity Text)
-&gt; [Tokens Text] -&gt; [ParsecT Void Text Identity Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text -&gt; ParsecT Void Text Identity Text
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity Text
 -&gt; ParsecT Void Text Identity Text)
-&gt; (Tokens Text -&gt; ParsecT Void Text Identity Text)
-&gt; Tokens Text
-&gt; ParsecT Void Text Identity Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
Tokens Text -&gt; ParsecT Void Text Identity Text
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;&gt;=&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;&lt;=&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;!=&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Tokens Text
</span><span class="hs-string">&quot;&lt;&gt;&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-587"></span><span>                  </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity Text]
-&gt; [ParsecT Void Text Identity Text]
-&gt; [ParsecT Void Text Identity Text]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; ParsecT Void Text Identity Text)
-&gt; String -&gt; [ParsecT Void Text Identity Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
Text -&gt; ParsecT Void Text Identity Text
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ParsecT Void Text Identity Text)
-&gt; (Char -&gt; Text) -&gt; Char -&gt; ParsecT Void Text Identity Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+-^*/%~&amp;&lt;&gt;=&quot;</span></span><span>
</span><span id="line-588"></span><span>                  </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity Text]
-&gt; [ParsecT Void Text Identity Text]
-&gt; [ParsecT Void Text Identity Text]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity Text]
</span><a href="#local-6989586621679159179"><span class="hs-identifier hs-var">pipes</span></a></span><span>
</span><span id="line-589"></span><span>   </span><span id="local-6989586621679159179"><span class="annot"><span class="annottext">pipes :: [ParsecT Void Text Identity Text]
</span><a href="#local-6989586621679159179"><span class="hs-identifier hs-var hs-var">pipes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- what about using many1 (char '|'), then it will</span><span>
</span><span id="line-590"></span><span>           </span><span class="hs-comment">-- fail in the parser? Not sure exactly how</span><span>
</span><span id="line-591"></span><span>           </span><span class="hs-comment">-- standalone the lexer should be</span><span>
</span><span id="line-592"></span><span>           </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'|'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span>
</span><span id="line-593"></span><span>            </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity Text]
-&gt; ParsecT Void Text Identity Text
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;||&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Text
forall a b.
a -&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'|'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity Text
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'|'</span></span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span>                   </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity Text
forall a. a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span class="hs-comment">{-
postgresql generalized operators

this includes the custom operators that postgres supports,
plus all the standard operators which could be custom operators
according to their grammar

rules

An operator name is a sequence of up to NAMEDATALEN-1 (63 by default) characters from the following list:

+ - * / &lt; &gt; = ~ ! @ # % ^ &amp; | ` ?

There are a few restrictions on operator names, however:
-- and /* cannot appear anywhere in an operator name, since they will be taken as the start of a comment.

A multiple-character operator name cannot end in + or -, unless the name also contains at least one of these characters:

~ ! @ # % ^ &amp; | ` ?

which allows the last character of a multi character symbol to be + or
-
-}</span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#generalizedPostgresqlOperator"><span class="hs-identifier hs-type">generalizedPostgresqlOperator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-621"></span><span id="generalizedPostgresqlOperator"><span class="annot"><span class="annottext">generalizedPostgresqlOperator :: [ParsecT Void Text Identity Text]
</span><a href="Language.SQL.SimpleSQL.Lex.html#generalizedPostgresqlOperator"><span class="hs-identifier hs-var hs-var">generalizedPostgresqlOperator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159213"><span class="hs-identifier hs-var">singlePlusMinus</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159214"><span class="hs-identifier hs-var">opMoreChars</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-622"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-623"></span><span>    </span><span id="local-6989586621679159216"><span class="annot"><span class="annottext">allOpSymbols :: String
</span><a href="#local-6989586621679159216"><span class="hs-identifier hs-var hs-var">allOpSymbols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+-*/&lt;&gt;=~!@#%^&amp;|`?&quot;</span></span><span>
</span><span id="line-624"></span><span>    </span><span class="hs-comment">-- these are the symbols when if part of a multi character</span><span>
</span><span id="line-625"></span><span>    </span><span class="hs-comment">-- operator permit the operator to end with a + or - symbol</span><span>
</span><span id="line-626"></span><span>    </span><span id="local-6989586621679159218"><span class="annot"><span class="annottext">exceptionOpSymbols :: String
</span><a href="#local-6989586621679159218"><span class="hs-identifier hs-var hs-var">exceptionOpSymbols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;~!@#%^&amp;|`?&quot;</span></span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span>    </span><span class="hs-comment">-- special case for parsing a single + or - symbol</span><span>
</span><span id="line-629"></span><span>    </span><span id="local-6989586621679159213"><span class="annot"><span class="annottext">singlePlusMinus :: ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159213"><span class="hs-identifier hs-var hs-var">singlePlusMinus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text -&gt; ParsecT Void Text Identity Text
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity Text
 -&gt; ParsecT Void Text Identity Text)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-630"></span><span>      </span><span id="local-6989586621679159219"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159219"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+-&quot;</span></span><span>
</span><span id="line-631"></span><span>      </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ())
-&gt; ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159216"><span class="hs-identifier hs-var">allOpSymbols</span></a></span><span>
</span><span id="line-632"></span><span>      </span><span class="annot"><span class="annottext">Text -&gt; ParsecT Void Text Identity Text
forall a. a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ParsecT Void Text Identity Text)
-&gt; Text -&gt; ParsecT Void Text Identity Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159219"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span>    </span><span class="hs-comment">-- this is used when we are parsing a potentially multi symbol</span><span>
</span><span id="line-635"></span><span>    </span><span class="hs-comment">-- operator and we have alread seen one of the 'exception chars'</span><span>
</span><span id="line-636"></span><span>    </span><span class="hs-comment">-- and so we can end with a + or -</span><span>
</span><span id="line-637"></span><span>    </span><span id="local-6989586621679159220"><span class="annot"><span class="annottext">moreOpCharsException :: ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159220"><span class="hs-identifier hs-var hs-var">moreOpCharsException</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-638"></span><span>       </span><span id="local-6989586621679159221"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159221"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ShowS
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#notElemChar"><span class="hs-operator hs-var">`notElemChar`</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-/*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159216"><span class="hs-identifier hs-var">allOpSymbols</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>            </span><span class="hs-comment">-- make sure we don't parse a comment starting token</span><span>
</span><span id="line-640"></span><span>            </span><span class="hs-comment">-- as part of an operator</span><span>
</span><span id="line-641"></span><span>            </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'/'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'*'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-642"></span><span>            </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'-'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'-'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>            </span><span class="hs-comment">-- and make sure we don't parse a block comment end</span><span>
</span><span id="line-644"></span><span>            </span><span class="hs-comment">-- as part of another symbol</span><span>
</span><span id="line-645"></span><span>            </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'*'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>       </span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.cons</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159221"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall (m :: * -&gt; *) a. Alternative m =&gt; a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159220"><span class="hs-identifier hs-var">moreOpCharsException</span></a></span><span>
</span><span id="line-647"></span><span>
</span><span id="line-648"></span><span>    </span><span id="local-6989586621679159214"><span class="annot"><span class="annottext">opMoreChars :: ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159214"><span class="hs-identifier hs-var hs-var">opMoreChars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity Text]
-&gt; ParsecT Void Text Identity Text
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-649"></span><span>       </span><span class="hs-special">[</span><span class="hs-comment">-- parse an exception char, now we can finish with a + -</span><span>
</span><span id="line-650"></span><span>        </span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.cons</span></span><span>
</span><span id="line-651"></span><span>        </span><span class="annot"><span class="annottext">(Char -&gt; Text -&gt; Text)
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity (Text -&gt; Text)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159218"><span class="hs-identifier hs-var">exceptionOpSymbols</span></a></span><span>
</span><span id="line-652"></span><span>        </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Text)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall (m :: * -&gt; *) a. Alternative m =&gt; a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159220"><span class="hs-identifier hs-var">moreOpCharsException</span></a></span><span>
</span><span id="line-653"></span><span>       </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.cons</span></span><span>
</span><span id="line-654"></span><span>        </span><span class="annot"><span class="annottext">(Char -&gt; Text -&gt; Text)
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity (Text -&gt; Text)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-comment">-- parse +, make sure it isn't the last symbol</span><span>
</span><span id="line-655"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'+'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">lookAhead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159216"><span class="hs-identifier hs-var">allOpSymbols</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-comment">-- parse -, make sure it isn't the last symbol</span><span>
</span><span id="line-657"></span><span>                 </span><span class="hs-comment">-- or the start of a -- comment</span><span>
</span><span id="line-658"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'-'</span></span><span>
</span><span id="line-659"></span><span>                  </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'-'</span></span><span class="hs-special">)</span><span>
</span><span id="line-660"></span><span>                  </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">lookAhead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159216"><span class="hs-identifier hs-var">allOpSymbols</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-661"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-comment">-- parse / check it isn't the start of a /* comment</span><span>
</span><span id="line-662"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'/'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'*'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-663"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-comment">-- make sure we don't parse */ as part of a symbol</span><span>
</span><span id="line-664"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'*'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity () -&gt; ParsecT Void Text Identity Char
forall a b.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity b -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall a.
ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token Text
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span>             </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity Char
forall a.
ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-comment">-- any other ansi operator symbol</span><span>
</span><span id="line-666"></span><span>             </span><span class="annot"><span class="annottext">String -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var">oneOf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;&gt;=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>        </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text -&gt; Text)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall a b.
ParsecT Void Text Identity (a -&gt; b)
-&gt; ParsecT Void Text Identity a -&gt; ParsecT Void Text Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Text
forall (m :: * -&gt; *) a. Alternative m =&gt; a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">option</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text
</span><a href="#local-6989586621679159214"><span class="hs-identifier hs-var">opMoreChars</span></a></span><span>
</span><span id="line-668"></span><span>       </span><span class="hs-special">]</span><span>
</span><span id="line-669"></span><span>
</span><span id="line-670"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-671"></span><span>
</span><span id="line-672"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#sqlWhitespace"><span class="hs-identifier hs-type">sqlWhitespace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-673"></span><span id="sqlWhitespace"><span class="annot"><span class="annottext">sqlWhitespace :: Dialect -&gt; ParsecT Void Text Identity Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlWhitespace"><span class="hs-identifier hs-var hs-var">sqlWhitespace</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Token
</span><a href="Language.SQL.SimpleSQL.Lex.html#Whitespace"><span class="hs-identifier hs-var">Whitespace</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Token)
-&gt; ParsecT Void Text Identity Text
-&gt; ParsecT Void Text Identity Token
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe String -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhile1P</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;whitespace&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
Token Text -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Token
-&gt; String -&gt; ParsecT Void Text Identity Token
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
m a -&gt; String -&gt; m a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-674"></span><span>
</span><span id="line-675"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-676"></span><span>
</span><span id="line-677"></span><span class="hs-comment">-- parser helpers</span><span>
</span><span id="line-678"></span><span>
</span><span id="line-679"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-type">char_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-680"></span><span id="char_"><span class="annot"><span class="annottext">char_ :: Char -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#char_"><span class="hs-identifier hs-var hs-var">char_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity Char -&gt; ParsecT Void Text Identity ())
-&gt; (Char -&gt; ParsecT Void Text Identity Char)
-&gt; Char
-&gt; ParsecT Void Text Identity ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ParsecT Void Text Identity Char
Token Text -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span>
</span><span id="line-681"></span><span>
</span><span id="line-682"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#string_"><span class="hs-identifier hs-type">string_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-683"></span><span id="string_"><span class="annot"><span class="annottext">string_ :: Text -&gt; ParsecT Void Text Identity ()
</span><a href="Language.SQL.SimpleSQL.Lex.html#string_"><span class="hs-identifier hs-var hs-var">string_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Text -&gt; ParsecT Void Text Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity Text -&gt; ParsecT Void Text Identity ())
-&gt; (Text -&gt; ParsecT Void Text Identity Text)
-&gt; Text
-&gt; ParsecT Void Text Identity ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Tokens Text -&gt; ParsecT Void Text Identity (Tokens Text)
Text -&gt; ParsecT Void Text Identity Text
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-type">oneOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-686"></span><span id="oneOf"><span class="annot"><span class="annottext">oneOf :: String -&gt; ParsecT Void Text Identity Char
</span><a href="Language.SQL.SimpleSQL.Lex.html#oneOf"><span class="hs-identifier hs-var hs-var">oneOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ParsecT Void Text Identity Char
[Token Text] -&gt; ParsecT Void Text Identity (Token Text)
forall (f :: * -&gt; *) e s (m :: * -&gt; *).
(Foldable f, MonadParsec e s m) =&gt;
f (Token s) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">M.oneOf</span></span><span>
</span><span id="line-687"></span><span>
</span><span id="line-688"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#notElemChar"><span class="hs-identifier hs-type">notElemChar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-689"></span><span id="notElemChar"><span class="annot"><span class="annottext">notElemChar :: Char -&gt; String -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#notElemChar"><span class="hs-identifier hs-var hs-var">notElemChar</span></a></span></span><span> </span><span id="local-6989586621679159223"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159223"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679159224"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159224"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159223"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159224"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-690"></span><span>
</span><span id="line-691"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span>
</span><span id="line-694"></span><span class="hs-comment">{-
This utility function will accurately report if the two tokens are
pretty printed, if they should lex back to the same two tokens. This
function is used in testing (and can be used in other places), and
must not be implemented by actually trying to print both tokens and
then lex them back from a single string (because then we would have
the risk of thinking two tokens cannot be together when there is bug
in the lexer, which the testing is supposed to find).

maybe do some quick checking to make sure this function only gives
true negatives: check pairs which return false actually fail to lex or
give different symbols in return: could use quickcheck for this

a good sanity test for this function is to change it to always return
true, then check that the automated tests return the same number of
successes. I don't think it succeeds this test at the moment
-}</span><span>
</span><span id="line-711"></span><span>
</span><span id="line-712"></span><span class="hs-comment">-- | Utility function to tell you if a list of tokens</span><span>
</span><span id="line-713"></span><span class="hs-comment">-- will pretty print then lex back to the same set of tokens.</span><span>
</span><span id="line-714"></span><span class="hs-comment">-- Used internally, might be useful for generating SQL via lexical tokens.</span><span>
</span><span id="line-715"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier hs-type">tokenListWillPrintAndLex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-716"></span><span id="tokenListWillPrintAndLex"><span class="annot"><span class="annottext">tokenListWillPrintAndLex :: Dialect -&gt; [Token] -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier hs-var hs-var">tokenListWillPrintAndLex</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-717"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier hs-var">tokenListWillPrintAndLex</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Token
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-718"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier hs-var">tokenListWillPrintAndLex</span></a></span><span> </span><span id="local-6989586621679159226"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159226"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159227"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159227"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679159228"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159228"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679159229"><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679159229"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-719"></span><span>    </span><span class="annot"><span class="annottext">Dialect -&gt; Token -&gt; Token -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokensWillPrintAndLex"><span class="hs-identifier hs-var">tokensWillPrintAndLex</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159226"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159227"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159228"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; [Token] -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokenListWillPrintAndLex"><span class="hs-identifier hs-var">tokenListWillPrintAndLex</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159226"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159228"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Token -&gt; [Token] -&gt; [Token]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Token]
</span><a href="#local-6989586621679159229"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-720"></span><span>
</span><span id="line-721"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#tokensWillPrintAndLex"><span class="hs-identifier hs-type">tokensWillPrintAndLex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Dialect.html#Dialect"><span class="hs-identifier hs-type">Dialect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-722"></span><span id="tokensWillPrintAndLex"><span class="annot"><span class="annottext">tokensWillPrintAndLex :: Dialect -&gt; Token -&gt; Token -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokensWillPrintAndLex"><span class="hs-identifier hs-var hs-var">tokensWillPrintAndLex</span></a></span></span><span> </span><span id="local-6989586621679159232"><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159232"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679159233"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159233"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679159234"><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159234"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-723"></span><span>
</span><span id="line-724"></span><span class="hs-comment">{-
a : followed by an identifier character will look like a host param
followed by = or : makes a different symbol
-}</span><span>
</span><span id="line-728"></span><span>
</span><span id="line-729"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159233"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-730"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679159235"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679159236"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159236"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-var">isIdentifierChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159236"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159236"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.elem`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;:=&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-731"></span><span>
</span><span id="line-732"></span><span class="hs-comment">{-
two symbols next to eachother will fail if the symbols can combine and
(possibly just the prefix) look like a different symbol
-}</span><span>
</span><span id="line-736"></span><span>
</span><span id="line-737"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Dialect.html#diPostgresSymbols"><span class="hs-identifier hs-var">diPostgresSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159232"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-738"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span id="local-6989586621679159238"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679159238"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159233"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-739"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span id="local-6989586621679159239"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679159239"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159234"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-740"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679159239"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;+&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;-&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.elem`</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679159238"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;~!@#%^&amp;|`?&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-741"></span><span>
</span><span id="line-742"></span><span class="hs-comment">{-
check two adjacent symbols in non postgres where the combination
possibilities are much more limited. This is ansi behaviour, it might
be different when the other dialects are done properly
-}</span><span>
</span><span id="line-747"></span><span>
</span><span id="line-748"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span id="local-6989586621679159241"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679159241"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159233"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-749"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span id="local-6989586621679159242"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679159242"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159234"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-750"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679159241"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679159242"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text, Text) -&gt; [(Text, Text)] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&lt;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-751"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&lt;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-752"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-753"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;!&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-754"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-755"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;||&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-756"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;|&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;||&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-757"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;||&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;||&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-758"></span><span>                    </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&lt;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&gt;=&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-759"></span><span>                    </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-760"></span><span>
</span><span id="line-761"></span><span class="hs-comment">-- two whitespaces will be combined</span><span>
</span><span id="line-762"></span><span>
</span><span id="line-763"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Whitespace"><span class="hs-identifier hs-type">Whitespace</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159233"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-764"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Whitespace"><span class="hs-identifier hs-type">Whitespace</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159234"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-765"></span><span>
</span><span id="line-766"></span><span class="hs-comment">-- line comment without a newline at the end will eat the next token</span><span>
</span><span id="line-767"></span><span>
</span><span id="line-768"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#LineComment"><span class="hs-identifier hs-type">LineComment</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159233"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-769"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679159244"><span class="hs-identifier hs-var">checkLastAChar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-770"></span><span>
</span><span id="line-771"></span><span class="hs-comment">{-
check the last character of the first token and the first character of
the second token forming a comment start or end symbol
-}</span><span>
</span><span id="line-775"></span><span>
</span><span id="line-776"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679159245"><span class="annot"><span class="annottext">f :: Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679159245"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-777"></span><span>         </span><span class="annot"><a href="#local-6989586621679159245"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'*'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-778"></span><span>         </span><span class="annot"><a href="#local-6989586621679159245"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'*'</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-779"></span><span>         </span><span class="annot"><a href="#local-6989586621679159245"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-780"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679159246"><span class="hs-identifier hs-var">checkBorderChars</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679159245"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-781"></span><span>
</span><span id="line-782"></span><span class="hs-comment">{-
a symbol will absorb a following .
TODO: not 100% on this always being bad
-}</span><span>
</span><span id="line-786"></span><span>
</span><span id="line-787"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159233"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-788"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679159235"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-789"></span><span>
</span><span id="line-790"></span><span class="hs-comment">-- cannot follow a symbol ending in : with another token starting with :</span><span>
</span><span id="line-791"></span><span>
</span><span id="line-792"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679159247"><span class="annot"><span class="annottext">f :: Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679159247"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-793"></span><span>         </span><span class="annot"><a href="#local-6989586621679159247"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-794"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679159246"><span class="hs-identifier hs-var">checkBorderChars</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679159247"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-795"></span><span>
</span><span id="line-796"></span><span class="hs-comment">-- unquoted identifier followed by an identifier letter</span><span>
</span><span id="line-797"></span><span>
</span><span id="line-798"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-type">Identifier</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Text, Text)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159233"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-799"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679159235"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-var">isIdentifierChar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-800"></span><span>
</span><span id="line-801"></span><span class="hs-comment">-- a quoted identifier using &quot;, followed by a &quot; will fail</span><span>
</span><span id="line-802"></span><span>
</span><span id="line-803"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Identifier"><span class="hs-identifier hs-type">Identifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159233"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-804"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679159235"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-805"></span><span>
</span><span id="line-806"></span><span class="hs-comment">-- prefixed variable followed by an identifier char will be absorbed</span><span>
</span><span id="line-807"></span><span>
</span><span id="line-808"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PrefixedVariable"><span class="hs-identifier hs-type">PrefixedVariable</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159233"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-809"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679159235"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="Language.SQL.SimpleSQL.Lex.html#isIdentifierChar"><span class="hs-identifier hs-var">isIdentifierChar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-810"></span><span>
</span><span id="line-811"></span><span class="hs-comment">-- a positional arg will absorb a following digit</span><span>
</span><span id="line-812"></span><span>
</span><span id="line-813"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#PositionalArg"><span class="hs-identifier hs-type">PositionalArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159233"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-814"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679159235"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-815"></span><span>
</span><span id="line-816"></span><span class="hs-comment">-- a string ending with ' followed by a token starting with ' will be absorbed</span><span>
</span><span id="line-817"></span><span>
</span><span id="line-818"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlString"><span class="hs-identifier hs-type">SqlString</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159233"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-819"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679159235"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-820"></span><span>
</span><span id="line-821"></span><span class="hs-comment">-- a number followed by a . will fail or be absorbed</span><span>
</span><span id="line-822"></span><span>
</span><span id="line-823"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-type">SqlNumber</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159233"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-824"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679159235"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-825"></span><span>
</span><span id="line-826"></span><span class="hs-comment">-- a number followed by an e or E will fail or be absorbed</span><span>
</span><span id="line-827"></span><span>
</span><span id="line-828"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-type">SqlNumber</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159233"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-829"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679159235"><span class="hs-identifier hs-var">checkFirstBChar</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679159248"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159248"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159248"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'e'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159248"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'E'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-830"></span><span>
</span><span id="line-831"></span><span class="hs-comment">-- two numbers next to eachother will fail or be absorbed</span><span>
</span><span id="line-832"></span><span>
</span><span id="line-833"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-type">SqlNumber</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159233"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-834"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SqlNumber"><span class="hs-identifier hs-type">SqlNumber</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159234"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-835"></span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-838"></span><span>
</span><span id="line-839"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-840"></span><span>    </span><span id="local-6989586621679159249"><span class="annot"><span class="annottext">prettya :: Text
</span><a href="#local-6989586621679159249"><span class="hs-identifier hs-var hs-var">prettya</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Token -&gt; Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159232"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159233"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-841"></span><span>    </span><span id="local-6989586621679159250"><span class="annot"><span class="annottext">prettyb :: Text
</span><a href="#local-6989586621679159250"><span class="hs-identifier hs-var hs-var">prettyb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Token -&gt; Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="#local-6989586621679159232"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Token
</span><a href="#local-6989586621679159234"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-842"></span><span>    </span><span class="hs-comment">-- helper function to run a predicate on the</span><span>
</span><span id="line-843"></span><span>    </span><span class="hs-comment">-- last character of the first token and the first</span><span>
</span><span id="line-844"></span><span>    </span><span class="hs-comment">-- character of the second token</span><span>
</span><span id="line-845"></span><span>    </span><span id="local-6989586621679159246"><span class="annot"><span class="annottext">checkBorderChars :: (Char -&gt; Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679159246"><span class="hs-identifier hs-var hs-var">checkBorderChars</span></a></span></span><span> </span><span id="local-6989586621679159251"><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679159251"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-846"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe (Text, Char)
</span><span class="hs-identifier hs-var">T.unsnoc</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679159249"><span class="hs-identifier hs-var">prettya</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe (Char, Text)
</span><span class="hs-identifier hs-var">T.uncons</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679159250"><span class="hs-identifier hs-var">prettyb</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-847"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679159254"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159254"><span class="hs-identifier hs-var">la</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159255"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159255"><span class="hs-identifier hs-var">fb</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
</span><a href="#local-6989586621679159251"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159254"><span class="hs-identifier hs-var">la</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159255"><span class="hs-identifier hs-var">fb</span></a></span><span>
</span><span id="line-848"></span><span>            </span><span class="annot"><span class="annottext">(Maybe (Text, Char), Maybe (Char, Text))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-849"></span><span>    </span><span id="local-6989586621679159235"><span class="annot"><span class="annottext">checkFirstBChar :: (Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679159235"><span class="hs-identifier hs-var hs-var">checkFirstBChar</span></a></span></span><span> </span><span id="local-6989586621679159256"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679159256"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe (Char, Text)
</span><span class="hs-identifier hs-var">T.uncons</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679159250"><span class="hs-identifier hs-var">prettyb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-850"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159257"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159257"><span class="hs-identifier hs-var">b'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679159256"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159257"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-851"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Char, Text)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-852"></span><span>    </span><span id="local-6989586621679159244"><span class="annot"><span class="annottext">checkLastAChar :: (Char -&gt; Bool) -&gt; Bool
</span><a href="#local-6989586621679159244"><span class="hs-identifier hs-var hs-var">checkLastAChar</span></a></span></span><span> </span><span id="local-6989586621679159258"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679159258"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe (Text, Char)
</span><span class="hs-identifier hs-var">T.unsnoc</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679159249"><span class="hs-identifier hs-var">prettya</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-853"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679159259"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159259"><span class="hs-identifier hs-var">la</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679159258"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679159259"><span class="hs-identifier hs-var">la</span></a></span><span>
</span><span id="line-854"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Text, Char)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-855"></span><span>
</span><span id="line-856"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span class="hs-comment">-- megaparsec stream boilerplate</span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span class="annot"><span class="hs-comment">-- | Wrapper to allow using the lexer as input to a megaparsec parser.</span></span><span>
</span><span id="line-861"></span><span class="hs-keyword">data</span><span> </span><span id="SQLStream"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-var">SQLStream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SQLStream"><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-var">SQLStream</span></a></span></span><span>
</span><span id="line-862"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="sqlStreamInput"><span class="annot"><span class="annottext">SQLStream -&gt; String
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlStreamInput"><span class="hs-identifier hs-var hs-var">sqlStreamInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-863"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="unSQLStream"><span class="annot"><span class="annottext">SQLStream -&gt; [WithPos Token]
</span><a href="Language.SQL.SimpleSQL.Lex.html#unSQLStream"><span class="hs-identifier hs-var hs-var">unSQLStream</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-type">WithPos</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-864"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-865"></span><span>
</span><span id="line-866"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Stream</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-867"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Token"><span class="annot"><span class="hs-identifier hs-var">Token</span></span></span><span>  </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-type">WithPos</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-868"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Tokens"><span class="annot"><span class="hs-identifier hs-var">Tokens</span></span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#WithPos"><span class="hs-identifier hs-type">WithPos</span></a></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-869"></span><span>
</span><span id="line-870"></span><span>  </span><span id="local-6989586621679159283"><span class="annot"><span class="annottext">tokenToChunk :: Proxy SQLStream -&gt; Token SQLStream -&gt; Tokens SQLStream
</span><a href="#local-6989586621679159283"><span class="hs-identifier hs-var hs-var hs-var hs-var">tokenToChunk</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span id="local-6989586621679159286"><span class="annot"><span class="annottext">Token SQLStream
</span><a href="#local-6989586621679159286"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Token SQLStream
WithPos Token
</span><a href="#local-6989586621679159286"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-871"></span><span>  </span><span id="local-6989586621679159287"><span class="annot"><span class="annottext">tokensToChunk :: Proxy SQLStream -&gt; [Token SQLStream] -&gt; Tokens SQLStream
</span><a href="#local-6989586621679159287"><span class="hs-identifier hs-var hs-var hs-var hs-var">tokensToChunk</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span id="local-6989586621679159289"><span class="annot"><span class="annottext">[Token SQLStream]
</span><a href="#local-6989586621679159289"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Token SQLStream]
Tokens SQLStream
</span><a href="#local-6989586621679159289"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-872"></span><span>  </span><span id="local-6989586621679159290"><span class="annot"><span class="annottext">chunkToTokens :: Proxy SQLStream -&gt; Tokens SQLStream -&gt; [Token SQLStream]
</span><a href="#local-6989586621679159290"><span class="hs-identifier hs-var hs-var hs-var hs-var">chunkToTokens</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WithPos Token] -&gt; [WithPos Token]
Tokens SQLStream -&gt; [Token SQLStream]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-873"></span><span>  </span><span id="local-6989586621679159293"><span class="annot"><span class="annottext">chunkLength :: Proxy SQLStream -&gt; Tokens SQLStream -&gt; Int
</span><a href="#local-6989586621679159293"><span class="hs-identifier hs-var hs-var hs-var hs-var">chunkLength</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WithPos Token] -&gt; Int
Tokens SQLStream -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span>
</span><span id="line-874"></span><span>  </span><span id="local-6989586621679159297"><span class="annot"><span class="annottext">chunkEmpty :: Proxy SQLStream -&gt; Tokens SQLStream -&gt; Bool
</span><a href="#local-6989586621679159297"><span class="hs-identifier hs-var hs-var hs-var hs-var">chunkEmpty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WithPos Token] -&gt; Bool
Tokens SQLStream -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span>
</span><span id="line-875"></span><span>  </span><span id="local-6989586621679159302"><span class="annot"><span class="annottext">take1_ :: SQLStream -&gt; Maybe (Token SQLStream, SQLStream)
</span><a href="#local-6989586621679159302"><span class="hs-identifier hs-var hs-var hs-var hs-var">take1_</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Token SQLStream, SQLStream)
Maybe (WithPos Token, SQLStream)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-876"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">take1_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span> </span><span id="local-6989586621679159304"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159304"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159305"><span class="annot"><span class="annottext">WithPos Token
</span><a href="#local-6989586621679159305"><span class="hs-identifier hs-var">t</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679159306"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159306"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WithPos Token, SQLStream) -&gt; Maybe (WithPos Token, SQLStream)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-877"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">WithPos Token
</span><a href="#local-6989586621679159305"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-878"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; [WithPos Token] -&gt; SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-var">SQLStream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy SQLStream -&gt; NonEmpty (Token SQLStream) -&gt; Int
forall s. VisualStream s =&gt; Proxy s -&gt; NonEmpty (Token s) -&gt; Int
</span><span class="hs-identifier hs-var">tokensLength</span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#pxy"><span class="hs-identifier hs-var">pxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WithPos Token
</span><a href="#local-6989586621679159305"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">WithPos Token -&gt; [WithPos Token] -&gt; NonEmpty (WithPos Token)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">NE.:|</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159304"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159306"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-879"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-880"></span><span>  </span><span id="local-6989586621679159315"><span class="annot"><span class="annottext">takeN_ :: Int -&gt; SQLStream -&gt; Maybe (Tokens SQLStream, SQLStream)
</span><a href="#local-6989586621679159315"><span class="hs-identifier hs-var hs-var hs-var hs-var">takeN_</span></a></span></span><span> </span><span id="local-6989586621679159317"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679159317"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span> </span><span id="local-6989586621679159318"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159318"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679159319"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159319"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-881"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679159317"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([WithPos Token], SQLStream) -&gt; Maybe ([WithPos Token], SQLStream)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; [WithPos Token] -&gt; SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-var">SQLStream</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159318"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159319"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-882"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[WithPos Token] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159319"><span class="hs-identifier hs-var">s</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ([WithPos Token], SQLStream)
Maybe (Tokens SQLStream, SQLStream)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-883"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-884"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159321"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159321"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679159322"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159322"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [WithPos Token] -&gt; ([WithPos Token], [WithPos Token])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679159317"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159319"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-885"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[WithPos Token] -&gt; Maybe (NonEmpty (WithPos Token))
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NE.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159321"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-886"></span><span>          </span><span class="annot"><span class="annottext">Maybe (NonEmpty (WithPos Token))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([WithPos Token], SQLStream) -&gt; Maybe ([WithPos Token], SQLStream)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159321"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; [WithPos Token] -&gt; SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-var">SQLStream</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159318"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159322"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-887"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679159325"><span class="annot"><span class="annottext">NonEmpty (WithPos Token)
</span><a href="#local-6989586621679159325"><span class="hs-identifier hs-var">nex</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([WithPos Token], SQLStream) -&gt; Maybe ([WithPos Token], SQLStream)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159321"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; [WithPos Token] -&gt; SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-var">SQLStream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy SQLStream -&gt; NonEmpty (Token SQLStream) -&gt; Int
forall s. VisualStream s =&gt; Proxy s -&gt; NonEmpty (Token s) -&gt; Int
</span><span class="hs-identifier hs-var">tokensLength</span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#pxy"><span class="hs-identifier hs-var">pxy</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Token SQLStream)
NonEmpty (WithPos Token)
</span><a href="#local-6989586621679159325"><span class="hs-identifier hs-var">nex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159318"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159322"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-888"></span><span>  </span><span id="local-6989586621679159327"><span class="annot"><span class="annottext">takeWhile_ :: (Token SQLStream -&gt; Bool)
-&gt; SQLStream -&gt; (Tokens SQLStream, SQLStream)
</span><a href="#local-6989586621679159327"><span class="hs-identifier hs-var hs-var hs-var hs-var">takeWhile_</span></a></span></span><span> </span><span id="local-6989586621679159329"><span class="annot"><span class="annottext">Token SQLStream -&gt; Bool
</span><a href="#local-6989586621679159329"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span> </span><span id="local-6989586621679159330"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159330"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679159331"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159331"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-889"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159332"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159332"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679159333"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159333"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WithPos Token -&gt; Bool)
-&gt; [WithPos Token] -&gt; ([WithPos Token], [WithPos Token])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">DL.span</span></span><span> </span><span class="annot"><span class="annottext">Token SQLStream -&gt; Bool
WithPos Token -&gt; Bool
</span><a href="#local-6989586621679159329"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159331"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-890"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[WithPos Token] -&gt; Maybe (NonEmpty (WithPos Token))
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NE.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159332"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-891"></span><span>      </span><span class="annot"><span class="annottext">Maybe (NonEmpty (WithPos Token))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WithPos Token]
Tokens SQLStream
</span><a href="#local-6989586621679159332"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; [WithPos Token] -&gt; SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-var">SQLStream</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159330"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159333"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-892"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679159335"><span class="annot"><span class="annottext">NonEmpty (WithPos Token)
</span><a href="#local-6989586621679159335"><span class="hs-identifier hs-var">nex</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WithPos Token]
Tokens SQLStream
</span><a href="#local-6989586621679159332"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; [WithPos Token] -&gt; SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-var">SQLStream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy SQLStream -&gt; NonEmpty (Token SQLStream) -&gt; Int
forall s. VisualStream s =&gt; Proxy s -&gt; NonEmpty (Token s) -&gt; Int
</span><span class="hs-identifier hs-var">tokensLength</span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#pxy"><span class="hs-identifier hs-var">pxy</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Token SQLStream)
NonEmpty (WithPos Token)
</span><a href="#local-6989586621679159335"><span class="hs-identifier hs-var">nex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159330"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159333"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-893"></span><span>
</span><span id="line-894"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VisualStream</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-895"></span><span>  </span><span id="local-6989586621679159344"><span class="annot"><span class="annottext">showTokens :: Proxy SQLStream -&gt; NonEmpty (Token SQLStream) -&gt; String
</span><a href="#local-6989586621679159344"><span class="hs-identifier hs-var hs-var hs-var hs-var">showTokens</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">DL.intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-896"></span><span>    </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; (NonEmpty (WithPos Token) -&gt; [String])
-&gt; NonEmpty (WithPos Token)
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty String -&gt; [String]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NE.toList</span></span><span>
</span><span id="line-897"></span><span>    </span><span class="annot"><span class="annottext">(NonEmpty String -&gt; [String])
-&gt; (NonEmpty (WithPos Token) -&gt; NonEmpty String)
-&gt; NonEmpty (WithPos Token)
-&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(WithPos Token -&gt; String)
-&gt; NonEmpty (WithPos Token) -&gt; NonEmpty String
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Token -&gt; String
</span><a href="Language.SQL.SimpleSQL.Lex.html#showMyToken"><span class="hs-identifier hs-var">showMyToken</span></a></span><span> </span><span class="annot"><span class="annottext">(Token -&gt; String)
-&gt; (WithPos Token -&gt; Token) -&gt; WithPos Token -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WithPos Token -&gt; Token
forall a. WithPos a -&gt; a
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokenVal"><span class="hs-identifier hs-var">tokenVal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-898"></span><span>  </span><span id="local-6989586621679159353"><span class="annot"><span class="annottext">tokensLength :: Proxy SQLStream -&gt; NonEmpty (Token SQLStream) -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">tokensLength</span></span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span id="local-6989586621679159354"><span class="annot"><span class="annottext">NonEmpty (Token SQLStream)
</span><a href="#local-6989586621679159354"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty Int -&gt; Int
forall a. Num a =&gt; NonEmpty a -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WithPos Token -&gt; Int
forall a. WithPos a -&gt; Int
</span><a href="Language.SQL.SimpleSQL.Lex.html#tokenLength"><span class="hs-identifier hs-var">tokenLength</span></a></span><span> </span><span class="annot"><span class="annottext">(WithPos Token -&gt; Int) -&gt; NonEmpty (WithPos Token) -&gt; NonEmpty Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Token SQLStream)
NonEmpty (WithPos Token)
</span><a href="#local-6989586621679159354"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-899"></span><span>
</span><span id="line-900"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679159360"><span class="annot"><span class="hs-identifier hs-type">TraversableStream</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-901"></span><span>  </span><span id="local-6989586621679159374"><span class="annot"><span class="annottext">reachOffset :: Int -&gt; PosState SQLStream -&gt; (Maybe String, PosState SQLStream)
</span><a href="#local-6989586621679159374"><span class="hs-identifier hs-var hs-var hs-var hs-var">reachOffset</span></a></span></span><span> </span><span id="local-6989586621679159376"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679159376"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.PosState</span></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679159378"><span id="local-6989586621679159379"><span id="local-6989586621679159380"><span id="local-6989586621679159381"><span id="local-6989586621679159382"><span class="annot"><span class="annottext">Int
String
SourcePos
Pos
SQLStream
pstateSourcePos :: forall s. PosState s -&gt; SourcePos
pstateInput :: SQLStream
pstateOffset :: Int
pstateSourcePos :: SourcePos
pstateTabWidth :: Pos
pstateLinePrefix :: String
pstateLinePrefix :: forall s. PosState s -&gt; String
pstateTabWidth :: forall s. PosState s -&gt; Pos
pstateOffset :: forall s. PosState s -&gt; Int
pstateInput :: forall s. PosState s -&gt; s
</span><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-902"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159387"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159388"><span class="hs-identifier hs-var">restOfLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-903"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PosState</span></span><span>
</span><span id="line-904"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">pstateInput :: SQLStream
</span><span class="hs-identifier hs-var">pstateInput</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span>
</span><span id="line-905"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sqlStreamInput :: String
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlStreamInput"><span class="hs-identifier hs-var">sqlStreamInput</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159389"><span class="hs-identifier hs-var">postStr</span></a></span><span>
</span><span id="line-906"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">unSQLStream :: [WithPos Token]
</span><a href="Language.SQL.SimpleSQL.Lex.html#unSQLStream"><span class="hs-identifier hs-var">unSQLStream</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159390"><span class="hs-identifier hs-var">post</span></a></span><span>
</span><span id="line-907"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-908"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pstateOffset :: Int
</span><span class="hs-identifier hs-var">pstateOffset</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679159379"><span class="hs-identifier hs-var">pstateOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679159376"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-909"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pstateSourcePos :: SourcePos
</span><span class="hs-identifier hs-var">pstateSourcePos</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679159392"><span class="hs-identifier hs-var">newSourcePos</span></a></span><span>
</span><span id="line-910"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pstateTabWidth :: Pos
</span><span class="hs-identifier hs-var">pstateTabWidth</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pos
</span><a href="#local-6989586621679159381"><span class="hs-identifier hs-var">pstateTabWidth</span></a></span><span>
</span><span id="line-911"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pstateLinePrefix :: String
</span><span class="hs-identifier hs-var">pstateLinePrefix</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159387"><span class="hs-identifier hs-var">prefix</span></a></span><span>
</span><span id="line-912"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-913"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-914"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-915"></span><span>      </span><span id="local-6989586621679159387"><span class="annot"><span class="annottext">prefix :: String
</span><a href="#local-6989586621679159387"><span class="hs-identifier hs-var hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-916"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679159393"><span class="hs-identifier hs-var">sameLine</span></a></span><span>
</span><span id="line-917"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159382"><span class="hs-identifier hs-var">pstateLinePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159394"><span class="hs-identifier hs-var">preLine</span></a></span><span>
</span><span id="line-918"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159394"><span class="hs-identifier hs-var">preLine</span></a></span><span>
</span><span id="line-919"></span><span>      </span><span id="local-6989586621679159393"><span class="annot"><span class="annottext">sameLine :: Bool
</span><a href="#local-6989586621679159393"><span class="hs-identifier hs-var hs-var">sameLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourcePos -&gt; Pos
</span><span class="hs-identifier hs-var">sourceLine</span></span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679159392"><span class="hs-identifier hs-var">newSourcePos</span></a></span><span> </span><span class="annot"><span class="annottext">Pos -&gt; Pos -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">SourcePos -&gt; Pos
</span><span class="hs-identifier hs-var">sourceLine</span></span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679159380"><span class="hs-identifier hs-var">pstateSourcePos</span></a></span><span>
</span><span id="line-920"></span><span>      </span><span id="local-6989586621679159392"><span class="annot"><span class="annottext">newSourcePos :: SourcePos
</span><a href="#local-6989586621679159392"><span class="hs-identifier hs-var hs-var">newSourcePos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-921"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159390"><span class="hs-identifier hs-var">post</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-922"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SQLStream -&gt; [WithPos Token]
</span><a href="Language.SQL.SimpleSQL.Lex.html#unSQLStream"><span class="hs-identifier hs-var">unSQLStream</span></a></span><span> </span><span class="annot"><span class="annottext">SQLStream
</span><a href="#local-6989586621679159378"><span class="hs-identifier hs-var">pstateInput</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-923"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679159380"><span class="hs-identifier hs-var">pstateSourcePos</span></a></span><span>
</span><span id="line-924"></span><span>            </span><span id="local-6989586621679159396"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159396"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WithPos Token -&gt; SourcePos
forall a. WithPos a -&gt; SourcePos
</span><a href="Language.SQL.SimpleSQL.Lex.html#endPos"><span class="hs-identifier hs-var">endPos</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WithPos Token] -&gt; WithPos Token
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159396"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-925"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679159398"><span class="annot"><span class="annottext">WithPos Token
</span><a href="#local-6989586621679159398"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[WithPos Token]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WithPos Token -&gt; SourcePos
forall a. WithPos a -&gt; SourcePos
</span><a href="Language.SQL.SimpleSQL.Lex.html#startPos"><span class="hs-identifier hs-var">startPos</span></a></span><span> </span><span class="annot"><span class="annottext">WithPos Token
</span><a href="#local-6989586621679159398"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-926"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679159399"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159399"><span class="hs-identifier hs-var">pre</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679159390"><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159390"><span class="hs-identifier hs-var">post</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [WithPos Token] -&gt; ([WithPos Token], [WithPos Token])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679159376"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679159379"><span class="hs-identifier hs-var">pstateOffset</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SQLStream -&gt; [WithPos Token]
</span><a href="Language.SQL.SimpleSQL.Lex.html#unSQLStream"><span class="hs-identifier hs-var">unSQLStream</span></a></span><span> </span><span class="annot"><span class="annottext">SQLStream
</span><a href="#local-6989586621679159378"><span class="hs-identifier hs-var">pstateInput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-927"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679159400"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159400"><span class="hs-identifier hs-var">preStr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679159389"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159389"><span class="hs-identifier hs-var">postStr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; (String, String)
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679159401"><span class="hs-identifier hs-var">tokensConsumed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SQLStream -&gt; String
</span><a href="Language.SQL.SimpleSQL.Lex.html#sqlStreamInput"><span class="hs-identifier hs-var">sqlStreamInput</span></a></span><span> </span><span class="annot"><span class="annottext">SQLStream
</span><a href="#local-6989586621679159378"><span class="hs-identifier hs-var">pstateInput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-928"></span><span>      </span><span id="local-6989586621679159394"><span class="annot"><span class="annottext">preLine :: String
</span><a href="#local-6989586621679159394"><span class="hs-identifier hs-var hs-var">preLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ShowS
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159400"><span class="hs-identifier hs-var">preStr</span></a></span><span>
</span><span id="line-929"></span><span>      </span><span id="local-6989586621679159401"><span class="annot"><span class="annottext">tokensConsumed :: Int
</span><a href="#local-6989586621679159401"><span class="hs-identifier hs-var hs-var">tokensConsumed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-930"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[WithPos Token] -&gt; Maybe (NonEmpty (WithPos Token))
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NE.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">[WithPos Token]
</span><a href="#local-6989586621679159399"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-931"></span><span>          </span><span class="annot"><span class="annottext">Maybe (NonEmpty (WithPos Token))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-932"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679159404"><span class="annot"><span class="annottext">NonEmpty (WithPos Token)
</span><a href="#local-6989586621679159404"><span class="hs-identifier hs-var">nePre</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream -&gt; NonEmpty (Token SQLStream) -&gt; Int
forall s. VisualStream s =&gt; Proxy s -&gt; NonEmpty (Token s) -&gt; Int
</span><span class="hs-identifier hs-var">tokensLength</span></span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#pxy"><span class="hs-identifier hs-var">pxy</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Token SQLStream)
NonEmpty (WithPos Token)
</span><a href="#local-6989586621679159404"><span class="hs-identifier hs-var">nePre</span></a></span><span>
</span><span id="line-933"></span><span>      </span><span id="local-6989586621679159388"><span class="annot"><span class="annottext">restOfLine :: String
</span><a href="#local-6989586621679159388"><span class="hs-identifier hs-var hs-var">restOfLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ShowS
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679159389"><span class="hs-identifier hs-var">postStr</span></a></span><span>
</span><span id="line-934"></span><span>
</span><span id="line-935"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#pxy"><span class="hs-identifier hs-type">pxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#SQLStream"><span class="hs-identifier hs-type">SQLStream</span></a></span><span>
</span><span id="line-936"></span><span id="pxy"><span class="annot"><span class="annottext">pxy :: Proxy SQLStream
</span><a href="Language.SQL.SimpleSQL.Lex.html#pxy"><span class="hs-identifier hs-var hs-var">pxy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy SQLStream
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-937"></span><span>
</span><span id="line-938"></span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#showMyToken"><span class="hs-identifier hs-type">showMyToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.SQL.SimpleSQL.Lex.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-939"></span><span class="hs-comment">-- todo: how to do this properly?</span><span>
</span><span id="line-940"></span><span id="showMyToken"><span class="annot"><span class="annottext">showMyToken :: Token -&gt; String
</span><a href="Language.SQL.SimpleSQL.Lex.html#showMyToken"><span class="hs-identifier hs-var hs-var">showMyToken</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String) -&gt; (Token -&gt; Text) -&gt; Token -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dialect -&gt; Token -&gt; Text
</span><a href="Language.SQL.SimpleSQL.Lex.html#prettyToken"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">Dialect
</span><a href="Language.SQL.SimpleSQL.Dialect.html#ansi2011"><span class="hs-identifier hs-var">ansi2011</span></a></span><span>
</span><span id="line-941"></span></pre></body></html>